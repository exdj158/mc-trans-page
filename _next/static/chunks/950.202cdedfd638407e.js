(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[950],{6583:function(t,e,r){"use strict";var n=r(2104),o=r(5656),i=r(9303),a=r(6244),l=r(9341),s=Math.min,u=[].lastIndexOf,c=!!u&&1/[1].lastIndexOf(1,-0)<0,f=l("lastIndexOf");t.exports=c||!f?function(t){if(c)return n(u,this,arguments)||0;var e=o(this),r=a(e),l=r-1;for(arguments.length>1&&(l=s(l,i(arguments[1]))),l<0&&(l=r+l);l>=0;l--)if(l in e&&e[l]===t)return l||0;return -1}:u},3671:function(t,e,r){var n=r(9662),o=r(7908),i=r(8361),a=r(6244),l=TypeError,s=function(t){return function(e,r,s,u){n(r);var c=o(e),f=i(c),h=a(c),d=t?h-1:0,y=t?-1:1;if(s<2)for(;;){if(d in f){u=f[d],d+=y;break}if(d+=y,t?d<0:h<=d)throw l("Reduce of empty array with no initial value")}for(;t?d>=0:h>d;d+=y)d in f&&(u=r(u,f[d],d,c));return u}};t.exports={left:s(!1),right:s(!0)}},3658:function(t,e,r){"use strict";var n=r(9781),o=r(3157),i=TypeError,a=Object.getOwnPropertyDescriptor,l=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=l?function(t,e){if(o(t)&&!a(t,"length").writable)throw i("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},4362:function(t,e,r){var n=r(1589),o=Math.floor,i=function(t,e){var r=t.length,s=o(r/2);return r<8?a(t,e):l(t,i(n(t,0,s),e),i(n(t,s),e),e)},a=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},l=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,l=0;a<o||l<i;)t[a+l]=a<o&&l<i?0>=n(e[a],r[l])?e[a++]:r[l++]:a<o?e[a++]:r[l++];return t};t.exports=i},9320:function(t,e,r){"use strict";var n=r(1702),o=r(9190),i=r(2423).getWeakData,a=r(5787),l=r(9670),s=r(8554),u=r(111),c=r(408),f=r(2092),h=r(2597),d=r(9909),y=d.set,p=d.getterFor,m=f.find,g=f.findIndex,b=n([].splice),w=0,S=function(t){return t.frozen||(t.frozen=new C)},C=function(){this.entries=[]},O=function(t,e){return m(t.entries,function(t){return t[0]===e})};C.prototype={get:function(t){var e=O(this,t);if(e)return e[1]},has:function(t){return!!O(this,t)},set:function(t,e){var r=O(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=g(this.entries,function(e){return e[0]===t});return~e&&b(this.entries,e,1),!!~e}},t.exports={getConstructor:function(t,e,r,n){var f=t(function(t,o){a(t,d),y(t,{type:e,id:w++,frozen:void 0}),s(o)||c(o,t[n],{that:t,AS_ENTRIES:r})}),d=f.prototype,m=p(e),g=function(t,e,r){var n=m(t),o=i(l(e),!0);return!0===o?S(n).set(e,r):o[n.id]=r,t};return o(d,{delete:function(t){var e=m(this);if(!u(t))return!1;var r=i(t);return!0===r?S(e).delete(t):r&&h(r,e.id)&&delete r[e.id]},has:function(t){var e=m(this);if(!u(t))return!1;var r=i(t);return!0===r?S(e).has(t):r&&h(r,e.id)}}),o(d,r?{get:function(t){var e=m(this);if(u(t)){var r=i(t);return!0===r?S(e).get(t):r?r[e.id]:void 0}},set:function(t,e){return g(this,t,e)}}:{add:function(t){return g(this,t,!0)}}),f}}},5117:function(t,e,r){"use strict";var n=r(6330),o=TypeError;t.exports=function(t,e){if(!delete t[e])throw o("Cannot delete property "+n(e)+" of "+n(t))}},8886:function(t,e,r){var n=r(8113).match(/firefox\/(\d+)/i);t.exports=!!n&&+n[1]},256:function(t,e,r){var n=r(8113);t.exports=/MSIE|Trident/.test(n)},6833:function(t,e,r){var n=r(8113);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},5268:function(t,e,r){var n=r(4326),o=r(7854);t.exports="process"==n(o.process)},8008:function(t,e,r){var n=r(8113).match(/AppleWebKit\/(\d+)\./);t.exports=!!n&&+n[1]},7065:function(t,e,r){"use strict";var n=r(1702),o=r(9662),i=r(111),a=r(2597),l=r(206),s=r(4374),u=Function,c=n([].concat),f=n([].join),h={},d=function(t,e,r){if(!a(h,e)){for(var n=[],o=0;o<e;o++)n[o]="a["+o+"]";h[e]=u("C,a","return new C("+f(n,",")+")")}return h[e](t,r)};t.exports=s?u.bind:function(t){var e=o(this),r=e.prototype,n=l(arguments,1),a=function(){var r=c(n,l(arguments));return this instanceof a?d(e,r.length,r):e.apply(t,r)};return i(r)&&(a.prototype=r),a}},5032:function(t,e,r){var n=r(2597);t.exports=function(t){return void 0!==t&&(n(t,"value")||n(t,"writable"))}},1574:function(t,e,r){"use strict";var n=r(9781),o=r(1702),i=r(6916),a=r(7293),l=r(1956),s=r(5181),u=r(5296),c=r(7908),f=r(8361),h=Object.assign,d=Object.defineProperty,y=o([].concat);t.exports=!h||a(function(){if(n&&1!==h({b:1},h(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol(),o="abcdefghijklmnopqrst";return t[r]=7,o.split("").forEach(function(t){e[t]=t}),7!=h({},t)[r]||l(h({},e)).join("")!=o})?function(t,e){for(var r=c(t),o=arguments.length,a=1,h=s.f,d=u.f;o>a;)for(var p,m=f(arguments[a++]),g=h?y(l(m),h(m)):l(m),b=g.length,w=0;b>w;)p=g[w++],(!n||i(d,m,p))&&(r[p]=m[p]);return r}:h},4699:function(t,e,r){var n=r(9781),o=r(1702),i=r(1956),a=r(5656),l=o(r(5296).f),s=o([].push),u=function(t){return function(e){for(var r,o=a(e),u=i(o),c=u.length,f=0,h=[];c>f;)r=u[f++],(!n||l(o,r))&&s(h,t?[r,o[r]]:o[r]);return h}};t.exports={entries:u(!0),values:u(!1)}},2626:function(t,e,r){var n=r(3070).f;t.exports=function(t,e,r){r in t||n(t,r,{configurable:!0,get:function(){return e[r]},set:function(t){e[r]=t}})}},7152:function(t,e,r){var n=r(7854),o=r(2104),i=r(614),a=r(8113),l=r(206),s=r(8053),u=/MSIE .\./.test(a),c=n.Function,f=function(t){return u?function(e,r){var n=s(arguments.length,1)>2,a=i(e)?e:c(e),u=n?l(arguments,2):void 0;return t(n?function(){o(a,this,u)}:a,r)}:t};t.exports={setTimeout:f(n.setTimeout),setInterval:f(n.setInterval)}},261:function(t,e,r){var n,o,i,a,l=r(7854),s=r(2104),u=r(9974),c=r(614),f=r(2597),h=r(7293),d=r(490),y=r(206),p=r(317),m=r(8053),g=r(6833),b=r(5268),w=l.setImmediate,S=l.clearImmediate,C=l.process,O=l.Dispatch,T=l.Function,R=l.MessageChannel,E=l.String,k=0,P={},j="onreadystatechange";try{n=l.location}catch(x){}var A=function(t){if(f(P,t)){var e=P[t];delete P[t],e()}},H=function(t){return function(){A(t)}},M=function(t){A(t.data)},I=function(t){l.postMessage(E(t),n.protocol+"//"+n.host)};w&&S||(w=function(t){m(arguments.length,1);var e=c(t)?t:T(t),r=y(arguments,1);return P[++k]=function(){s(e,void 0,r)},o(k),k},S=function(t){delete P[t]},b?o=function(t){C.nextTick(H(t))}:O&&O.now?o=function(t){O.now(H(t))}:R&&!g?(a=(i=new R).port2,i.port1.onmessage=M,o=u(a.postMessage,a)):l.addEventListener&&c(l.postMessage)&&!l.importScripts&&n&&"file:"!==n.protocol&&!h(I)?(o=I,l.addEventListener("message",M,!1)):o=j in p("script")?function(t){d.appendChild(p("script"))[j]=function(){d.removeChild(this),A(t)}}:function(t){setTimeout(H(t),0)}),t.exports={set:w,clear:S}},8053:function(t){var e=TypeError;t.exports=function(t,r){if(t<r)throw e("Not enough arguments");return t}},4553:function(t,e,r){"use strict";var n=r(2109),o=r(2092).findIndex,i=r(1223),a="findIndex",l=!0;a in[]&&[,][a](function(){l=!1}),n({target:"Array",proto:!0,forced:l},{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i(a)},9826:function(t,e,r){"use strict";var n=r(2109),o=r(2092).find,i=r(1223),a="find",l=!0;a in[]&&[,][a](function(){l=!1}),n({target:"Array",proto:!0,forced:l},{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i(a)},9600:function(t,e,r){"use strict";var n=r(2109),o=r(1702),i=r(8361),a=r(5656),l=r(9341),s=o([].join),u=i!=Object,c=l("join",",");n({target:"Array",proto:!0,forced:u||!c},{join:function(t){return s(a(this),void 0===t?",":t)}})},8670:function(t,e,r){var n=r(2109),o=r(6583);n({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},1249:function(t,e,r){"use strict";var n=r(2109),o=r(2092).map;n({target:"Array",proto:!0,forced:!r(1194)("map")},{map:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},5827:function(t,e,r){"use strict";var n=r(2109),o=r(3671).left,i=r(9341),a=r(7392),l=r(5268);n({target:"Array",proto:!0,forced:!i("reduce")||!l&&a>79&&a<83},{reduce:function(t){var e=arguments.length;return o(this,t,e,e>1?arguments[1]:void 0)}})},5069:function(t,e,r){"use strict";var n=r(2109),o=r(1702),i=r(3157),a=o([].reverse),l=[1,2];n({target:"Array",proto:!0,forced:String(l)===String(l.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),a(this)}})},2707:function(t,e,r){"use strict";var n=r(2109),o=r(1702),i=r(9662),a=r(7908),l=r(6244),s=r(5117),u=r(1340),c=r(7293),f=r(4362),h=r(9341),d=r(8886),y=r(256),p=r(7392),m=r(8008),g=[],b=o(g.sort),w=o(g.push),S=c(function(){g.sort(void 0)}),C=c(function(){g.sort(null)}),O=h("sort"),T=!c(function(){if(p)return p<70;if(!d||!(d>3)){if(y)return!0;if(m)return m<603;var t,e,r,n,o="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)g.push({k:e+n,v:r})}for(g.sort(function(t,e){return e.v-t.v}),n=0;n<g.length;n++)e=g[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}});n({target:"Array",proto:!0,forced:S||!C||!O||!T},{sort:function(t){void 0!==t&&i(t);var e,r,n=a(this);if(T)return void 0===t?b(n):b(n,t);var o=[],c=l(n);for(r=0;r<c;r++)r in n&&w(o,n[r]);for(f(o,function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:u(e)>u(r)?1:-1}),e=l(o),r=0;r<e;)n[r]=o[r++];for(;r<c;)s(n,r++);return n}})},561:function(t,e,r){"use strict";var n=r(2109),o=r(7908),i=r(1400),a=r(9303),l=r(6244),s=r(3658),u=r(7207),c=r(5417),f=r(6135),h=r(5117),d=r(1194)("splice"),y=Math.max,p=Math.min;n({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var r,n,d,m,g,b,w=o(this),S=l(w),C=i(t,S),O=arguments.length;for(0===O?r=n=0:1===O?(r=0,n=S-C):(r=O-2,n=p(y(a(e),0),S-C)),u(S+r-n),d=c(w,n),m=0;m<n;m++)(g=C+m)in w&&f(d,m,w[g]);if(d.length=n,r<n){for(m=C;m<S-n;m++)g=m+n,b=m+r,g in w?w[b]=w[g]:h(w,b);for(m=S;m>S-n+r;m--)h(w,m-1)}else if(r>n)for(m=S-n;m>C;m--)g=m+n-1,b=m+r-1,g in w?w[b]=w[g]:h(w,b);for(m=0;m<r;m++)w[m+C]=arguments[m+2];return s(w,S-n+r),d}})},9601:function(t,e,r){var n=r(2109),o=r(1574);n({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},5003:function(t,e,r){var n=r(2109),o=r(7293),i=r(5656),a=r(1236).f,l=r(9781),s=o(function(){a(1)});n({target:"Object",stat:!0,forced:!l||s,sham:!l},{getOwnPropertyDescriptor:function(t,e){return a(i(t),e)}})},9337:function(t,e,r){var n=r(2109),o=r(9781),i=r(3887),a=r(5656),l=r(1236),s=r(6135);n({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(t){for(var e,r,n=a(t),o=l.f,u=i(n),c={},f=0;u.length>f;)void 0!==(r=o(n,e=u[f++]))&&s(c,e,r);return c}})},489:function(t,e,r){var n=r(2109),o=r(7293),i=r(7908),a=r(9518),l=r(8544);n({target:"Object",stat:!0,forced:o(function(){a(1)}),sham:!l},{getPrototypeOf:function(t){return a(i(t))}})},7941:function(t,e,r){var n=r(2109),o=r(7908),i=r(1956);n({target:"Object",stat:!0,forced:r(7293)(function(){i(1)})},{keys:function(t){return i(o(t))}})},8304:function(t,e,r){r(2109)({target:"Object",stat:!0},{setPrototypeOf:r(7674)})},2479:function(t,e,r){var n=r(2109),o=r(4699).values;n({target:"Object",stat:!0},{values:function(t){return o(t)}})},2419:function(t,e,r){var n=r(2109),o=r(5005),i=r(2104),a=r(7065),l=r(8873),s=r(9670),u=r(111),c=r(30),f=r(7293),h=o("Reflect","construct"),d=Object.prototype,y=[].push,p=f(function(){function t(){}return!(h(function(){},[],t) instanceof t)}),m=!f(function(){h(function(){})}),g=p||m;n({target:"Reflect",stat:!0,forced:g,sham:g},{construct:function(t,e){l(t),s(e);var r=arguments.length<3?t:l(arguments[2]);if(m&&!p)return h(t,e,r);if(t==r){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return i(y,n,e),new(i(a,t,n))}var o=r.prototype,f=c(u(o)?o:d),g=i(t,f,e);return u(g)?g:f}})},4819:function(t,e,r){var n=r(2109),o=r(6916),i=r(111),a=r(9670),l=r(5032),s=r(1236),u=r(9518);n({target:"Reflect",stat:!0},{get:function t(e,r){var n,c,f=arguments.length<3?e:arguments[2];return a(e)===f?e[r]:(n=s.f(e,r))?l(n)?n.value:void 0===n.get?void 0:o(n.get,f):i(c=u(e))?t(c,r,f):void 0}})},4603:function(t,e,r){var n=r(9781),o=r(7854),i=r(1702),a=r(4705),l=r(9587),s=r(8880),u=r(8006).f,c=r(7976),f=r(7850),h=r(1340),d=r(4706),y=r(2999),p=r(2626),m=r(8052),g=r(7293),b=r(2597),w=r(9909).enforce,S=r(6340),C=r(5112),O=r(9441),T=r(7168),R=C("match"),E=o.RegExp,k=E.prototype,P=o.SyntaxError,j=i(k.exec),x=i("".charAt),A=i("".replace),H=i("".indexOf),M=i("".slice),I=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,N=/a/g,_=/a/g,D=new E(N)!==N,L=y.MISSED_STICKY,V=y.UNSUPPORTED_Y,B=n&&(!D||L||O||T||g(function(){return _[R]=!1,E(N)!=N||E(_)==_||"/a/i"!=E(N,"i")})),W=function(t){for(var e,r=t.length,n=0,o="",i=!1;n<=r;n++){if("\\"===(e=x(t,n))){o+=e+x(t,++n);continue}i||"."!==e?("["===e?i=!0:"]"===e&&(i=!1),o+=e):o+="[\\s\\S]"}return o},F=function(t){for(var e,r=t.length,n=0,o="",i=[],a={},l=!1,s=!1,u=0,c="";n<=r;n++){if("\\"===(e=x(t,n)))e+=x(t,++n);else if("]"===e)l=!1;else if(!l)switch(!0){case"["===e:l=!0;break;case"("===e:j(I,M(t,n+1))&&(n+=2,s=!0),o+=e,u++;continue;case">"===e&&s:if(""===c||b(a,c))throw new P("Invalid capture group name");a[c]=!0,i[i.length]=[c,u],s=!1,c="";continue}s?c+=e:o+=e}return[o,i]};if(a("RegExp",B)){for(var z=function(t,e){var r,n,o,i,a,u,y=c(k,this),p=f(t),m=void 0===e,g=[],b=t;if(!y&&p&&m&&t.constructor===z)return t;if((p||c(k,t))&&(t=t.source,m&&(e=d(b))),t=void 0===t?"":h(t),e=void 0===e?"":h(e),b=t,O&&("dotAll"in N)&&(n=!!e&&H(e,"s")>-1)&&(e=A(e,/s/g,"")),r=e,L&&("sticky"in N)&&(o=!!e&&H(e,"y")>-1)&&V&&(e=A(e,/y/g,"")),T&&(t=(i=F(t))[0],g=i[1]),a=l(E(t,e),y?this:k,z),(n||o||g.length)&&(u=w(a),n&&(u.dotAll=!0,u.raw=z(W(t),r)),o&&(u.sticky=!0),g.length&&(u.groups=g)),t!==b)try{s(a,"source",""===b?"(?:)":b)}catch(S){}return a},U=u(E),G=0;U.length>G;)p(z,E,U[G++]);k.constructor=z,z.prototype=k,m(o,"RegExp",z,{constructor:!0})}S("RegExp")},4723:function(t,e,r){"use strict";var n=r(6916),o=r(7007),i=r(9670),a=r(8554),l=r(7466),s=r(1340),u=r(4488),c=r(8173),f=r(1530),h=r(7651);o("match",function(t,e,r){return[function(e){var r=u(this),o=a(e)?void 0:c(e,t);return o?n(o,e,r):RegExp(e)[t](s(r))},function(t){var n,o=i(this),a=s(t),u=r(e,o,a);if(u.done)return u.value;if(!o.global)return h(o,a);var c=o.unicode;o.lastIndex=0;for(var d=[],y=0;null!==(n=h(o,a));){var p=s(n[0]);d[y]=p,""===p&&(o.lastIndex=f(a,l(o.lastIndex),c)),y++}return 0===y?null:d}]})},6755:function(t,e,r){"use strict";var n,o=r(2109),i=r(1702),a=r(1236).f,l=r(7466),s=r(1340),u=r(3929),c=r(4488),f=r(4964),h=r(1913),d=i("".startsWith),y=i("".slice),p=Math.min,m=f("startsWith");o({target:"String",proto:!0,forced:!(!h&&!m&&(n=a(String.prototype,"startsWith"))&&!n.writable)&&!m},{startsWith:function(t){var e=s(c(this));u(t);var r=l(p(arguments.length>1?arguments[1]:void 0,e.length)),n=s(t);return d?d(e,n,r):y(e,r,r+n.length)===n}})},1202:function(t,e,r){"use strict";var n,o=r(7854),i=r(1702),a=r(9190),l=r(2423),s=r(7710),u=r(9320),c=r(111),f=r(2050),h=r(9909).enforce,d=r(4811),y=!o.ActiveXObject&&"ActiveXObject"in o,p=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},m=s("WeakMap",p,u);if(d&&y){n=u.getConstructor(p,"WeakMap",!0),l.enable();var g=m.prototype,b=i(g.delete),w=i(g.has),S=i(g.get),C=i(g.set);a(g,{delete:function(t){if(c(t)&&!f(t)){var e=h(this);return e.frozen||(e.frozen=new n),b(this,t)||e.frozen.delete(t)}return b(this,t)},has:function(t){if(c(t)&&!f(t)){var e=h(this);return e.frozen||(e.frozen=new n),w(this,t)||e.frozen.has(t)}return w(this,t)},get:function(t){if(c(t)&&!f(t)){var e=h(this);return e.frozen||(e.frozen=new n),w(this,t)?S(this,t):e.frozen.get(t)}return S(this,t)},set:function(t,e){if(c(t)&&!f(t)){var r=h(this);r.frozen||(r.frozen=new n),w(this,t)?C(this,t,e):r.frozen.set(t,e)}else C(this,t,e);return this}})}},4129:function(t,e,r){r(1202)},1091:function(t,e,r){var n=r(2109),o=r(7854),i=r(261).clear;n({global:!0,bind:!0,enumerable:!0,forced:o.clearImmediate!==i},{clearImmediate:i})},4633:function(t,e,r){r(1091),r(2986)},2986:function(t,e,r){var n=r(2109),o=r(7854),i=r(261).set;n({global:!0,bind:!0,enumerable:!0,forced:o.setImmediate!==i},{setImmediate:i})},6815:function(t,e,r){var n=r(2109),o=r(7854),i=r(7152).setInterval;n({global:!0,bind:!0,forced:o.setInterval!==i},{setInterval:i})},8417:function(t,e,r){var n=r(2109),o=r(7854),i=r(7152).setTimeout;n({global:!0,bind:!0,forced:o.setTimeout!==i},{setTimeout:i})},2564:function(t,e,r){r(6815),r(8417)},7856:function(t){var e;e=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,r){return(e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,r)}function r(t,n,o){return(r=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?function(t,r,n){var o=[null];o.push.apply(o,r);var i=new(Function.bind.apply(t,o));return n&&e(i,n.prototype),i}:Reflect.construct).apply(null,arguments)}function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var i,a=Object.hasOwnProperty,l=Object.setPrototypeOf,s=Object.isFrozen,u=Object.getPrototypeOf,c=Object.getOwnPropertyDescriptor,f=Object.freeze,h=Object.seal,d=Object.create,y="undefined"!=typeof Reflect&&Reflect,p=y.apply,m=y.construct;p||(p=function(t,e,r){return t.apply(e,r)}),f||(f=function(t){return t}),h||(h=function(t){return t}),m||(m=function(t,e){return r(t,n(e))});var g=P(Array.prototype.forEach),b=P(Array.prototype.pop),w=P(Array.prototype.push),S=P(String.prototype.toLowerCase),C=P(String.prototype.match),O=P(String.prototype.replace),T=P(String.prototype.indexOf),R=P(String.prototype.trim),E=P(RegExp.prototype.test),k=(i=TypeError,function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return m(i,e)});function P(t){return function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return p(t,e,n)}}function j(t,e,r){r=r||S,l&&l(t,null);for(var n=e.length;n--;){var o=e[n];if("string"==typeof o){var i=r(o);i!==o&&(s(e)||(e[n]=i),o=i)}t[o]=!0}return t}function x(t){var e,r=d(null);for(e in t)p(a,t,[e])&&(r[e]=t[e]);return r}function A(t,e){for(;null!==t;){var r=c(t,e);if(r){if(r.get)return P(r.get);if("function"==typeof r.value)return P(r.value)}t=u(t)}return function(t){return console.warn("fallback value for",t),null}}var H=f(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),M=f(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),I=f(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),N=f(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_=f(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),D=f(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),L=f(["#text"]),V=f(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),B=f(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),W=f(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),F=f(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=h(/\{\{[\w\W]*|[\w\W]*\}\}/gm),U=h(/<%[\w\W]*|[\w\W]*%>/gm),G=h(/^data-[\-\w.\u00B7-\uFFFF]/),K=h(/^aria-[\-\w]+$/),q=h(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),X=h(/^(?:\w+script|data):/i),$=h(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Y=h(/^html$/i),Z=function(e,r){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(a){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};return function e(){var r,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,a=function(t){return e(t)};if(a.version="2.4.0",a.removed=[],!i||!i.document||9!==i.document.nodeType)return a.isSupported=!1,a;var l=i.document,s=i.document,u=i.DocumentFragment,c=i.HTMLTemplateElement,h=i.Node,d=i.Element,y=i.NodeFilter,p=i.NamedNodeMap,m=void 0===p?i.NamedNodeMap||i.MozNamedAttrMap:p,P=i.HTMLFormElement,J=i.DOMParser,Q=i.trustedTypes,tt=d.prototype,te=A(tt,"cloneNode"),tr=A(tt,"nextSibling"),tn=A(tt,"childNodes"),to=A(tt,"parentNode");if("function"==typeof c){var ti=s.createElement("template");ti.content&&ti.content.ownerDocument&&(s=ti.content.ownerDocument)}var ta=Z(Q,l),tl=ta?ta.createHTML(""):"",ts=s,tu=ts.implementation,tc=ts.createNodeIterator,tf=ts.createDocumentFragment,th=ts.getElementsByTagName,td=l.importNode,ty={};try{ty=x(s).documentMode?s.documentMode:{}}catch(tp){}var tm={};a.isSupported="function"==typeof to&&tu&&void 0!==tu.createHTMLDocument&&9!==ty;var tv=q,tg=null,tb=j({},[].concat(n(H),n(M),n(I),n(_),n(L))),tw=null,tS=j({},[].concat(n(V),n(B),n(W),n(F))),tC=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),tO=null,tT=null,tR=!0,tE=!0,tk=!1,tP=!1,tj=!1,tx=!1,tA=!1,tH=!1,tM=!1,tI=!1,tN=!0,t_=!1,tD=!0,tL=!1,tV={},tB=null,tW=j({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tF=null,tz=j({},["audio","video","img","source","image","track"]),tU=null,tG=j({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tK="http://www.w3.org/1998/Math/MathML",tq="http://www.w3.org/2000/svg",tX="http://www.w3.org/1999/xhtml",t$=tX,tY=!1,tZ=["application/xhtml+xml","text/html"],tJ=null,tQ=s.createElement("form"),t0=function(t){return t instanceof RegExp||t instanceof Function},t1=function(e){tJ&&tJ===e||(e&&"object"===t(e)||(e={}),e=x(e),o="application/xhtml+xml"===(r=r=-1===tZ.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?function(t){return t}:S,tg="ALLOWED_TAGS"in e?j({},e.ALLOWED_TAGS,o):tb,tw="ALLOWED_ATTR"in e?j({},e.ALLOWED_ATTR,o):tS,tU="ADD_URI_SAFE_ATTR"in e?j(x(tG),e.ADD_URI_SAFE_ATTR,o):tG,tF="ADD_DATA_URI_TAGS"in e?j(x(tz),e.ADD_DATA_URI_TAGS,o):tz,tB="FORBID_CONTENTS"in e?j({},e.FORBID_CONTENTS,o):tW,tO="FORBID_TAGS"in e?j({},e.FORBID_TAGS,o):{},tT="FORBID_ATTR"in e?j({},e.FORBID_ATTR,o):{},tV="USE_PROFILES"in e&&e.USE_PROFILES,tR=!1!==e.ALLOW_ARIA_ATTR,tE=!1!==e.ALLOW_DATA_ATTR,tk=e.ALLOW_UNKNOWN_PROTOCOLS||!1,tP=e.SAFE_FOR_TEMPLATES||!1,tj=e.WHOLE_DOCUMENT||!1,tH=e.RETURN_DOM||!1,tM=e.RETURN_DOM_FRAGMENT||!1,tI=e.RETURN_TRUSTED_TYPE||!1,tA=e.FORCE_BODY||!1,tN=!1!==e.SANITIZE_DOM,t_=e.SANITIZE_NAMED_PROPS||!1,tD=!1!==e.KEEP_CONTENT,tL=e.IN_PLACE||!1,tv=e.ALLOWED_URI_REGEXP||tv,t$=e.NAMESPACE||tX,e.CUSTOM_ELEMENT_HANDLING&&t0(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(tC.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&t0(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(tC.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(tC.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),tP&&(tE=!1),tM&&(tH=!0),tV&&(tg=j({},n(L)),tw=[],!0===tV.html&&(j(tg,H),j(tw,V)),!0===tV.svg&&(j(tg,M),j(tw,B),j(tw,F)),!0===tV.svgFilters&&(j(tg,I),j(tw,B),j(tw,F)),!0===tV.mathMl&&(j(tg,_),j(tw,W),j(tw,F))),e.ADD_TAGS&&(tg===tb&&(tg=x(tg)),j(tg,e.ADD_TAGS,o)),e.ADD_ATTR&&(tw===tS&&(tw=x(tw)),j(tw,e.ADD_ATTR,o)),e.ADD_URI_SAFE_ATTR&&j(tU,e.ADD_URI_SAFE_ATTR,o),e.FORBID_CONTENTS&&(tB===tW&&(tB=x(tB)),j(tB,e.FORBID_CONTENTS,o)),tD&&(tg["#text"]=!0),tj&&j(tg,["html","head","body"]),tg.table&&(j(tg,["tbody"]),delete tO.tbody),f&&f(e),tJ=e)},t2=j({},["mi","mo","mn","ms","mtext"]),t9=j({},["foreignobject","desc","title","annotation-xml"]),t6=j({},["title","style","font","a","script"]),t3=j({},M);j(t3,I),j(t3,N);var t8=j({},_);j(t8,D);var t7=function(t){var e=to(t);e&&e.tagName||(e={namespaceURI:tX,tagName:"template"});var r=S(t.tagName),n=S(e.tagName);return t.namespaceURI===tq?e.namespaceURI===tX?"svg"===r:e.namespaceURI===tK?"svg"===r&&("annotation-xml"===n||t2[n]):Boolean(t3[r]):t.namespaceURI===tK?e.namespaceURI===tX?"math"===r:e.namespaceURI===tq?"math"===r&&t9[n]:Boolean(t8[r]):t.namespaceURI===tX&&(e.namespaceURI!==tq||!!t9[n])&&(e.namespaceURI!==tK||!!t2[n])&&!t8[r]&&(t6[r]||!t3[r])},t4=function(t){w(a.removed,{element:t});try{t.parentNode.removeChild(t)}catch(r){try{t.outerHTML=tl}catch(e){t.remove()}}},t5=function(t,e){try{w(a.removed,{attribute:e.getAttributeNode(t),from:e})}catch(r){w(a.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!tw[t]){if(tH||tM)try{t4(e)}catch(n){}else try{e.setAttribute(t,"")}catch(o){}}},et=function(t){if(tA)t="<remove></remove>"+t;else{var e,n,o=C(t,/^[\r\n\t ]+/);n=o&&o[0]}"application/xhtml+xml"===r&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var i=ta?ta.createHTML(t):t;if(t$===tX)try{e=new J().parseFromString(i,r)}catch(a){}if(!e||!e.documentElement){e=tu.createDocument(t$,"template",null);try{e.documentElement.innerHTML=tY?"":i}catch(l){}}var u=e.body||e.documentElement;return(t&&n&&u.insertBefore(s.createTextNode(n),u.childNodes[0]||null),t$===tX)?th.call(e,tj?"html":"body")[0]:tj?e.documentElement:u},ee=function(t){return tc.call(t.ownerDocument||t,t,y.SHOW_ELEMENT|y.SHOW_COMMENT|y.SHOW_TEXT,null,!1)},er=function(e){return"object"===t(h)?e instanceof h:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},en=function(t,e,r){tm[t]&&g(tm[t],function(t){t.call(a,e,r,tJ)})},eo=function(t){if(en("beforeSanitizeElements",t,null),t instanceof P&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof m)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore)||E(/[\u0080-\uFFFF]/,t.nodeName))return t4(t),!0;var e,r=o(t.nodeName);if(en("uponSanitizeElement",t,{tagName:r,allowedTags:tg}),t.hasChildNodes()&&!er(t.firstElementChild)&&(!er(t.content)||!er(t.content.firstElementChild))&&E(/<[/\w]/g,t.innerHTML)&&E(/<[/\w]/g,t.textContent)||"select"===r&&E(/<template/i,t.innerHTML))return t4(t),!0;if(!tg[r]||tO[r]){if(!tO[r]&&ea(r)&&(tC.tagNameCheck instanceof RegExp&&E(tC.tagNameCheck,r)||tC.tagNameCheck instanceof Function&&tC.tagNameCheck(r)))return!1;if(tD&&!tB[r]){var n=to(t)||t.parentNode,i=tn(t)||t.childNodes;if(i&&n)for(var l=i.length,s=l-1;s>=0;--s)n.insertBefore(te(i[s],!0),tr(t))}return t4(t),!0}return t instanceof d&&!t7(t)||("noscript"===r||"noembed"===r)&&E(/<\/no(script|embed)/i,t.innerHTML)?(t4(t),!0):(tP&&3===t.nodeType&&(e=O(e=t.textContent,z," "),e=O(e,U," "),t.textContent!==e&&(w(a.removed,{element:t.cloneNode()}),t.textContent=e)),en("afterSanitizeElements",t,null),!1)},ei=function(t,e,r){if(tN&&("id"===e||"name"===e)&&(r in s||r in tQ))return!1;if(tE&&!tT[e]&&E(G,e));else if(tR&&E(K,e));else if(!tw[e]||tT[e]){if(!(ea(t)&&(tC.tagNameCheck instanceof RegExp&&E(tC.tagNameCheck,t)||tC.tagNameCheck instanceof Function&&tC.tagNameCheck(t))&&(tC.attributeNameCheck instanceof RegExp&&E(tC.attributeNameCheck,e)||tC.attributeNameCheck instanceof Function&&tC.attributeNameCheck(e))||"is"===e&&tC.allowCustomizedBuiltInElements&&(tC.tagNameCheck instanceof RegExp&&E(tC.tagNameCheck,r)||tC.tagNameCheck instanceof Function&&tC.tagNameCheck(r))))return!1}else if(tU[e]);else if(E(tv,O(r,$,"")));else if(("src"===e||"xlink:href"===e||"href"===e)&&"script"!==t&&0===T(r,"data:")&&tF[t]);else if(tk&&!E(X,O(r,$,"")));else if(r)return!1;return!0},ea=function(t){return t.indexOf("-")>0},el=function(e){en("beforeSanitizeAttributes",e,null);var r,n,i,l,s=e.attributes;if(s){var u={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:tw};for(l=s.length;l--;){var c=(r=s[l]).name,f=r.namespaceURI;if(n="value"===c?r.value:R(r.value),i=o(c),u.attrName=i,u.attrValue=n,u.keepAttr=!0,u.forceKeepAttr=void 0,en("uponSanitizeAttribute",e,u),n=u.attrValue,!u.forceKeepAttr&&(t5(c,e),u.keepAttr)){if(E(/\/>/i,n)){t5(c,e);continue}tP&&(n=O(n,z," "),n=O(n,U," "));var h=o(e.nodeName);if(ei(h,i,n)){if(t_&&("id"===i||"name"===i)&&(t5(c,e),n="user-content-"+n),ta&&"object"===t(Q)&&"function"==typeof Q.getAttributeType){if(f);else switch(Q.getAttributeType(h,i)){case"TrustedHTML":n=ta.createHTML(n);break;case"TrustedScriptURL":n=ta.createScriptURL(n)}}try{f?e.setAttributeNS(f,c,n):e.setAttribute(c,n),b(a.removed)}catch(d){}}}}en("afterSanitizeAttributes",e,null)}},es=function t(e){var r,n=ee(e);for(en("beforeSanitizeShadowDOM",e,null);r=n.nextNode();)en("uponSanitizeShadowNode",r,null),eo(r)||(r.content instanceof u&&t(r.content),el(r));en("afterSanitizeShadowDOM",e,null)};return a.sanitize=function(e){var r,n,s,c,f,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((tY=!e)&&(e="<!-->"),"string"!=typeof e&&!er(e)){if("function"!=typeof e.toString)throw k("toString is not a function");if("string"!=typeof(e=e.toString()))throw k("dirty is not a string, aborting")}if(!a.isSupported){if("object"===t(i.toStaticHTML)||"function"==typeof i.toStaticHTML){if("string"==typeof e)return i.toStaticHTML(e);if(er(e))return i.toStaticHTML(e.outerHTML)}return e}if(tx||t1(d),a.removed=[],"string"==typeof e&&(tL=!1),tL){if(e.nodeName){var y=o(e.nodeName);if(!tg[y]||tO[y])throw k("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof h)1===(n=(r=et("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===n.nodeName?r=n:"HTML"===n.nodeName?r=n:r.appendChild(n);else{if(!tH&&!tP&&!tj&&-1===e.indexOf("<"))return ta&&tI?ta.createHTML(e):e;if(!(r=et(e)))return tH?null:tI?tl:""}r&&tA&&t4(r.firstChild);for(var p=ee(tL?e:r);s=p.nextNode();)3===s.nodeType&&s===c||eo(s)||(s.content instanceof u&&es(s.content),el(s),c=s);if(c=null,tL)return e;if(tH){if(tM)for(f=tf.call(r.ownerDocument);r.firstChild;)f.appendChild(r.firstChild);else f=r;return tw.shadowroot&&(f=td.call(l,f,!0)),f}var m=tj?r.outerHTML:r.innerHTML;return tj&&tg["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&E(Y,r.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+m),tP&&(m=O(m,z," "),m=O(m,U," ")),ta&&tI?ta.createHTML(m):m},a.setConfig=function(t){t1(t),tx=!0},a.clearConfig=function(){tJ=null,tx=!1},a.isValidAttribute=function(t,e,r){return tJ||t1({}),ei(o(t),o(e),r)},a.addHook=function(t,e){"function"==typeof e&&(tm[t]=tm[t]||[],w(tm[t],e))},a.removeHook=function(t){if(tm[t])return b(tm[t])},a.removeHooks=function(t){tm[t]&&(tm[t]=[])},a.removeAllHooks=function(){tm={}},a}()},t.exports=e()},1655:function(t,e,r){"use strict";r.d(e,{P:function(){return l},Q:function(){return a}}),r(4916),r(4723),r(5306),r(6755),r(7042),r(9600),r(3290),r(2772);var n=/^(\r\n|\n\r|\r|\n)/,o=/^[^\t\r\n]+/,i=/^\t/;function a(t){var e,r=[[""]];if(0===t.length)return r;for(var a=0,l=0;t.length>0&&e!==t.length;)if(e=t.length,t.match(i))t=t.replace(i,""),a+=1,r[l][a]="";else if(t.match(n))t=t.replace(n,""),a=0,r[l+=1]=[""];else{var s="";if(t.startsWith('"')){for(var u=0,c=!0;c;){var f=t.slice(0,1);'"'===f&&(u+=1),s+=f,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&u%2==0)&&(c=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(t){return Array(Math.floor(t.length/2)).fill('"').join("")})}else{var h=t.match(o);s=h?h[0]:"",t=t.slice(s.length)}r[l][a]=s}return r}function l(t){var e,r,n,o,i,a="";for(e=0,r=t.length;e<r;e+=1){for(n=0,o=t[e].length;n<o;n+=1)n>0&&(a+="	"),"string"==typeof(i=t[e][n])?i.indexOf("\n")>-1?a+='"'.concat(i.replace(/"/g,'""'),'"'):a+=i:null==i?a+="":a+=i;e!==r-1&&(a+="\n")}return a}},6223:function(t,e,r){"use strict";r.d(e,{Ii:function(){return n},vp:function(){return o}});var n=1,o=2},2792:function(t,e,r){"use strict";r(6992),r(1539),r(8783),r(4129),r(3948),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165);var n=r(6223);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==o(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==o(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}var a=new WeakMap,l=function(){var t,e;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,l=t.overrideFn,s=t.calculationType,u=t.stretchMode,c=t.stretchingItemWidthFn;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),a.set(this,{viewportWidth:e,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:l,calculationType:s,stretchingColumnWidthFn:void 0===c?function(t){return t}:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=u,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return e=[{key:"DEFAULT_WIDTH",get:function(){return 50}}],t=[{key:"calculate",value:function(){for(var t,e=0,r=!0,o=[],i=a.get(this),l=i.calculationType,s=i.overrideFn,u=i.scrollOffset,c=i.totalColumns,f=i.viewportWidth,h=0;h<c;h++){t=this._getColumnWidth(h),e<=u&&l!==n.vp&&(this.startColumn=h);var d=u>0?f+1:f;if(e>=u&&e+(l===n.vp?t:0)<=u+d&&((null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=h),this.endColumn=h),o.push(e),e+=t,l!==n.vp&&(this.endColumn=h),e>=u+f){r=!1;break}}if(this.endColumn===c-1&&r)for(this.startColumn=this.endColumn;this.startColumn>0;){var y=o[this.endColumn]+t-o[this.startColumn-1];if((y<=f||l!==n.vp)&&(this.startColumn-=1),y>f)break}l===n.Ii&&null!==this.startColumn&&s&&s(this),this.startPosition=o[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),c<this.endColumn&&(this.endColumn=c-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if("none"!==this.stretch){var e=t;this.totalTargetWidth=e;for(var r=a.get(this),n=r.totalColumns,o=0,i=0;i<n;i++){var l=this._getColumnWidth(i),s=r.stretchingColumnWidthFn(void 0,i);"number"==typeof s?e-=s:o+=l}var u=e-o;if("all"===this.stretch&&u>0)this.stretchAllRatio=e/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var c=this._getColumnWidth(n-1),f=u+c;this.stretchLastWidth=f>=0?f:c}}}},{key:"getStretchedColumnWidth",value:function(t,e){var r=null;return"all"===this.stretch&&0!==this.stretchAllRatio?r=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(r=this._getStretchedLastColumnWidth(t)),r}},{key:"_getStretchedAllColumnWidth",value:function(t,e){var r=0,n=a.get(this),o=n.totalColumns;if(!this.stretchAllColumnsWidth[t]){var i=Math.round(e*this.stretchAllRatio),l=n.stretchingColumnWidthFn(i,t);void 0===l?this.stretchAllColumnsWidth[t]=i:this.stretchAllColumnsWidth[t]=isNaN(l)?this._getColumnWidth(t):l}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var s=0;s<this.stretchAllColumnsWidth.length;s++)r+=this.stretchAllColumnsWidth[s];r!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-r)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){return t===a.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var e=a.get(this).columnWidthFn(t);return isNaN(e)&&(e=r.DEFAULT_WIDTH),e}}],i(r.prototype,t),e&&i(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();e.Z=l},1343:function(t,e,r){"use strict";r(6992),r(1539),r(8783),r(4129),r(3948),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165);var n=r(6223);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==o(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==o(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}var a=new WeakMap,l=function(){var t,e;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,l=t.overrideFn,s=t.calculationType,u=t.scrollbarHeight;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),a.set(this,{viewportHeight:e,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:l,calculationType:s,horizontalScrollbarHeight:u}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return e=[{key:"DEFAULT_HEIGHT",get:function(){return 23}}],t=[{key:"calculate",value:function(){for(var t,e=0,o=!0,i=[],l=a.get(this),s=l.calculationType,u=l.overrideFn,c=l.rowHeightFn,f=l.scrollOffset,h=l.totalRows,d=l.viewportHeight,y=l.horizontalScrollbarHeight||0,p=0;p<h;p++)if(isNaN(t=c(p))&&(t=r.DEFAULT_HEIGHT),e<=f&&s!==n.vp&&(this.startRow=p),e>=f&&e+(s===n.vp?t:0)<=f+d-y&&(null===this.startRow&&(this.startRow=p),this.endRow=p),i.push(e),e+=t,s!==n.vp&&(this.endRow=p),e>=f+d-y){o=!1;break}if(this.endRow===h-1&&o)for(this.startRow=this.endRow;this.startRow>0;){var m=i[this.endRow]+t-i[this.startRow-1];if((m<=d-y||s!==n.vp)&&(this.startRow-=1),m>=d-y)break}s===n.Ii&&null!==this.startRow&&u&&u(this),this.startPosition=i[this.startRow],void 0===this.startPosition&&(this.startPosition=null),h<this.endRow&&(this.endRow=h-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}],i(r.prototype,t),e&&i(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();e.Z=l},9368:function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function i(t,e,r){return(e=a(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t){var e=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!==n(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n(e)?e:String(e)}function l(t,e){var r=s(t,e,"get");return r.get?r.get.call(t):r.value}function s(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}r(6992),r(1539),r(8783),r(4129),r(3948),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165);var u=new WeakMap,c=function(){var t;function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),i(this,"row",null),i(this,"col",null),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,u),u.set(this,{writable:!0,value:!1}),function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(this,s(this,u,"set"),n),void 0!==t&&void 0!==r&&(this.row=t,this.col=r)}return o(e.prototype,[{key:"isValid",value:function(t){return!(this.row<0||this.col<0||this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this||this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&(l(this,u)?this.col<=t.col:this.col>=t.col)}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&(l(this,u)?this.col>=t.col:this.col<=t.col)}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&(l(this,u)?this.col>=t.col:this.col<=t.col)}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&(l(this,u)?this.col<=t.col:this.col>=t.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,l(this,u))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),t&&o(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();e.Z=c},1640:function(t,e,r){"use strict";r(6699),r(2023),r(2772),r(6992),r(1539),r(8783),r(4129),r(3948),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165);var n=r(9368);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function a(t,e,r){return(e=l(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t){var e=function(t,e){if("object"!==o(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==o(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===o(e)?e:String(e)}function s(t,e){var r=u(t,e,"get");return r.get?r.get.call(t):r.value}function u(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var c=new WeakMap,f=function(){var t,e;function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),a(this,"highlight",null),a(this,"from",null),a(this,"to",null),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,c),c.set(this,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=e.clone(),this.to=n.clone(),function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(this,u(this,c,"set"),o)}return t=[{key:"setHighlight",value:function(t){return this.highlight=t.clone().normalize(),this}},{key:"setFrom",value:function(t){return this.from=t.clone(),this}},{key:"setTo",value:function(t){return this.to=t.clone(),this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(t){var e=t.row,r=t.col,n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return n.row<=e&&o.row>=e&&n.col<=r&&o.col>=r}},{key:"includesRange",value:function(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getOuterTopRightCorner().col>=t.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=t.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=t.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=t.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getOuterBottomRightCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=t.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=t.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=t.getOuterTopRightCorner().row}},{key:"expand",value:function(t){var e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>r.row||t.col>r.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(r.row,t.row),Math.max(r.col,t.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=this.getDirection(),o=t.getOuterTopStartCorner(),i=t.getOuterBottomEndCorner(),a=Math.min(e.row,o.row),l=Math.min(e.col,o.col),s=Math.max(r.row,i.row),u=Math.max(r.col,i.col),c=this._createCellCoords(a,l),f=this._createCellCoords(s,u);return this.from=c,this.to=f,this.setDirection(n),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var e=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=e[0],this.to=e[1];break;case"NE-SW":var r=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=r[0],this.to=r[1];break;case"SE-NW":var n=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=n[0],this.to=n[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return s(this,c)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return s(this,c)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return s(this,c)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return s(this,c)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return s(this,c)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return s(this,c)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return s(this,c)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return s(this,c)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(t,e){return!!(e&&e.includes(t)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(e.from.row,e.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(e.from.row,e.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(e.to.row,e.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(e.to.row,e.to.col))))||t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(t,e){if(!(t instanceof n.Z))return!1;if(e){var r=e.from,o=e.to;if(e.includes(t)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}return t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},n=[];return e.top===r.top&&n.push("top"),e.right===r.right&&n.push("right"),e.bottom===r.bottom&&n.push("bottom"),e.left===r.left&&n.push("left"),n}},{key:"getInner",value:function(){for(var t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),r=[],n=t.row;n<=e.row;n++)for(var o=t.col;o<=e.col;o++)this.from.row===n&&this.from.col===o||this.to.row===n&&this.to.col===o||r.push(this._createCellCoords(n,o));return r}},{key:"getAll",value:function(){for(var t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),r=[],n=t.row;n<=e.row;n++)for(var o=t.col;o<=e.col;o++)t.row===n&&t.col===o?r.push(t):e.row===n&&e.col===o?r.push(e):r.push(this._createCellCoords(n,o));return r}},{key:"forAll",value:function(t){for(var e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=e.row;n<=r.row;n++)for(var o=e.col;o<=r.col;o++)if(!1===t(n,o))return}},{key:"clone",value:function(){return new r(this.highlight,this.from,this.to,s(this,c))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(t,e){return new n.Z(t,e,s(this,c))}}],i(r.prototype,t),e&&i(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();e.Z=f},6475:function(t,e,r){"use strict";r.d(e,{DA:function(){return f},V1:function(){return c},xN:function(){return h}});var n=r(5872),o=r(6187),i=r(9847),a=r(8894),l=(0,n.Z)("cellTypes"),s=l.register,u=l.getItem,c=l.hasItem;function f(t){if(!c(t))throw Error('You declared cell type "'.concat(t,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return u(t)}function h(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);var r=e,n=r.editor,l=r.renderer,u=r.validator;n&&(0,o.qm)(t,n),l&&(0,i.zn)(t,l),u&&(0,a.Ie)(t,u),s(t,e)}l.getNames,l.getValues},5864:function(t,e,r){"use strict";r.d(e,{n:function(){return i}});var n=r(631),o=r(337),i={CELL_TYPE:"text",editor:n.H,renderer:o.V}},7002:function(t,e,r){"use strict";r(3161),r(9653),r(1539),r(4747),r(6649),r(6078),r(2526),r(1817),r(2165),r(6992),r(8783),r(3948);var n=r(7772),o=r(3817),i=r(613),a=r(2226),l=r(7161);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==s(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==s(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===s(e)?e:String(e)}(n.key),n)}}var c=function(){var t,e;function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.hot=t,this.data=e,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return t=[{key:"modifyRowData",value:function(t){var e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}},{key:"setData",value:function(t){this.data=t}},{key:"getAtColumn",value:function(t){var e=this,r=[];return(0,i.Bk)(this.data,function(n,o){var i=e.getAtCell(o,t);r.push(i)}),r}},{key:"getAtRow",value:function(t,e,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=void 0===e&&void 0===r,u=null,c=null;if(Array.isArray(u=this.modifyRowData(t)))c=[],s?u.forEach(function(e,r){c[r]=o.getAtPhysicalCell(t,r,u)}):(0,a.q4)(e,r,function(r){c[r-e]=o.getAtPhysicalCell(t,r,u)});else if((0,n.Kn)(u)||(0,l.mf)(u)){if(c=i?[]:{},!s||i){var f=this.countFirstRowKeys()-1;(0,a.q4)(0,f,function(a){var l=o.colToProp(a);if(a>=(e||0)&&a<=(r||f)&&!Number.isInteger(l)){var s=o.getAtPhysicalCell(t,l,u);i?c.push(s):(0,n.Hn)(c,l,s)}})}else(0,n._l)(u,function(e,r){(0,n.Hn)(c,r,o.getAtPhysicalCell(t,r,u))})}return c}},{key:"setAtCell",value:function(t,e,r){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=(0,n.sm)(r);this.hot.runHooks("modifySourceData",t,this.propToCol(e),o,"set"),o.isTouched()&&(r=o.value)}Number.isInteger(e)?this.data[t][e]=r:(0,n.Hn)(this.data[t],e,r)}}},{key:"getAtPhysicalCell",value:function(t,e,r){var o=null;if(r&&(o="string"==typeof e?(0,n.$s)(r,e):"function"==typeof e?e(r):r[e]),this.hot.hasHook("modifySourceData")){var i=(0,n.sm)(o);this.hot.runHooks("modifySourceData",t,this.colToProp(e),i,"get"),i.isTouched()&&(o=i.value)}return o}},{key:"getAtCell",value:function(t,e){var r=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),r)}},{key:"getByRange",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,l=null,s=null,u=null;null===e||null===r?(o=!0,i=0,s=this.countRows()-1):(i=Math.min(e.row,r.row),l=Math.min(e.col,r.col),s=Math.max(e.row,r.row),u=Math.max(e.col,r.col));var c=[];return(0,a.q4)(i,s,function(e){c.push(o?t.getAtRow(e,void 0,void 0,n):t.getAtRow(e,l,u,n))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}},{key:"countFirstRowKeys",value:function(){return(0,o.Eb)(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}],u(r.prototype,t),e&&u(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();e.Z=c},2264:function(t,e,r){"use strict";r.d(e,{Z:function(){return L}}),r(1539),r(4747),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165),r(6992),r(8783),r(3948),r(7941),r(7327),r(5003),r(9337);var n=r(7772);r(189),r(3161);var o=r(6475);function i(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i="string"==typeof e.type?(0,o.DA)(e.type):e.type;if(t._automaticallyAssignedMetaProps&&(0,n._l)(e,function(e,r){t._automaticallyAssignedMetaProps.delete(r)}),(0,n.Kn)(i)){r!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);var a={};(0,n._l)(i,function(e,o){var i,l;"CELL_TYPE"!==o&&((null===(i=r._automaticallyAssignedMetaProps)||void 0===i?void 0:i.has(o))||!(0,n.nr)(r,o))&&(a[o]=e,null===(l=t._automaticallyAssignedMetaProps)||void 0===l||l.add(o))}),(0,n.l7)(t,a)}}function a(t){return Number.isInteger(t)&&t>=0}function l(t,e){if(!t())throw Error("Assertion failed: ".concat(e))}var s=r(2004);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach(function(e){var n,o,i;n=t,o=e,i=r[e],(o=y(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function d(t,e,r){return e&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function y(t){var e=function(t,e){if("object"!==u(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==u(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===u(e)?e:String(e)}function p(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}var m=function(){function t(e){p(this,t),this.metaCtor=d(function t(){p(this,t)}),this.meta=this.metaCtor.prototype,(0,n.l7)(this.meta,(0,s.Z)()),this.meta.instance=e}return d(t,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){var e;(0,n.l7)(this.meta,t),i(this.meta,f(f({},t),{},{type:null!==(e=t.type)&&void 0!==e?e:this.meta.type}),t)}}]),t}();function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==g(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==g(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===g(e)?e:String(e)}(n.key),n)}}var w=function(){var t;function e(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e);var r=t.getMetaConstructor();this.meta=new r}return b(e.prototype,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){(0,n.l7)(this.meta,t),i(this.meta,t,t)}}]),t&&b(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();r(2222),r(7042),r(561),r(2772),r(1038),r(8309),r(4916);var S=r(613);function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return T(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==C(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==C(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===C(e)?e:String(e)}(n.key),n)}}var E=function(t){var e,r;function n(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,n),this.valueFactory=t,this.data=[],this.index=[],this.holes=new Set}return e=[{key:"obtain",value:function(t){l(function(){return a(t)},"Expecting an unsigned number.");var e,r=this._getStorageIndexByKey(t);if(r>=0)void 0===(e=this.data[r])&&(e=this.valueFactory(t),this.data[r]=e);else if(e=this.valueFactory(t),this.holes.size>0){var n=this.holes.values().next().value;this.holes.delete(n),this.data[n]=e,this.index[t]=n}else this.data.push(e),this.index[t]=this.data.length-1;return e}},{key:"insert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l(function(){return a(t)||null==t},"Expecting an unsigned number or null/undefined argument.");for(var r=[],n=this.data.length,o=0;o<e;o++)r.push(n+o),this.data.push(void 0);var i=null==t?this.index.length:t;this.index=[].concat(O(this.index.slice(0,i)),r,O(this.index.slice(i)))}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l(function(){return a(t)||null==t},"Expecting an unsigned number or null/undefined argument.");for(var r=this.index.splice(null==t?this.index.length-e:t,e),n=0;n<r.length;n++){var o=r[n];"number"==typeof o&&this.holes.add(o)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var t=this;return(0,S.w7)(this.data,function(e,r){return!t.holes.has(r)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var t=[],e=0;e<this.data.length;e++){var r=this._getKeyByStorageIndex(e);-1!==r&&t.push([r,this.data[e]])}var n=0;return{next:function(){if(n<t.length){var e=t[n];return n+=1,{value:e,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(t){return this.index.length>t?this.index[t]:-1}},{key:"_getKeyByStorageIndex",value:function(t){return this.index.indexOf(t)}},{key:t,value:function(){return this.entries()}}],R(n.prototype,e),r&&R(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n}(Symbol.iterator);function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==k(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==k(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===k(e)?e:String(e)}(n.key),n)}}var j=["data","width"],x=function(){var t,e;function r(t){var e=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.globalMeta=t,this.metas=new E(function(){return e._createMeta()})}return t=[{key:"updateMeta",value:function(t,e){var r=this.getMeta(t);(0,n.l7)(r,e),i(r,e)}},{key:"createColumn",value:function(t,e){this.metas.insert(t,e)}},{key:"removeColumn",value:function(t,e){this.metas.remove(t,e)}},{key:"getMeta",value:function(t){return this.metas.obtain(t)}},{key:"getMetaConstructor",value:function(t){return this.metas.obtain(t).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function r(){}(0,n.ED)(r,t);for(var o=0;o<e.length;o++)r.prototype[e[o]]=void 0;return r}(this.globalMeta.getMetaConstructor(),j).prototype}}],P(r.prototype,t),e&&P(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==A(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==A(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===A(e)?e:String(e)}(n.key),n)}}r(1532);var I=function(){var t,e;function r(t){var e=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.columnMeta=t,this.metas=new E(function(){return e._createRow()})}return t=[{key:"updateMeta",value:function(t,e,r){var o=this.getMeta(t,e);(0,n.l7)(o,r),i(o,r)}},{key:"createRow",value:function(t,e){this.metas.insert(t,e)}},{key:"createColumn",value:function(t,e){for(var r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(t,e)}},{key:"removeRow",value:function(t,e){this.metas.remove(t,e)}},{key:"removeColumn",value:function(t,e){for(var r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(t,e)}},{key:"getMeta",value:function(t,e,r){var n=this.metas.obtain(t).obtain(e);return void 0===r?n:n[r]}},{key:"setMeta",value:function(t,e,r,n){var o,i=this.metas.obtain(t).obtain(e);null===(o=i._automaticallyAssignedMetaProps)||void 0===o||o.delete(r),i[r]=n}},{key:"removeMeta",value:function(t,e,r){delete this.metas.obtain(t).obtain(e)[r]}},{key:"getMetas",value:function(){for(var t,e=[],r=Array.from(this.metas.values()),n=0;n<r.length;n++)e.push.apply(e,function(t){if(Array.isArray(t))return H(t)}(t=r[n].values())||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return H(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return e}},{key:"getMetasAtRow",value:function(t){l(function(){return a(t)},"Expecting an unsigned number.");var e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var t=this;return new E(function(e){return t._createMeta(e)})}},{key:"_createMeta",value:function(t){return new(this.columnMeta.getMetaConstructor(t))}}],M(r.prototype,t),e&&M(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}(),N=r(5981);function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==_(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==_(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===_(e)?e:String(e)}(n.key),n)}}var L=function(){var t,e;function r(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.hot=t,this.globalMeta=new m(t),this.tableMeta=new w(this.globalMeta),this.columnMeta=new x(this.globalMeta),this.cellMeta=new I(this.columnMeta),o.forEach(function(t){return new t(e)}),this.globalMeta.updateMeta(n)}return t=[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(t){this.globalMeta.updateMeta(t)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(t){this.tableMeta.updateMeta(t)}},{key:"getColumnMeta",value:function(t){return this.columnMeta.getMeta(t)}},{key:"updateColumnMeta",value:function(t,e){this.columnMeta.updateMeta(t,e)}},{key:"getCellMeta",value:function(t,e,r){var n=r.visualRow,o=r.visualColumn,i=this.cellMeta.getMeta(t,e);return i.visualRow=n,i.visualCol=o,i.row=t,i.col=e,this.runLocalHooks("afterGetCellMeta",i),i}},{key:"getCellMetaKeyValue",value:function(t,e,r){if("string"!=typeof r)throw Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,r)}},{key:"setCellMeta",value:function(t,e,r,n){this.cellMeta.setMeta(t,e,r,n)}},{key:"updateCellMeta",value:function(t,e,r){this.cellMeta.updateMeta(t,e,r)}},{key:"removeCellMeta",value:function(t,e,r){this.cellMeta.removeMeta(t,e,r)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(t){return this.cellMeta.getMetasAtRow(t)}},{key:"createRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}},{key:"removeRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}},{key:"createColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}},{key:"removeColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}],D(r.prototype,t),e&&D(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();(0,n.jB)(L,N.Z)},2654:function(t,e,r){"use strict";r.d(e,{$:function(){return s}}),r(6992),r(1532),r(1539),r(8783),r(3948),r(189),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165);var n=r(3909),o=r(7772),i=r(7161);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==a(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}var s=function(){var t,e;function r(t){var e=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(t){return e.extendCellMeta(t)}),n.Z.getSingleton().add("beforeRender",function(t){t&&e.metaSyncMemo.clear()},this.metaManager.hot)}return t=[{key:"extendCellMeta",value:function(t){var e,r,n=t.row,a=t.col;if(!(null!==(e=this.metaSyncMemo.get(n))&&void 0!==e&&e.has(a))){var l=t.visualRow,s=t.visualCol,u=this.metaManager.hot,c=u.colToProp(s);t.prop=c,u.runHooks("beforeGetCellMeta",l,s,t);var f=(0,o.nr)(t,"type")?t.type:null,h=(0,i.mf)(t.cells)?t.cells(n,a,c):null;f&&(h?h.type=null!==(r=h.type)&&void 0!==r?r:f:h={type:f}),h&&this.metaManager.updateCellMeta(n,a,h),u.runHooks("afterGetCellMeta",l,s,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(a)}}}],l(r.prototype,t),e&&l(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}()},7226:function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!==n(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n(e)?e:String(e)}(o.key),o)}}r.d(e,{_:function(){return i}}),r(6992),r(1539),r(189),r(8783),r(3948),r(1532),r(4747),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165);var i=function(){var t,e;function r(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(t){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===t)throw Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(t,e,r){if(!r)throw Error("The `".concat(t,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return t=[{key:"extendMetaProps",value:function(){var t=this;this.propDescriptors.forEach(function(e,r){var n=e.target,o=e.onChange,i=void 0===o?function(){}:o,a="string"==typeof n,l=a?n:r,s="_".concat(l);t.metaManager.globalMeta.meta[s]=t.metaManager.globalMeta.meta[l],t.installPropWatcher(r,s,i),a&&t.installPropWatcher(n,s,i)})}},{key:"installPropWatcher",value:function(t,e,r){var n=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get:function(){return this[e]},set:function(o){var i=!n.usageTracker.has(t);n.usageTracker.add(t),r.call(n,t,o,i),this[e]=o},enumerable:!0,configurable:!0})}}],o(r.prototype,t),e&&o(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}()},6068:function(t,e,r){"use strict";r.d(e,{o:function(){return g}}),r(561),r(2222),r(2526),r(1817),r(1539),r(2165),r(6992),r(8783),r(3948);var n=r(9272),o=r(7161);r(1532),r(3161),r(9653),r(2707),r(7042),r(4747),r(7327),r(2772),r(6649),r(6078),r(1038),r(8309),r(4916);var i=r(1655),a=r(3817),l=r(7772),s=r(613),u=r(2226),c=r(1799);function f(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==d(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==d(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===d(e)?e:String(e)}(n.key),n)}}var p=function(){var t,e;function r(t,e,n){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return e=[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}],t=[{key:"createMap",value:function(){var t,e=this.getSchema();if(void 0===e)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var r=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,r){var n=0,o=0,i=!1;if("function"==typeof r){var a=(0,l.Q8)(e);n=a>0?a:this.countFirstRowKeys(),i=!0}else n=Math.min(this.tableMeta.maxCols,r.length);for(t=0;t<n;t++){var s=i?r(t):r[t];if((0,l.Kn)(s)){if(void 0!==s.data){var u=i?o:t;this.colToPropCache[u]=s.data,this.propToColCache.set(s.data,u)}o+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return(0,a.Eb)(this.dataSource)}},{key:"recursiveDuckColumns",value:function(t,e,r){var n,o=this,i=e,a=r;return void 0===i&&(i=0,a=""),"object"!==d(t)||Array.isArray(t)||(0,l._l)(t,function(t,e){null===t?(n=a+e,o.colToPropCache.push(n),o.propToColCache.set(n,i),i+=1):i=o.recursiveDuckColumns(t,i,"".concat(e,"."))}),i}},{key:"colToProp",value:function(t){if(!1===Number.isInteger(t))return t;var e=this.instance.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&(0,c.$K)(this.colToPropCache[e])?this.colToPropCache[e]:e}},{key:"propToCol",value:function(t){var e=this.propToColCache.get(t);if((0,c.$K)(e))return this.instance.toVisualColumn(e);var r=this.instance.toVisualColumn(t);return null===r?t:r}},{key:"getSchema",value:function(){var t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?(0,l.ie)(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.source,i=n.mode,a=this.instance.countSourceRows(),s=a,c=0,f=t;if(("number"!=typeof f||f>=a)&&(f=a),f<this.instance.countRows()&&(s=this.instance.toPhysicalRow(f)),!1===this.instance.runHooks("beforeCreateRow",f,r,o)||null===s)return{delta:0};for(var h=this.tableMeta.maxRows,d=this.getSchema().length,y=[];c<r&&a+c<h;)!function(){var t=null;"array"===e.instance.dataType?e.tableMeta.dataSchema?t=(0,l.I8)(e.getSchema()):(t=[],(0,u.q4)(d-1,function(){return t.push(null)})):"function"===e.instance.dataType?t=e.tableMeta.dataSchema(f+c):(t={},(0,l.ZB)(t,e.getSchema())),y.push(t),c+=1}();this.instance.rowIndexMapper.insertIndexes(f,c),"below"===(void 0===i?"above":i)&&(s=Math.min(s+1,a)),this.spliceData(s,0,y);var p=this.instance.toVisualRow(s);return this.instance.countSourceRows()===y.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(null==t?this.metaManager.createRow(null,c):"auto"!==o&&this.metaManager.createRow(s,r)),this.instance.runHooks("afterCreateRow",p,c,o),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:s}}},{key:"createCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.source,o=r.mode;if(!this.instance.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i=this.dataSource,a=this.tableMeta.maxCols,l=this.instance.countSourceCols(),s=t;if(("number"!=typeof s||s>=l)&&(s=l),!1===this.instance.runHooks("beforeCreateCol",s,e,n))return{delta:0};var u=l;s<this.instance.countCols()&&(u=this.instance.toPhysicalColumn(s));var c=this.instance.countSourceRows(),f=this.instance.countCols(),h=0,d=u;"end"===(void 0===o?"start":o)&&(d=Math.min(d+1,l));for(var y=d;h<e&&f<a;){if("number"!=typeof s||s>=f){if(c>0)for(var p=0;p<c;p+=1)void 0===i[p]&&(i[p]=[]),i[p].push(null);else i.push([null])}else for(var m=0;m<c;m++)i[m].splice(d,0,null);h+=1,d+=1,f+=1}this.instance.columnIndexMapper.insertIndexes(s,h),h>0&&(null==t?this.metaManager.createColumn(null,h):"auto"!==n&&this.metaManager.createColumn(y,e));var g=this.instance.toVisualColumn(y);return this.instance.runHooks("afterCreateCol",g,h,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:h,startPhysicalIndex:y}}},{key:"removeRow",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(t)?t:-r,i=this.visualRowsToPhysical(o,r),a=this.instance.countSourceRows();if(o=(a+o)%a,!1===this.instance.runHooks("beforeRemoveRow",o,i.length,i,n))return!1;var l=i.length;if(this.filterData(o,l,i),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(i);var s=(0,c.$K)(this.tableMeta.columns)||(0,c.$K)(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===s&&this.instance.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort(function(t,e){return e-t}).forEach(function(t){e.metaManager.removeRow(t,1)}),this.instance.runHooks("afterRemoveRow",o,l,i,n),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw Error("cannot remove column with object data source or columns option specified");var n="number"!=typeof t?-e:t;n=(this.instance.countCols()+n)%this.instance.countCols();var o=this.visualColumnsToPhysical(n,e),i=o.slice(0).sort(function(t,e){return e-t});if(!1===this.instance.runHooks("beforeRemoveCol",n,e,o,r))return!1;for(var a=!0,l=i.length,s=this.dataSource,u=0;u<l;u++)a&&o[0]!==o[u]-u&&(a=!1);if(a)for(var c=0,f=this.instance.countSourceRows();c<f;c++)s[c].splice(o[0],e),0===c&&this.metaManager.removeColumn(o[0],e);else for(var h=0,d=this.instance.countSourceRows();h<d;h++)for(var y=0;y<l;y++)s[h].splice(i[y],1),0===h&&this.metaManager.removeColumn(i[y],1);return n<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",n,e,o,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(t,e,r){for(var n=this.instance.getDataAtCol(t),o=n.slice(e,e+r),i=n.slice(e+r),a=arguments.length,l=Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];(0,s.g9)(l,i);for(var c=0;c<r;)l.push(null),c+=1;return(0,s.PI)(l),this.instance.populateFromArray(e,t,l,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(t,e,r){for(var n=this.instance.getSourceDataAtRow(t),o=n.slice(e,e+r),i=n.slice(e+r),a=arguments.length,l=Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];(0,s.g9)(l,i);for(var c=0;c<r;)l.push(null),c+=1;return this.instance.populateFromArray(t,e,[l],null,null,"spliceRow"),o}},{key:"spliceData",value:function(t,e,r){var n=this;if(!1!==this.instance.runHooks("beforeDataSplice",t,e,r)){var o=[].concat(f(this.dataSource.slice(0,t)),f(r),f(this.dataSource.slice(t)));this.dataSource.length=0,o.forEach(function(t){return n.dataSource.push(t)})}}},{key:"filterData",value:function(t,e,r){var n=this.instance.runHooks("filterData",t,e,r);!1===Array.isArray(n)&&(n=this.dataSource.filter(function(t,e){return -1===r.indexOf(e)})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}},{key:"get",value:function(t,e){var r=this.instance.toPhysicalRow(t),n=this.dataSource[r],o=this.instance.runHooks("modifyRowData",r);n=isNaN(o)?o:n;var i=null;if(n&&n.hasOwnProperty&&(0,l.nr)(n,e))i=n[e];else if("string"==typeof e&&e.indexOf(".")>-1){var a=e.split("."),s=n;if(!s)return null;for(var u=0,c=a.length;u<c;u++)if(void 0===(s=s[a[u]]))return null;i=s}else"function"==typeof e&&(i=e(this.dataSource.slice(r,r+1)[0]));if(this.instance.hasHook("modifyData")){var f=(0,l.sm)(i);this.instance.runHooks("modifyData",r,this.propToCol(e),f,"get"),f.isTouched()&&(i=f.value)}return i}},{key:"getCopyable",value:function(t,e){return this.instance.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}},{key:"set",value:function(t,e,r){var n=this.instance.toPhysicalRow(t),o=r,i=this.dataSource[n],a=this.instance.runHooks("modifyRowData",n);if(i=isNaN(a)?a:i,this.instance.hasHook("modifyData")){var s=(0,l.sm)(o);this.instance.runHooks("modifyData",n,this.propToCol(e),s,"set"),s.isTouched()&&(o=s.value)}if(i&&i.hasOwnProperty&&(0,l.nr)(i,e))i[e]=o;else if("string"==typeof e&&e.indexOf(".")>-1){var u,c=e.split("."),f=i,h=0;for(h=0,u=c.length-1;h<u;h++)void 0===f[c[h]]&&(f[c[h]]={}),f=f[c[h]];f[c[h]]=o}else"function"==typeof e?e(this.dataSource.slice(n,n+1)[0],o):i[e]=o}},{key:"visualRowsToPhysical",value:function(t,e){for(var r=this.instance.countSourceRows(),n=[],o=(r+t)%r,i=e;o<r&&i;)n.push(this.instance.toPhysicalRow(o)),i-=1,o+=1;return n}},{key:"visualColumnsToPhysical",value:function(t,e){for(var r=this.instance.countCols(),n=[],o=(r+t)%r,i=e;o<r&&i;){var a=this.instance.toPhysicalColumn(o);n.push(a),i-=1,o+=1}return n}},{key:"clear",value:function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")}},{key:"getLength",value:function(){var t=this.tableMeta.maxRows;return Math.min(this.instance.rowIndexMapper.getNotTrimmedIndexesLength(),t<0||0===t?0:t||1/0)}},{key:"getAll",value:function(){var t={row:0,col:0},e={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-e.row!=0||this.instance.countSourceRows()?this.getRange(t,e,r.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,e,n){var o,i,a,l=[],s=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(0===s||0===u)return[];var c=n===r.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(s-1,0),Math.max(t.row,e.row)),h=Math.min(Math.max(u-1,0),Math.max(t.col,e.col));for(o=Math.min(t.row,e.row);o<=f;o++){a=[];var d=o>=0?this.instance.toPhysicalRow(o):o;for(i=Math.min(t.col,e.col);i<=h&&null!==d;i++)a.push(c.call(this,o,this.colToProp(i)));null!==d&&l.push(a)}return l}},{key:"getText",value:function(t,e){return(0,i.P)(this.getRange(t,e,r.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,e){return(0,i.P)(this.getRange(t,e,r.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],y(r.prototype,t),e&&y(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e,r,i){var a=i.hotInstance,s=i.dataMap,u=i.dataSource,c=i.internalSource,f=i.source,h=i.metaManager,d=i.firstRun,y=(0,n.ct)(c),g=a.getSettings();Array.isArray(g.dataSchema)?a.dataType="array":(0,o.mf)(g.dataSchema)?a.dataType="function":a.dataType="object",s&&s.destroy(),t=a.runHooks("before".concat(y),t,d,f);var b=new p(a,t,h);if(e(b),"object"===m(t)&&null!==t)t.push&&t.splice||(t=[t]);else if(null===t){var w,S=b.getSchema();t=[];var C=0,O=0;for(C=0,O=g.startRows;C<O;C++)if(("object"===a.dataType||"function"===a.dataType)&&g.dataSchema)w=(0,l.I8)(S),t.push(w);else if("array"===a.dataType)w=(0,l.I8)(S[0]),t.push(w);else{w=[];for(var T=0,R=g.startCols;T<R;T++)w.push(null);t.push(w)}}else throw Error("".concat(c," only accepts array of objects or array of arrays (").concat(m(t)," given)"));Array.isArray(t[0])&&(a.dataType="array"),g.data=t,b.dataSource=t,u.data=t,u.dataType=a.dataType,u.colToProp=b.colToProp.bind(b),u.propToCol=b.propToCol.bind(b),u.countCachedColumns=b.countCachedColumns.bind(b),r(b),a.runHooks("after".concat(y),t,d,f),d||(a.runHooks("afterChange",null,c),a.render())}},4020:function(t,e,r){"use strict";r.d(e,{HJ:function(){return h},PP:function(){return d}}),r(6699),r(2023),r(6992),r(1539),r(8783),r(4129),r(3948),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165),r(7042),r(8309),r(1038),r(4916);var n=r(1975),o=r(8539),i=r(766),a=r(6187),l=r(6487),s=r(1799);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==u(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==u(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===u(e)?e:String(e)}(n.key),n)}}var h="editorManager.navigation",d="editorManager.handlingEditor",y=function(){var t,e;function r(t,e,n){var o=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.instance=t,this.tableMeta=e,this.selection=n,this.eventManager=new l.Z(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(t){return o.onAfterDocumentKeyDown(t)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(t){!o.destroyed&&o.instance.isListening()&&o.openEditor("",t)}),this.instance.view._wt.update("onCellDblClick",function(t,e,r){return o.onCellDblClick(t,e,r)})}return t=[{key:"registerShortcuts",value:function(){var t=this,e=this.instance.getShortcutManager(),r=e.getContext("grid"),n=e.getContext("editor"),i={group:d};n.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(r,n){t.closeEditorAndSaveChanges(e.isCtrlPressed()),t.moveSelectionAfterEnter(n.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){t.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),t.activeEditor.focus()}}],i),r.addShortcuts([{keys:[["F2"]],callback:function(e){t.openEditor(null,e,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){t.instance.emptySelectedCells(),t.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(e,r){t.instance.getSettings().enterBeginsEditing?t.cellProperties.readOnly?t.moveSelectionAfterEnter():t.openEditor(null,e,!0):t.moveSelectionAfterEnter(r.includes("shift")),(0,o.mM)(e)}}],i)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(t){this.lock||this.closeEditor(t)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var t=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(e){e&&t.prepareEditor()});return}var e=this.instance.getSelectedRangeLast().highlight,r=e.row,n=e.col,o=this.instance.runHooks("modifyGetCellCoords",r,n),l=r,s=n;if(Array.isArray(o)){var u=function(t){if(Array.isArray(t))return t}(o)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(o,2)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}}(o,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&(0,i.pV)(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var h=this.instance.getCell(r,n,!0);if(h){var d=this.instance.getCellEditor(this.cellProperties),y=this.instance.colToProp(s),p=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=(0,a.Jq)(d,this.instance),this.activeEditor.prepare(r,n,y,h,p,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),l=this.instance.columnIndexMapper.getRenderableFromVisualIndex(i);this.instance.view.scrollViewport(this.instance._createCellCoords(a,l)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}},{key:"closeEditor",value:function(t,e,r){this.activeEditor?this.activeEditor.finishEditing(t,e,r):r&&r(!1)}},{key:"closeEditorAndSaveChanges",value:function(t){this.closeEditor(!1,t)}},{key:"closeEditorAndRestoreOriginalValue",value:function(t){this.closeEditor(!0,t)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var t=this.instance.getCellEditor(this.cellProperties),e=this.instance.getSelectedRangeLast().highlight,r=e.row,n=e.col,o=this.instance,i=o.rowIndexMapper,a=o.columnIndexMapper,l=i.isHidden(this.instance.toPhysicalRow(r))||a.isHidden(this.instance.toPhysicalColumn(n));return!this.cellProperties.readOnly&&!!t&&!l}},{key:"moveSelectionAfterEnter",value:function(t){var e="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(t){var e=this;if(this.instance.isListening()){var r=t.keyCode;if(this.selection.isSelected()){var o=(t.ctrlKey||t.metaKey)&&!t.altKey;this.activeEditor&&(!this.activeEditor||this.activeEditor.isWaiting())||(0,n.DC)(r)||(0,n.T2)(r)||o||this.isEditorOpened()||(this.instance.getShortcutManager().getContext("editor").addShortcuts([{keys:[["ArrowUp"]],callback:function(){e.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){e.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){e.instance.selection.transformStart(0,-1*e.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){e.instance.selection.transformStart(0,e.instance.getDirectionFactor())}}],{runOnlyIf:function(){return(0,s.$K)(e.instance.getSelected())},group:h}),this.openEditor("",t))}}}},{key:"onCellDblClick",value:function(t,e,r){"TD"===r.nodeName&&this.openEditor(null,t,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}],f(r.prototype,t),e&&f(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}(),p=new WeakMap;y.getInstance=function(t,e,r){var n=p.get(t);return n||(n=new y(t,e,r),p.set(t,n)),n},e.ZP=y},7746:function(t,e,r){"use strict";r.d(e,{Hf:function(){return b},ed:function(){return m},PP:function(){return g}}),r(3371),r(4564),r(8309),r(6699),r(6649),r(6078),r(2526),r(1817),r(1539),r(9653),r(8304),r(489),r(2419),r(2165),r(6992),r(8783),r(3948),r(7042),r(1038),r(4916);var n=r(1799),o=r(7772),i=r(4020),a=r(613),l={_hooksStorage:Object.create(null),addHook:function(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey:function(t){var e=this;(0,a.Bk)(this._hooksStorage[t]||[],function(r){e.hot.removeHook(t,r)})},clearHooks:function(){var t=this;(0,o._l)(this._hooksStorage,function(e,r){return t.removeHooksByKey(r)}),this._hooksStorage={}}};(0,o.jW)(l,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var s=r(766);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==u(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==u(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===u(e)?e:String(e)}(n.key),n)}}function p(t,e,r){return e&&y(t.prototype,e),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var m=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),g="baseEditor",b=function(){function t(e){d(this,t),this.hot=e,this.instance=e,this.state=m.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return p(t,[{key:"_fireCallbacks",value:function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(t,e,r,n,o,i){this.TD=n,this.row=t,this.col=e,this.prop=r,this.originalValue=o,this.cellProperties=i,this.state=m.VIRGIN}},{key:"extend",value:function(){return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(n,t);var e,r=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=h(n);if(e){var o=h(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function n(){return d(this,n),r.apply(this,arguments)}return p(n)}(this.constructor)}},{key:"saveValue",value:function(t,e){var r,o,i,a,l=this;if(e){var s=this.hot.getSelectedLast();r=Math.max(Math.min(s[0],s[2]),0),o=Math.max(Math.min(s[1],s[3]),0),i=Math.max(s[0],s[2]),a=Math.max(s[1],s[3])}else{var u=[this.row,this.col,null,null];r=u[0],o=u[1],i=u[2],a=u[3]}var f=this.hot.runHooks("modifyGetCellCoords",r,o);if(Array.isArray(f)){var h=function(t){if(Array.isArray(t))return t}(f)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(f,2)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}}(f,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();r=h[0],o=h[1]}var d=this.hot.getShortcutManager().getContext("editor");this.isInFullEditMode()&&d.addShortcuts([{keys:[["ArrowUp"]],callback:function(){l.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){l.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){l.hot.selection.transformStart(0,-1*l.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){l.hot.selection.transformStart(0,l.hot.getDirectionFactor())}}],{runOnlyIf:function(){return(0,n.$K)(l.hot.getSelected())},group:g}),this.hot.populateFromArray(r,o,t,i,a,"edit")}},{key:"beginEditing",value:function(t,e){if(this.state===m.VIRGIN){var r=this.hot,o=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(o,i)),this.state=m.EDITING,this.isInFullEditMode()){var a="string"==typeof t?t:(0,n.Pz)(this.originalValue);this.setValue(a)}this.open(e),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(t,e,r){var n,o=this;if(r){var a=this._closeCallback;this._closeCallback=function(t){a&&a(t),r(t),o.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager().getContext("editor");if(l.removeShortcutsByGroup(g),l.removeShortcutsByGroup(i.HJ),this.state===m.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===m.EDITING){if(t){this.cancelChanges(),this.hot.view.render();return}var s=this.getValue();n=this.cellProperties.trimWhitespace?[["string"==typeof s?String.prototype.trim.call(s||""):s]]:[[s]],this.state=m.WAITING,this.saveValue(n,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(t){o.state=m.FINISHED,o.discardEditor(t)}):(this.state=m.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=m.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(t){this.state===m.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=m.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=m.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===m.WAITING}},{key:"getEditedCellRect",value:function(){var t,e=this.getEditedCell();if(e){var r=this.hot.view._wt,n=r.wtOverlays,o=r.wtViewport,i=this.hot.rootWindow,a=(0,s.cv)(e),l=(0,s.iO)(e),u=(0,s.cv)(this.hot.rootElement),c=(0,s.iO)(this.hot.rootElement),f=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=f!==i?f.scrollTop:0,y=h!==i?h.scrollLeft:0,p=i.innerWidth-u.left-c,m=(null!==(t=n.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt).wtTable,g=m.name,b=["master","inline_start"].includes(g)?d:0,w=["master","top","bottom"].includes(g)?y:0,S=a.top===u.top?0:1,C=a.top-u.top-S-b,O=0;O=this.hot.isRtl()?i.innerWidth-a.left-l-p-1+w:a.left-u.left-1-w,["top","top_inline_start_corner"].includes(g)&&(C+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(g)&&(O+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));var T=this.hot.hasColHeaders(),R=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),E=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),k=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(T&&R<=0||R===k)&&(C+=1),E<=0&&(O+=1);var P=o.rowsRenderCalculator.startPosition,j=o.columnsRenderCalculator.startPosition,x=Math.abs(n.inlineStartOverlay.getScrollPosition()),A=n.topOverlay.getScrollPosition(),H=(0,s.np)(this.hot.rootDocument),M=e.offsetTop+P-A,I=0;if(this.hot.isRtl()){var N=e.offsetLeft;I=N>=0?m.getWidth()-e.offsetLeft:Math.abs(N),I+=j-x-l}else I=e.offsetLeft+j-x;var _=(0,s.Dx)(this.TD,this.hot.rootWindow),D=parseInt(_[this.hot.isRtl()?"borderRightWidth":"borderLeftWidth"],10)>0?0:1,L=parseInt(_.borderTopWidth,10)>0?0:1,V=(0,s.iO)(e)+D,B=(0,s.Pb)(e)+L,W=(0,s.do)(f)?H:0,F=(0,s.vw)(h)?H:0,z=this.hot.view.maximumVisibleElementWidth(I)-W+D;return{top:C,start:O,height:B,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(M)-F+L,23),width:V,maxWidth:z}}}},{key:"getEditedCellsLayerClass",value:function(){var t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}],[{key:"EDITOR_TYPE",get:function(){return"base"}}]),t}();(0,o.jB)(b,l)},6187:function(t,e,r){"use strict";r.d(e,{Jq:function(){return f},Wu:function(){return u},qm:function(){return d},y$:function(){return h}}),r(6992),r(1539),r(8783),r(4129),r(3948);var n=r(3909),o=r(5872),i=new WeakMap,a=(0,o.Z)("editors"),l=a.register,s=a.getItem,u=a.hasItem;function c(t){var e={};this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new t(r)),e[r.guid]},n.Z.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function f(t,e){var r;if("function"==typeof t)i.get(t)||d(null,t),r=i.get(t);else if("string"==typeof t)r=s(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(t,'"'));return r.getInstance(e)}function h(t){if("function"==typeof t)return t;if(!u(t))throw Error('No registered editor found under "'.concat(t,'" name'));return s(t).getConstructor()}function d(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);var r=new c(e);"string"==typeof t&&l(t,r),i.set(e,r)}a.getNames,a.getValues},631:function(t,e,r){"use strict";r.d(e,{H:function(){return O}}),r(2772),r(8304),r(489),r(1539),r(2419),r(4819),r(5003),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165),r(6992),r(8783),r(3948),r(7042),r(8309),r(1038),r(4916);var n=r(7746),o=r(6487),i=r(9931),a=r(766),l=r(2226),s=r(1975);r(2564);var u=r(1799),c=r(4020);function f(t,e){for(var r=(0,a.qK)(e),n=e.value.split("\n"),o=r,i=0,l=0;l<n.length;l++){var s=n[l];0!==l&&(i+=n[l-1].length+1);var u=i+s.length;if("home"===t?o=i:"end"===t&&(o=u),r<=u)break}(0,a.Mq)(e,o)}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(t,e)}}(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==h(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==h(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===h(e)?e:String(e)}(n.key),n)}}function m(){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function g(t,e){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function b(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var S="ht_editor_hidden",C="textEditor",O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(T,t);var e,r,y,O=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=w(T);if(e){var n=w(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===h(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return b(t)}(this,t)});function T(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,T),(e=O.call(this,t)).eventManager=new o.Z(b(e)),e.autoResize=function(){var t,e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(t,e,r){t.addEventListener(e,r,!1)},a=function(t,e,r){t.removeEventListener(e,r,!1)},l=function(i){var a,l;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==n.textContent?n.textContent=t.value+i:n.data=t.value+i,o.style.position="absolute",o.style.fontSize=f(t).fontSize,o.style.fontFamily=f(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),a=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>a?t.style.width=e.minWidth+"px":a>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=a+"px",l=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>l?t.style.height=e.minHeight+"px":e.maxHeight<l?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=l+"px"},s=function(){window.setTimeout(l,0)},u=function(r){if(r&&r.minHeight){if("inherit"==r.minHeight)e.minHeight=t.clientHeight;else{var i=parseInt(r.minHeight);isNaN(i)||(e.minHeight=i)}}if(r&&r.maxHeight){if("inherit"==r.maxHeight)e.maxHeight=t.clientHeight;else{var a=parseInt(r.maxHeight);isNaN(a)||(e.maxHeight=a)}}if(r&&r.minWidth){if("inherit"==r.minWidth)e.minWidth=t.clientWidth;else{var l=parseInt(r.minWidth);isNaN(l)||(e.minWidth=l)}}if(r&&r.maxWidth){if("inherit"==r.maxWidth)e.maxWidth=t.clientWidth;else{var s=parseInt(r.maxWidth);isNaN(s)||(e.maxWidth=s)}}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},c=function(r,n,o){t=r,u(n),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),o&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function f(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}return{init:function(t,e,r){c(t,e,r)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}(),e.TEXTAREA=void 0,e.textareaStyle=void 0,e.TEXTAREA_PARENT=void 0,e.textareaParentStyle=void 0,e.layerClass=void 0,e.createElements(),e.bindEvents(),e.hot.addHookOnce("afterDestroy",function(){return e.destroy()}),e}return y=[{key:"EDITOR_TYPE",get:function(){return"text"}}],r=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(t){this.TEXTAREA.value=t}},{key:"open",value:function(){var t=this;this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(e){return t.onAfterDocumentKeyDown(e)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(t,e,r,o,a,l){var s=this.state;if(m(w(T.prototype),"prepare",this).call(this,t,e,r,o,a,l),!l.readOnly){this.refreshDimensions(!0);var u=l.allowInvalid,c=l.fragmentSelection;u&&(this.TEXTAREA.value=""),s!==n.ed.FINISHED&&this.hideEditableElement(),c||(0,i.K1)()||this.focus()}}},{key:"beginEditing",value:function(t,e){this.state===n.ed.VIRGIN&&(this.TEXTAREA.value="",m(w(T.prototype),"beginEditing",this).call(this,t,e))}},{key:"focus",value:function(){this.TEXTAREA.select(),(0,a.Mq)(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var t=this.hot.rootDocument;this.TEXTAREA=t.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,(0,a.cn)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),(0,a.cn)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,a.pv)(this.TEXTAREA_PARENT,this.layerClass)&&(0,a.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,a.cn)(this.TEXTAREA_PARENT,S),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){((0,i.w1)()||(0,i.un)())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,a.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,a.cn)(this.TEXTAREA_PARENT,S)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var t=this.TEXTAREA_PARENT.childNodes,e=!1;(0,l.q4)(t.length-1,function(r){var n=t[r];if((0,a.pv)(n,"handsontableEditor"))return e=!0,!1}),(0,a.pv)(this.TEXTAREA_PARENT,S)&&(0,a.IV)(this.TEXTAREA_PARENT,S),e?(this.layerClass="ht_editor_visible",(0,a.cn)(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),(0,a.cn)(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===n.ed.EDITING||t){if(this.TD=this.getEditedCell(),!this.TD){t||this.close();return}var e=this.getEditedCellRect(),r=e.top,o=e.start,i=e.width,l=e.maxWidth,s=e.height,u=e.maxHeight;this.textareaParentStyle.top="".concat(r,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(o,"px"),this.showEditableElement();var c=(0,a.Dx)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=c.fontSize,this.TEXTAREA.style.fontFamily=c.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var f=(0,a.Dx)(this.TEXTAREA),h=parseInt(f.paddingLeft,10)+parseInt(f.paddingRight,10),d=parseInt(f.paddingTop,10)+parseInt(f.paddingBottom,10),y=l-h,p=u-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i-h,y),minHeight:Math.min(s-d,p),maxWidth:y,maxHeight:p},!0)}}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(t){return t.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(t){return t.stopPropagation()}),(0,i.gn)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return t.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return t.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return t.refreshDimensions()}),this.addHook("afterColumnResize",function(){t.refreshDimensions(),t.focus()}),this.addHook("afterRowResize",function(){t.refreshDimensions(),t.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager().getContext("editor"),r=function(){t.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"]],callback:function(e){var r=t.hot.getSettings(),n="function"==typeof r.tabMoves?r.tabMoves(e):r.tabMoves;t.hot.selection.transformStart(n.row,n.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var r=t.hot.getSettings(),n="function"==typeof r.tabMoves?r.tabMoves(e):r.tabMoves;t.hot.selection.transformStart(-n.row,-n.col)}},{keys:[["Control","Enter"]],callback:function(){return r(),!1},runOnlyIf:function(e){return!t.hot.selection.isMultiple()&&!e.altKey},relativeToGroup:c.PP,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return r(),!1},runOnlyIf:function(){return!t.hot.selection.isMultiple()},relativeToGroup:c.PP,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return r(),!1},relativeToGroup:c.PP,position:"before"},{keys:[["PageUp"]],callback:function(){t.hot.selection.transformStart(-t.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){t.hot.selection.transformStart(t.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(e,r){f(d(r,1)[0],t.TEXTAREA)}},{keys:[["End"]],callback:function(e,r){f(d(r,1)[0],t.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){t.hot._registerTimeout(function(){t.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){t.hot._registerTimeout(function(){t.autoResize.resize()},10)}}],{runOnlyIf:function(){return(0,u.$K)(t.hot.getSelected())},group:C})}},{key:"unregisterShortcuts",value:function(){var t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(c.HJ),t.removeShortcutsByGroup(C),t.removeShortcutsByGroup(n.PP)}},{key:"onAfterDocumentKeyDown",value:function(t){-1===[s.nx.ARROW_UP,s.nx.ARROW_RIGHT,s.nx.ARROW_DOWN,s.nx.ARROW_LEFT].indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}],p(T.prototype,r),y&&p(T,y),Object.defineProperty(T,"prototype",{writable:!1}),T}(n.Hf)},6487:function(t,e,r){"use strict";r(561),r(6649),r(6078),r(2526),r(1817),r(1539),r(9653),r(2165),r(6992),r(8783),r(3948);var n=r(5965),o=r(8539);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==i(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}var l=0,s=function(){var t,e;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return t=[{key:"addEventListener",value:function(t,e,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function s(t){var e,n;r.call(this,(n=(e=t).stopImmediatePropagation,e.stopImmediatePropagation=function(){n.apply(this),(0,o.mM)(this)},e))}return"boolean"==typeof a||(0,n.by)()||(a=!1),this.context.eventListeners.push({element:t,event:e,callback:r,callbackProxy:s,options:a,eventManager:this}),t.addEventListener(e,s,a),l+=1,function(){i.removeEventListener(t,e,r)}}},{key:"removeEventListener",value:function(t,e,r){for(var n,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;i;)if(i-=1,(n=this.context.eventListeners[i]).event===e&&n.element===t){if(r&&r!==n.callback||o&&n.eventManager!==this)continue;this.context.eventListeners.splice(i,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),l-=1}}},{key:"clearEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var e=this.context.eventListeners.length;e;){e-=1;var r=this.context.eventListeners[e];t&&r.eventManager!==this||(this.context.eventListeners.splice(e,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),l-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(t,e){var r,n=t.document,o=t;n||(o=(n=t.ownerDocument?t.ownerDocument:t).defaultView);var i={bubbles:!0,cancelable:"mousemove"!==e,view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};n.createEvent?(r=n.createEvent("MouseEvents")).initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode):r=n.createEventObject(),t.dispatchEvent?t.dispatchEvent(r):t.fireEvent("on".concat(e),r)}}],a(r.prototype,t),e&&a(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();e.Z=s},9931:function(t,e,r){"use strict";r.d(e,{D8:function(){return y},E6:function(){return s},G6:function(){return f},K1:function(){return p},L:function(){return g},eE:function(){return w},gn:function(){return m},i7:function(){return l},iF:function(){return c},uM:function(){return b},un:function(){return h},vU:function(){return u},w1:function(){return d}}),r(4916);var n=r(7772),o=function(t){var e={value:!1};return e.test=function(r,n){e.value=t(r,n)},e},i={chrome:o(function(t,e){return/Chrome/.test(t)&&/Google/.test(e)}),chromeWebKit:o(function(t){return/CriOS/.test(t)}),edge:o(function(t){return/Edge/.test(t)}),edgeWebKit:o(function(t){return/EdgiOS/.test(t)}),firefox:o(function(t){return/Firefox/.test(t)}),firefoxWebKit:o(function(t){return/FxiOS/.test(t)}),ie:o(function(t){return/Trident/.test(t)}),ie9:o(function(){return!!document.documentMode}),mobile:o(function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}),safari:o(function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)})},a={mac:o(function(t){return/^Mac/.test(t)}),win:o(function(t){return/^Win/.test(t)}),linux:o(function(t){return/^Linux/.test(t)}),ios:o(function(t){return/iPhone|iPad|iPod/i.test(t)})};function l(){return i.chrome.value}function s(){return i.chromeWebKit.value}function u(){return i.firefox.value}function c(){return i.firefoxWebKit.value}function f(){return i.safari.value}function h(){return i.edge.value}function d(){return i.ie.value}function y(){return i.ie9.value}function p(){return i.mobile.value}function m(){return a.ios.value}function g(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t.maxTouchPoints>2&&a.mac.value}function b(){return a.win.value}function w(){return a.mac.value}!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.userAgent,r=void 0===e?navigator.userAgent:e,o=t.vendor,a=void 0===o?navigator.vendor:o;(0,n._l)(i,function(t){(0,t.test)(r,a)})}(),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.platform,r=void 0===e?navigator.platform:e;(0,n._l)(a,function(t){(0,t.test)(r)})}()},3817:function(t,e,r){"use strict";r.d(e,{Eb:function(){return l},Jr:function(){return s},Pj:function(){return u},Yl:function(){return i},ec:function(){return a}}),r(1539),r(4747),r(7941),r(2526),r(1817),r(2165),r(6992),r(8783),r(3948);var n=r(7772);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){for(var e,r=t+1,n="";r>0;)n=String.fromCharCode(65+(e=(r-1)%26))+n,r=parseInt((r-e)/26,10);return n}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=t,n=[];return Array.isArray(t)&&Array.isArray(t[0])||(r=[t]),r.forEach(function(t,r){Array.isArray(t)?t.forEach(function(t,o){n.push([r+e,o,t])}):Object.keys(t).forEach(function(o){n.push([r+e,o,t[o]])})}),n}function l(t){var e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&(0,n.Kn)(t[0])&&(e=(0,n.Q8)(t[0]))),e}function s(t){return!!(Array.isArray(t)&&t.length&&t.every(function(t){return Array.isArray(t)}))}function u(t){return!!(Array.isArray(t)&&t.length&&t.every(function(t){return"object"===o(t)&&!Array.isArray(t)&&null!==t}))}},766:function(t,e,r){"use strict";r.d(e,{$g:function(){return _},AQ:function(){return A},C2:function(){return D},DZ:function(){return H},Dx:function(){return L},G_:function(){return h},I2:function(){return Z},IV:function(){return R},Kz:function(){return g},MO:function(){return m},Mq:function(){return q},Pb:function(){return B},TT:function(){return tn},W6:function(){return p},WH:function(){return J},WS:function(){return W},Wu:function(){return function t(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var r=e.childNodes,n=r.length-1;n>=0;n--)t(r[n])}},a7:function(){return K},cS:function(){return E},cn:function(){return T},cv:function(){return x},cx:function(){return M},dD:function(){return N},do:function(){return $},f5:function(){return d},hd:function(){return te},iO:function(){return V},kg:function(){return U},mK:function(){return b},mR:function(){return G},np:function(){return X},oq:function(){return y},pV:function(){return tt},pn:function(){return function t(e){for(var r=e.ownerDocument.documentElement,n=e;n!==r;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(!n.host)return!1;if(n.host.impl)return t(n.host.impl);if(n.host)return t(n.host);throw Error("Lost in Web Components world")}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}},pv:function(){return O},qK:function(){return z},tT:function(){return j},u7:function(){return Q},uS:function(){return P},vj:function(){return I},vw:function(){return Y},x9:function(){return F},z4:function(){return tr}}),r(489),r(6699),r(2023),r(7042),r(2772),r(7327),r(1539),r(4603),r(4916),r(9714),r(9600),r(4564),r(5306),r(2222),r(4747),r(2526),r(1817),r(2165),r(6992),r(8783),r(3948),r(1038),r(8309);var n,o,i,a,l=r(5965),s=r(9931),u=r(9272);function c(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function h(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=-1,n=null,o=t;null!==o;){if(r===e){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function d(t){return Object.getPrototypeOf(t.parent)&&t.frameElement&&t.parent}function y(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=t;null!=a&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(e.includes(u)||e.includes(a)))return a;var c=a.host;a=c&&s===i?c:a.parentNode}return null}function p(t,e,r){for(var n=[],o=t;o&&(o=y(o,e,r))&&(!r||r.contains(o));)n.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode;var i=n.length;return i?n[i-1]:null}function m(t,e){var r=t.parentNode,n=[];for("string"==typeof e?n=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);null!==r;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function g(t){var e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function b(t,e,r){var n=r.parentElement.querySelector(".ht_clone_".concat(t));return n?n.contains(e):null}function w(t){return t&&t.length?t.filter(function(t){return!!t}):[]}if((0,l.mp)()){var S=function(t){var e=t.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")};n=function(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)},o=function(t,e){var r,n=t.ownerDocument,o=e;if("string"==typeof o&&(o=o.split(" ")),(o=w(o)).length>0){if(S(n))(r=t.classList).add.apply(r,c(o));else for(var i=0;o[i];)t.classList.add(o[i]),i+=1}},i=function(t,e){var r,n=t.ownerDocument,o=e;if("string"==typeof o&&(o=o.split(" ")),(o=w(o)).length>0){if(S(n))(r=t.classList).remove.apply(r,c(o));else for(var i=0;o[i];)t.classList.remove(o[i]),i+=1}}}else{var C=function(t){return RegExp("(\\s|^)".concat(t,"(\\s|$)"))};n=function(t,e){return void 0!==t.className&&C(e).test(t.className)},o=function(t,e){var r=t.className,n=e;if("string"==typeof n&&(n=n.split(" ")),n=w(n),""===r)r=n.join(" ");else for(var o=0;o<n.length;o++)n[o]&&!C(n[o]).test(r)&&(r+=" ".concat(n[o]));t.className=r},i=function(t,e){var r=0,n=t.className,o=e;for("string"==typeof o&&(o=o.split(" ")),o=w(o);o[r];)n=n.replace(C(o[r])," ").trim(),r+=1;t.className!==n&&(t.className=n)}}function O(t,e){return n(t,e)}function T(t,e){o(t,e)}function R(t,e){i(t,e)}function E(t){for(var e;e=t.lastChild;)t.removeChild(e)}var k=/(<(.*)>|&(.*);)/;function P(t,e){var r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];k.test(e)?t.innerHTML=r?(0,u.Nw)(e):e:j(t,e)}function j(t,e){var r=t.firstChild;r&&3===r.nodeType&&null===r.nextSibling?l.tt?r.textContent=e:r.data=e:(E(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function x(t){var e,r,n,o,i=t.ownerDocument,a=i.defaultView,s=i.documentElement,u=t;if((0,l.ZF)()&&u.firstChild&&"CAPTION"===u.firstChild.nodeName)return{top:(o=u.getBoundingClientRect()).top+(a.pageYOffset||s.scrollTop)-(s.clientTop||0),left:o.left+(a.pageXOffset||s.scrollLeft)-(s.clientLeft||0)};for(e=u.offsetLeft,r=u.offsetTop,n=u;(u=u.offsetParent)&&u!==i.body;)e+=u.offsetLeft,r+=u.offsetTop,n=u;return n&&"fixed"===n.style.position&&(e+=a.pageXOffset||s.scrollLeft,r+=a.pageYOffset||s.scrollTop),{left:e,top:r}}function A(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollY;return void 0===e&&(e=t.document.documentElement.scrollTop),e}function H(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollX;return void 0===e&&(e=t.document.documentElement.scrollLeft),e}function M(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?A(e):t.scrollTop}function I(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?H(e):t.scrollLeft}function N(t){var e=t.ownerDocument,r=e?e.defaultView:void 0;e||(r=(e=t.document?t.document:t).defaultView);for(var n=["auto","scroll"],o=(0,l.mI)(),i=t.parentNode;i&&i.style&&e.body!==i;){var a=i.style,s=a.overflow,u=a.overflowX,c=a.overflowY;if([s,u,c].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(s=f.overflow,u=f.overflowX,c=f.overflowY,n.includes(s)||n.includes(u)||n.includes(c))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(c)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(u)||n.includes(s)))return i;i=i.parentNode}return r}function _(t){for(var e=t.ownerDocument,r=e.defaultView,n=t.parentNode;n&&n.style&&e.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;var o=L(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function D(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(t){if(t===r)return"width"===e?"".concat(r.innerWidth,"px"):"height"===e?"".concat(r.innerHeight,"px"):void 0;var n=t.style[e];if(""!==n&&void 0!==n)return n;var o=L(t,r);if(""!==o[e]&&void 0!==o[e])return o[e]}}function L(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function V(t){return t.offsetWidth}function B(t){return(0,l.ZF)()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function W(t){return t.clientHeight||t.innerHeight}function F(t){return t.clientWidth||t.innerWidth}function z(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var r=e.selection.createRange();if(null===r)return 0;var n=t.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function U(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var r=e.selection.createRange();return null===r?0:t.createTextRange().text.indexOf(r.text)+r.text.length}return 0}function G(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document,r="";return t.getSelection?r=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(r=e.selection.createRange().text),r}function K(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function q(t,e,r){if(void 0===r&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch(i){var n=t.parentNode,o=n.style.display;n.style.display="block",t.setSelectionRange(e,r),n.style.display=o}}}function X(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===a&&(a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);var n=e.offsetWidth;r.style.overflow="scroll";var o=e.offsetWidth;return n===o&&(o=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-o}(t)),a}function $(t){return t.offsetWidth!==t.clientWidth}function Y(t){return t.offsetHeight!==t.clientHeight}function Z(t,e,r){(0,s.D8)()?(t.style.top=r,t.style.left=e):(0,s.G6)()?t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(r,",0)"):t.style.transform="translate3d(".concat(e,",").concat(r,",0)")}function J(t){t.style.transform&&""!==t.style.transform?t.style.transform="":t.style["-webkit-transform"]&&""!==t.style["-webkit-transform"]&&(t.style["-webkit-transform"]="")}function Q(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function tt(t){return Q(t)&&!1===t.hasAttribute("data-hot-input")}function te(t){tt(t.ownerDocument.activeElement)||t.select()}function tr(t){return!t.parentNode}function tn(t,e){new IntersectionObserver(function(r,n){r.forEach(function(r){r.isIntersecting&&null!==t.offsetParent&&(e(),n.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}},8539:function(t,e,r){"use strict";function n(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function o(t){return!1===t.isImmediatePropagationEnabled}function i(t){return 2===t.button}function a(t){return 0===t.button}r.d(e,{Ty:function(){return o},dO:function(){return i},mM:function(){return n},pW:function(){return a}})},5965:function(t,e,r){"use strict";var n,o,i;function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return window.requestAnimationFrame(t)}function s(){return!!document.documentElement.classList}function u(){return!!document.createTextNode("test").textContent}function c(){return!!window.getComputedStyle}function f(t){window.cancelAnimationFrame(t)}function h(){return"ontouchstart"in window}function d(){if(void 0===n){var t,e,r;(t=document.createElement("TABLE")).style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0",e=document.createElement("TBODY"),t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>",(r=document.createElement("CAPTION")).innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",t.insertBefore(r,e),document.body.appendChild(t),n=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}return n}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o||(o=("undefined"==typeof Intl?"undefined":a(Intl))==="object"?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?function(t,e){return"".concat(t).localeCompare(e)}:function(t,e){return t===e?0:t>e?-1:1})}function p(){if(void 0!==i)return i;try{var t={get passive(){i=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(e){i=!1}return i}r.d(e,{JS:function(){return h},U7:function(){return l},Wx:function(){return f},ZF:function(){return d},by:function(){return p},mI:function(){return c},mp:function(){return s},sx:function(){return y},tt:function(){return u}}),r(2526),r(1817),r(1539),r(2165),r(6992),r(8783),r(3948)},7161:function(t,e,r){"use strict";r.d(e,{$Z:function(){return s},Ds:function(){return i},WA:function(){return l},mf:function(){return o},r$:function(){return a}}),r(2564),r(7042),r(2222),r(5069);var n=r(1799);function o(t){return"function"==typeof t}function i(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=null;return function(){for(var o=this,i=arguments.length,a=Array(i),l=0;l<i;l++)a[l]=arguments[l];return n&&clearTimeout(n),n=setTimeout(function(){e=t.apply(o,a)},r),e}}function a(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.apply(this,r.concat(n))}}function l(t){var e=t.length;return function r(n){return function(){for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=n.concat(i);return l.length>=e?t.apply(this,l):r(l)}}([])}function s(t,e,r,o,i,a,l,s){return(0,n.$K)(s)?t.call(e,r,o,i,a,l,s):(0,n.$K)(l)?t.call(e,r,o,i,a,l):(0,n.$K)(a)?t.call(e,r,o,i,a):(0,n.$K)(i)?t.call(e,r,o,i):(0,n.$K)(o)?t.call(e,r,o):(0,n.$K)(r)?t.call(e,r):t.call(e)}},2226:function(t,e,r){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=o(t);if("number"===r)return!isNaN(t)&&isFinite(t);if("string"===r){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);var i=Array.from(new Set(["."].concat(function(t){if(Array.isArray(t))return n(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))).map(function(t){return"\\".concat(t)}).join("|");return RegExp("^[+-]?\\s*(((".concat(i,")?\\d+((").concat(i,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(t.trim())}return"object"===r&&!!t&&"number"==typeof t.valueOf()&&!(t instanceof Date)}function a(t){return i(t,[","])}function l(t,e,r){var n=-1;for("function"==typeof e?(r=e,e=t):n=t-1;++n<=e&&!1!==r(n););}function s(t,e,r){var n=t+1;for("function"==typeof e&&(r=e,e=0);--n>=e&&!1!==r(n););}function u(t,e){return e=isNaN(e=parseInt(e.toString().replace("%",""),10))?0:e,parseInt(t*e/100,10)}r.d(e,{N1:function(){return u},TR:function(){return a},kE:function(){return i},q4:function(){return l},yh:function(){return s}}),r(4916),r(9600),r(1249),r(1038),r(8783),r(6992),r(1539),r(189),r(3948),r(2222),r(4603),r(9714),r(4564),r(5306),r(2526),r(1817),r(2165),r(7042),r(8309)},9272:function(t,e,r){"use strict";r.d(e,{Nw:function(){return u},O1:function(){return i},ct:function(){return o},ng:function(){return l},oN:function(){return s},wK:function(){return a}}),r(2772),r(1539),r(9714),r(4916),r(5306);var n=r(7856);function o(t){return t[0].toUpperCase()+t.substr(1)}function i(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function a(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(t).replace(/(?:\\)?\[([^[\]]+)]/g,function(t,r){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[r]?"":e[r]})}function s(t){return u("".concat(t),{ALLOWED_TAGS:[]})}function u(t,e){return n.sanitize(t,e)}},1975:function(t,e,r){"use strict";r.d(e,{DC:function(){return s},EA:function(){return l},T2:function(){return u},nx:function(){return i},ot:function(){return c}}),r(6699),r(2023);var n=r(613),o=r(9931),i={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,o.vU)()?182:174,AUDIO_MUTE:(0,o.vU)()?181:173,AUDIO_UP:(0,o.vU)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},a=[i.ALT,i.ARROW_DOWN,i.ARROW_LEFT,i.ARROW_RIGHT,i.ARROW_UP,i.AUDIO_DOWN,i.AUDIO_MUTE,i.AUDIO_UP,i.BACKSPACE,i.CAPS_LOCK,i.DELETE,i.END,i.ENTER,i.ESCAPE,i.F1,i.F2,i.F3,i.F4,i.F5,i.F6,i.F7,i.F8,i.F9,i.F10,i.F11,i.F12,i.F13,i.F14,i.F15,i.F16,i.F17,i.F18,i.F19,i.HOME,i.INSERT,i.MEDIA_NEXT,i.MEDIA_PLAY_PAUSE,i.MEDIA_PREV,i.MEDIA_STOP,i.NULL,i.NUM_LOCK,i.PAGE_DOWN,i.PAGE_UP,i.PAUSE,i.SCROLL_LOCK,i.SHIFT,i.TAB];function l(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function s(t){return a.includes(t)}function u(t){return[i.CONTROL,i.COMMAND_LEFT,i.COMMAND_RIGHT,i.COMMAND_FIREFOX].includes(t)}function c(t,e){var r=e.split("|"),o=!1;return(0,n.Bk)(r,function(e){if(t===i[e])return o=!0,!1}),o}},5981:function(t,e,r){"use strict";var n=r(7772),o=r(7161),i={_localHooks:Object.create(null),addLocalHook:function(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks:function(t,e,r,n,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)(0,o.$Z)(this._localHooks[t][u],this,e,r,n,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};(0,n.jW)(i,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.Z=i},3909:function(t,e,r){"use strict";r(7042),r(3371),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165),r(6992),r(1532),r(1539),r(8783),r(3948),r(2772),r(561);var n,o=r(613),i=r(7772),a=r(9272),l=r(3895),s=r(8336),u=r(7161);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==c(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==c(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===c(e)?e:String(e)}(n.key),n)}}var h=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],d=(0,s.e)(n||(n=Object.freeze(Object.defineProperties(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],{raw:{value:Object.freeze(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.'])}})))),y=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),p=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),m=function(){var t,e;function r(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.globalBucket=this.createEmptyBucket()}return t=[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return(0,o.Bk)(h,function(e){return t[e]=[]}),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))(0,o.Bk)(e,function(e){return r.add(t,e,n)});else{y.has(t)&&(0,l.ZK)((0,a.ng)(d,{hookName:t,removedInVersion:y.get(t)})),p.has(t)&&(0,l.ZK)(p.get(t));var i=this.getBucket(n);if(void 0===i[t]&&(this.register(t),i[t]=[]),e.skip=!1,-1===i[t].indexOf(e)){var s=!1;e.initialHook&&(0,o.Bk)(i[t],function(r,n){if(r.initialHook)return i[t][n]=e,s=!0,!1}),s||i[t].push(e)}}return this}},{key:"once",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?(0,o.Bk)(e,function(e){return r.once(t,e,n)}):(e.runOnce=!0,this.add(t,e,n))}},{key:"remove",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.getBucket(r);return!!(void 0!==n[t]&&n[t].indexOf(e)>=0)&&(e.skip=!0,!0)}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getBucket(e);return!!(void 0!==r[t]&&r[t].length)}},{key:"run",value:function(t,e,r,n,o,i,a,l){var s=this.globalBucket[e],c=s?s.length:0,f=0;if(c)for(;f<c;){if(!s[f]||s[f].skip){f+=1;continue}var h=(0,u.$Z)(s[f],t,r,n,o,i,a,l);void 0!==h&&(r=h),s[f]&&s[f].runOnce&&this.remove(e,s[f]),f+=1}var d=this.getBucket(t)[e],y=d?d.length:0,p=0;if(y)for(;p<y;){if(!d[p]||d[p].skip){p+=1;continue}var m=(0,u.$Z)(d[p],t,r,n,o,i,a,l);void 0!==m&&(r=m),d[p]&&d[p].runOnce&&this.remove(e,d[p],t),p+=1}return r}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,i._l)(this.getBucket(t),function(t,e,r){return r[e].length=0})}},{key:"register",value:function(t){this.isRegistered(t)||h.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&h.splice(h.indexOf(t),1)}},{key:"isDeprecated",value:function(t){return p.has(t)||y.has(t)}},{key:"isRegistered",value:function(t){return h.indexOf(t)>=0}},{key:"getRegistered",value:function(){return h}}],e=[{key:"getSingleton",value:function(){return g}}],t&&f(r.prototype,t),e&&f(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}(),g=new m;e.Z=m},8298:function(t,e,r){"use strict";r.d(e,{s3:function(){return O},a9:function(){return C},_j:function(){return T},fo:function(){return R}}),r(2222),r(2526),r(1817),r(1539),r(2165),r(6992),r(8783),r(3948),r(1038),r(7042),r(8309),r(4916);var n=r(9272);r(1532),r(1249),r(2707);var o=r(2226),i=r(7161);function a(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(t,e)}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var s=new Map([["asc",[-1,1]],["desc",[1,-1]]]),u=function(t){return"The priority '".concat(t,"' is already declared in a map.")},c=function(t){return"The priority '".concat(t,"' is not a number.")},f=r(8722);function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}r(189);var d=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||p(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){if(t){if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(t,e)}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var g=function(t){return'There is already registered "'.concat(t,'" plugin.')},b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorPriorityExists,r=t.errorPriorityNaN,n=new Map;return e=(0,i.mf)(e)?e:u,r=(0,i.mf)(r)?r:c,{addItem:function(t,i){if(!(0,o.kE)(t))throw Error(r(t));if(n.has(t))throw Error(e(t));n.set(t,i)},getItems:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",r=function(t){if(Array.isArray(t))return t}(t=s.get(e)||s.get("asc"))||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,2)||a(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=r[0],i=r[1];return((function(t){if(Array.isArray(t))return l(t)})(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||a(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(t,e){return t[0]<e[0]?o:i}).map(function(t){return t[1]})}}}({errorPriorityExists:function(t){return'There is already registered plugin on priority "'.concat(t,'".')},errorPriorityNaN:function(t){return'The priority "'.concat(t,'" is not a number.')}}),w=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorItemExists,r=new Set;return e=(0,i.mf)(e)?e:d,{addItem:function(t){if(r.has(t))throw Error(e(t));r.add(t)},clear:function(){r.clear()},getItems:function(){return function(t){if(Array.isArray(t))return h(t)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(t,e)}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}({errorItemExists:g}),S=(0,f.I)({errorIdExists:g});function C(){return[].concat(y(b.getItems()),y(w.getItems()))}function O(t){var e=(0,n.ct)(t);return S.getItem(e)}function T(t){return!!O(t)}function R(t,e,r){var o,i,a,l,s=function(t){if(Array.isArray(t))return t}((o=t,i=e,a=r,"function"==typeof o&&(o=(i=o).PLUGIN_KEY,a=i.PLUGIN_PRIORITY),l=[o,i,a]))||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(l,3)||p(l,3)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();t=s[0],e=s[1],r=s[2],void 0===O(t)&&function(t,e,r){var o=(0,n.ct)(t);if(S.hasItem(o))throw Error(g(o));void 0===r?w.addItem(o):b.addItem(r,o),S.addItem(o,e)}(t,e,r)}},6285:function(t,e,r){"use strict";r.d(e,{Z:function(){return o}});var n=r(766);function o(t,e,r,o,i,a,l){var s=[],u=[];l.className&&(0,n.cn)(e,l.className),l.readOnly&&s.push(l.readOnlyCellClassName),!1===l.valid&&l.invalidCellClassName?s.push(l.invalidCellClassName):u.push(l.invalidCellClassName),!1===l.wordWrap&&l.noWordWrapClassName&&s.push(l.noWordWrapClassName),!a&&l.placeholder&&s.push(l.placeholderCellClassName),(0,n.IV)(e,u),(0,n.cn)(e,s)}o.RENDERER_TYPE="base"},9847:function(t,e,r){"use strict";r.d(e,{Bp:function(){return l},Y3:function(){return a},zn:function(){return s}});var n=(0,r(5872).Z)("renderers"),o=n.register,i=n.getItem,a=n.hasItem;function l(t){if("function"==typeof t)return t;if(!a(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return i(t)}function s(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),o(t,e)}n.getNames,n.getValues},337:function(t,e,r){"use strict";r.d(e,{V:function(){return a}}),r(4564);var n=r(6285),o=r(766),i=r(1799);function a(t,e,r,a,l,s,u){n.Z.apply(this,[t,e,r,a,l,s,u]);var c=s;if(!c&&u.placeholder&&(c=u.placeholder),c=(0,i.Pz)(c),u.trimWhitespace&&(c=c.trim()),u.rendererTemplate){(0,o.cS)(e);var f=t.rootDocument.createElement("TEMPLATE");f.setAttribute("bind","{{}}"),f.innerHTML=u.rendererTemplate,HTMLTemplateElement.decorate(f),f.model=t.getSourceDataAtRow(r),e.appendChild(f)}else(0,o.tT)(e,c)}a.RENDERER_TYPE="text"},2600:function(t,e,r){"use strict";r.d(e,{$7:function(){return s},AI:function(){return o},CD:function(){return n},Nc:function(){return l},P$:function(){return a},d7:function(){return i}});var n="active-header",o="area",i="cell",a="fill",l="header",s="custom-selection"},3431:function(t,e,r){"use strict";r.d(e,{Z:function(){return tH}}),r(6992),r(1539),r(189),r(8783),r(3948),r(2222),r(1038),r(6699),r(2023),r(3161),r(9653),r(4747),r(6649),r(6078),r(2526),r(1817),r(7042),r(3371),r(2165),r(8309),r(4916),r(3290),r(1532),r(7941),r(7327),r(5003),r(9337);var n,o=r(5872),i=r(2600);r(2772),r(8304),r(489),r(2419),r(4819),r(2479);var a=r(766);r(9600);var l=r(8539),s=r(7772),u=r(9931);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(t,e)}}(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==c(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==c(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===c(e)?e:String(e)}(n.key),n)}}var y=function(){var t,e;function r(t,e){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),e&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}return t=[{key:"registerListeners",value:function(){var t=this,e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",function(){return t.onMouseDown()}),this.eventManager.addEventListener(e,"mouseup",function(){return t.onMouseUp()});for(var r=function(e,r){var n=t.main.childNodes[e];t.eventManager.addEventListener(n,"mouseenter",function(r){return t.onMouseEnter(r,t.main.childNodes[e])})},n=0,o=this.main.childNodes.length;n<o;n++)r(n,o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,e){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),(0,l.mM)(t);var r=this,n=this.wot.rootDocument.body,o=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(n,"mousemove",function t(i){(function(t){if(t.clientY<Math.floor(o.top)||t.clientY>Math.ceil(o.top+o.height)||t.clientX<Math.floor(o.left)||t.clientX>Math.ceil(o.left+o.width))return!0})(i)&&(r.eventManager.removeEventListener(n,"mousemove",t),e.style.display="block")})}}},{key:"createBorders",value:function(t){var e=this.wot.rootDocument;this.main=e.createElement("div");var r=["top","start","bottom","end","corner"],n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(var o=0;o<5;o++){var i=r[o],a=e.createElement("div");a.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(a.className+=" hidden"),(n=a.style).backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,n.height=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(t.border.width,"px"),n.width=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(t.border.width,"px"),this.main.appendChild(a)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,u.K1)()&&this.createMultipleSelectorHandles(),this.disappear();var l=this.wot.wtTable,s=l.bordersHolder;s||((s=e.createElement("div")).className="htBorders",l.bordersHolder=s,l.spreader.appendChild(s)),s.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var t=this,e=this.wot.rootDocument;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var r={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};(0,s._l)(r,function(e,r){t.selectionHandles.styles.bottomHitArea[r]=e,t.selectionHandles.styles.topHitArea[r]=e});var n={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};(0,s._l)(n,function(e,r){t.selectionHandles.styles.bottom[r]=e,t.selectionHandles.styles.top[r]=e}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(t,e){var r=this.wot.selections.createOrGetArea();return!!r.cellRange&&(t!==r.cellRange.to.row||e!==r.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,e,r,n,o,i){var a=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",l=this.selectionHandles.styles,s=l.top,u=l.topHitArea,c=l.bottom,f=l.bottomHitArea,h=parseInt(s.borderWidth,10),d=parseInt(s.width,10),y=parseInt(u.width,10),p=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();s.top="".concat(parseInt(r-d-1,10),"px"),s[a]="".concat(parseInt(n-d-1,10),"px"),u.top="".concat(parseInt(r-y/4*3,10),"px"),u[a]="".concat(parseInt(n-y/4*3,10),"px");var g=Math.min(parseInt(n+o,10),p-d-2*h),b=Math.min(parseInt(n+o-y/4,10),p-y-2*h);c[a]="".concat(g,"px"),f[a]="".concat(b,"px");var w=Math.min(parseInt(r+i,10),m-d-2*h),S=Math.min(parseInt(r+i-y/4,10),m-y-2*h);c.top="".concat(w,"px"),f.top="".concat(S,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(s.display="block",u.display="block",this.isPartRange(t,e)?(c.display="none",f.display="none"):(c.display="block",f.display="block")):(s.display="none",c.display="none",u.display="none",f.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(s.zIndex="9999",u.zIndex="9999"):(s.zIndex="",u.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var e,r,n,o,i,l,s=this.wot,c=s.wtTable,h=s.rootDocument,d=s.rootWindow,y=c.getRenderedRowsCount(),p=0;p<y;p+=1){var m=c.rowFilter.renderedToSource(p);if(m>=t[0]&&m<=t[2]){e=m,i=t[0];break}}for(var g=y-1;g>=0;g-=1){var b=c.rowFilter.renderedToSource(g);if(b>=t[0]&&b<=t[2]){r=b;break}}for(var w=c.getRenderedColumnsCount(),S=0;S<w;S+=1){var C=c.columnFilter.renderedToSource(S);if(C>=t[1]&&C<=t[3]){n=C,l=t[1];break}}for(var O=w-1;O>=0;O-=1){var T=c.columnFilter.renderedToSource(O);if(T>=t[1]&&T<=t[3]){o=T;break}}if(void 0===e||void 0===n){this.disappear();return}var R=c.getCell(this.wot.createCellCoords(e,n)),E=e!==r||n!==o,k=E?c.getCell(this.wot.createCellCoords(r,o)):R,P=(0,a.cv)(R),j=E?(0,a.cv)(k):P,x=(0,a.cv)(c.TABLE),A=(0,a.iO)(c.TABLE),H=P.top,M=P.left,I=this.wot.wtSettings.getSetting("rtlMode"),N=0,_=0;if(I){var D=(0,a.iO)(R),L=d.innerWidth-x.left-A;_=M+D-j.left,N=d.innerWidth-M-D-L-1}else _=j.left+(0,a.iO)(k)-M,N=M-x.left-1;if(this.isEntireColumnSelected(e,r)){var V=this.getDimensionsFromHeader("columns",n,o,i,x),B=null;if(V){var W=f(V,3);B=W[0],N=W[1],_=W[2]}B&&(R=B)}var F=H-x.top-1,z=j.top+(0,a.Pb)(k)-H;if(this.isEntireRowSelected(n,o)){var U=this.getDimensionsFromHeader("rows",e,r,l,x),G=null;if(U){var K=f(U,3);G=K[0],F=K[1],z=K[2]}G&&(R=G)}var q=(0,a.Dx)(R,d);parseInt(q.borderTopWidth,10)>0&&(F+=1,z=z>0?z-1:0),parseInt(q[I?"borderRightWidth":"borderLeftWidth"],10)>0&&(N+=1,_=_>0?_-1:0);var X=I?"right":"left";this.topStyle.top="".concat(F,"px"),this.topStyle[X]="".concat(N,"px"),this.topStyle.width="".concat(_,"px"),this.topStyle.display="block",this.startStyle.top="".concat(F,"px"),this.startStyle[X]="".concat(N,"px"),this.startStyle.height="".concat(z,"px"),this.startStyle.display="block";var $=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(F+z-$,"px"),this.bottomStyle[X]="".concat(N,"px"),this.bottomStyle.width="".concat(_,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(F,"px"),this.endStyle[X]="".concat(N+_-$,"px"),this.endStyle.height="".concat(z+1,"px"),this.endStyle.display="block";var Y=this.settings.border.cornerVisible;Y="function"==typeof Y?Y(this.settings.layerLevel):Y;var Z=this.wot.getSetting("onModifyGetCellCoords",r,o),J=r,Q=o;if(Z&&Array.isArray(Z)){var tt=f(Z,4);J=tt[2],Q=tt[3]}if((0,u.K1)()||!Y||this.isPartRange(J,Q))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(F+z+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[X]="".concat(N+_+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var te=(0,a.$g)(c.TABLE),tr=te===d;tr&&(te=h.documentElement);var tn=parseInt(this.cornerDefaultStyle.width,10)/2,to=parseInt(this.cornerDefaultStyle.height,10)/2;if(o===this.wot.getSetting("totalColumns")-1){var ti=tr?k.getBoundingClientRect().left:k.offsetLeft;(I?ti-parseInt(this.cornerDefaultStyle.width,10)/2<0:ti+(0,a.iO)(k)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,a.x9)(te))&&(this.cornerStyle[X]="".concat(Math.floor(N+_+this.cornerCenterPointOffset-tn),"px"),this.cornerStyle[I?"borderLeftWidth":"borderRightWidth"]=0)}r===this.wot.getSetting("totalRows")-1&&(tr?k.getBoundingClientRect().top:k.offsetTop)+(0,a.Pb)(k)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,a.WS)(te)&&(this.cornerStyle.top="".concat(Math.floor(F+z+this.cornerCenterPointOffset-to),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}(0,u.K1)()&&this.updateMultipleSelectionHandlesPosition(r,o,F,N,_,z)}}},{key:"isEntireColumnSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,e,r,n,o){var i=this.wot.wtTable,l=i.wtRootElement.parentNode,s=null,u=null,c=null,f=null,h=null,d=null,y=null,p=null;switch(t){case"rows":s=function(){return i.getRowHeader.apply(i,arguments)},u=function(){return a.Pb.apply(void 0,arguments)},c="ht__selection--rows",d="top";break;case"columns":s=function(){return i.getColumnHeader.apply(i,arguments)},u=function(){return a.iO.apply(void 0,arguments)},c="ht__selection--columns",d="left"}if(l.classList.contains(c)){var m=this.wot.getSetting("columnHeaders").length;if(y=s(e,m-n),p=s(r,m-n),!y||!p)return!1;var g=(0,a.cv)(y),b=(0,a.cv)(p);return y&&p&&(f=g[d]-o[d]-1,h=b[d]+u(p)-g[d]),[y,f,h]}return!1}},{key:"changeBorderStyle",value:function(t,e){var r=this[t].style,n=e[t];!n||n.hide?(0,a.cn)(this[t],"hidden"):((0,a.pv)(this[t],"hidden")&&(0,a.IV)(this[t],"hidden"),r.backgroundColor=n.color,("top"===t||"bottom"===t)&&(r.height="".concat(n.width,"px")),("start"===t||"end"===t)&&(r.width="".concat(n.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(t){var e={width:1,color:"#000"},r=this[t].style;r.backgroundColor=e.color,r.width="".concat(e.width,"px"),r.height="".concat(e.width,"px")}},{key:"toggleHiddenClass",value:function(t,e){this.changeBorderToDefaultStyle(t),e?(0,a.cn)(this[t],"hidden"):(0,a.IV)(this[t],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,u.K1)()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}],d(r.prototype,t),e&&d(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==m(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==m(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===m(e)?e:String(e)}(n.key),n)}}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,R(n.key),n)}}function S(){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function C(t,e){return(C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function O(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t){var e=function(t,e){if("object"!==b(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==b(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===b(e)?e:String(e)}var E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(i,t);var e,r,n,o=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=T(i);if(e){var n=T(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return O(t)}(this,t)});function i(t,e){var r,n,a;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),n=O(r=o.call(this,t,null)),(a=R(a="visualCellRange"))in n?Object.defineProperty(n,a,{value:null,enumerable:!0,configurable:!0,writable:!0}):n[a]=null,r.visualCellRange=e||null,r.commit(),r}return r=[{key:"add",value:function(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}},{key:"clear",value:function(){return this.visualCellRange=null,S(T(i.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(t){var e=t.from,r=t.to,n=this.getNearestNotHiddenCoords(e,1),o=this.getNearestNotHiddenCoords(r,-1);if(null===n||null===o)return null;if(n.row>o.row||n.col>o.col){if(!("header"===this.settings.type||"active-header"===this.settings.type))return null;n=e,o=r}return this.settings.createCellRange(n,n,o)}},{key:"getNearestNotHiddenCoords",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),t.row,e);if(null===n)return null;var o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),t.col,r);return null===o?null:this.settings.createCellCoords(n,o)}},{key:"getNearestNotHiddenIndex",value:function(t,e,r){if(e<0)return e;var n=t.getNearestNotHiddenIndex(e,r);return("header"===this.settings.type||"active-header"===this.settings.type)&&null===n?-1:n}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return null===t?this.cellRange=null:this.cellRange=this.createRenderableCellRange(t.from,t.to),this}},{key:"syncWith",value:function(t){var e="N-S"===t.getVerticalDirection()?1:-1,r="W-E"===t.getHorizontalDirection()?1:-1,n=this.getNearestNotHiddenCoords(t.from.clone().normalize(),e,r);if(null!==n&&t.overlaps(n)){if(null===this.cellRange){var o=this.settings.visualToRenderableCoords(n);this.cellRange=this.settings.createCellRange(o)}return t.setHighlight(n),this}return t.setHighlight(t.from),this}},{key:"getCorners",value:function(){var t=this.cellRange,e=t.from,r=t.to,n=null===e.row||null===r.row,o=null===e.col||null===r.col,i=this.settings.createCellCoords(n?null:Math.min(e.row,r.row),o?null:Math.min(e.col,r.col)),a=this.settings.createCellCoords(n?null:Math.max(e.row,r.row),o?null:Math.max(e.col,r.col));return[i.row,i.col,a.row,a.col]}},{key:"getVisualCorners",value:function(){var t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}},{key:"createRenderableCellRange",value:function(t,e){var r=this.settings.visualToRenderableCoords(t),n=this.settings.visualToRenderableCoords(e);return this.settings.createCellRange(r,r,n)}}],w(i.prototype,r),n&&w(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(function(){var t,e;function r(t,e){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.settings=t,this.cellRange=e||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return t=[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new y(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}},{key:"addClassAtCoords",value:function(t,e,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t.wtTable.getCell(this.settings.createCellCoords(e,r));if("object"===m(i)){var l=n;o&&(l=this.classNameGenerator(i),this.classNames.includes(l)||this.classNames.push(l)),(0,a.cn)(i,l)}return this}},{key:"linearClassNameGenerator",value:function(t,e){return function r(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===e||0===o)return t;var i=o>=0?o:e,l=t,s=0==(i-=1)?t:"".concat(t,"-").concat(i);if((0,a.pv)(n,s)){var u=i+1;l="".concat(t,"-").concat(u)}else l=r(n,i);return l}}},{key:"draw",value:function(t){if(this.isEmpty()){this.settings.border&&this.getBorder(t).disappear();return}var e=t.wtTable.getRenderedRowsCount(),r=t.wtTable.getRenderedColumnsCount(),n=this.getCorners(),o=function(t){if(Array.isArray(t))return t}(n)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(n,4)||function(t,e){if(t){if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(t,e)}}(n,4)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],l=o[1],s=o[2],u=o[3],c=this.settings,f=c.highlightHeaderClassName,h=c.highlightColumnClassName,d=c.highlightRowClassName,y=c.highlightOnlyClosestHeader,m=c.selectionType,g=void 0===m||["active-header","header"].includes(m);if(g&&null!==l&&null!==u)for(var b=0,w=0;w<r;w+=1){var S=t.wtTable.columnFilter.renderedToSource(w);if(S>=l&&S<=u){var C=t.wtTable.getColumnHeaders(S),O=C.length-1;y&&C.length>1&&(C=[C[O]]);for(var T=0;T<C.length;T+=1){var R=[],E=C[T];f&&R.push(f),h&&R.push(h),T=y?O:T;var k=t.getSetting("onBeforeHighlightingColumnHeader",S,T,{selectionType:m,columnCursor:b,selectionWidth:u-l+1,classNames:R});k!==S&&(E=t.wtTable.getColumnHeader(k,T)),(0,a.cn)(E,R)}b+=1}}if(null!==i&&null!==s)for(var P=0,j=0;j<e;j+=1){var x=t.wtTable.rowFilter.renderedToSource(j);if(g&&x>=i&&x<=s){var A=t.wtTable.getRowHeaders(x),H=A.length-1;y&&A.length>1&&(A=[A[H]]);for(var M=0;M<A.length;M+=1){var I=[],N=A[M];f&&I.push(f),d&&I.push(d),M=y?H:M;var _=t.getSetting("onBeforeHighlightingRowHeader",x,M,{selectionType:m,rowCursor:P,selectionHeight:s-i+1,classNames:I});_!==x&&(N=t.wtTable.getRowHeader(_,M)),(0,a.cn)(N,I)}P+=1}if(null!==l&&null!==u)for(var D=0;D<r;D+=1){var L=t.wtTable.columnFilter.renderedToSource(D);x>=i&&x<=s&&L>=l&&L<=u?this.settings.className&&this.addClassAtCoords(t,x,L,this.settings.className,this.settings.markIntersections):x>=i&&x<=s?d&&this.addClassAtCoords(t,x,L,d):L>=l&&L<=u&&h&&this.addClassAtCoords(t,x,L,h);var V=t.getSetting("onAfterDrawSelection",x,L,this.settings.layerLevel);"string"==typeof V&&this.addClassAtCoords(t,x,L,V)}}t.getSetting("onBeforeDrawBorders",n,this.settings.className),this.settings.border&&this.getBorder(t).appear(n)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(t){return t.destroy()})}}],g(r.prototype,t),e&&g(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}());function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var P=["activeHeaderClassName"];function j(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function x(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?j(Object(r),!0).forEach(function(e){var n,o,i;n=t,o=e,i=r[e],(o=function(t){var e=function(t,e){if("object"!==k(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==k(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===k(e)?e:String(e)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var A=function(t){var e=t.activeHeaderClassName,r=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,P);return new E(x(x({highlightHeaderClassName:e},r),{},{selectionType:i.CD}))};function H(t){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var M=["layerLevel","areaCornerVisible"];function I(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function N(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?I(Object(r),!0).forEach(function(e){var n,o,i;n=t,o=e,i=r[e],(o=function(t){var e=function(t,e){if("object"!==H(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==H(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===H(e)?e:String(e)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var _=function(t){var e=t.layerLevel,r=t.areaCornerVisible,n=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,M);return new E(N(N({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:i.AI}))};function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var L=["cellCornerVisible"];function V(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function B(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?V(Object(r),!0).forEach(function(e){var n,o,i;n=t,o=e,i=r[e],(o=function(t){var e=function(t,e){if("object"!==D(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==D(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===D(e)?e:String(e)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var W=function(t){var e=t.cellCornerVisible,r=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,L);return new E(B(B({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}},r),{},{selectionType:i.d7}))};function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var z=["border","visualCellRange"];function U(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function G(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?U(Object(r),!0).forEach(function(e){var n,o,i;n=t,o=e,i=r[e],(o=function(t){var e=function(t,e){if("object"!==F(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==F(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===F(e)?e:String(e)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var K=function(t){var e=t.border,r=t.visualCellRange,n=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,z);return new E(G(G(G({},e),n),{},{selectionType:i.$7}),r)};function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function X(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function $(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?X(Object(r),!0).forEach(function(e){var n,o,i;n=t,o=e,i=r[e],(o=function(t){var e=function(t,e){if("object"!==q(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==q(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===q(e)?e:String(e)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}r(9601);var Y=function(t){var e=Object.assign({},(function(t){if(null==t)throw TypeError("Cannot destructure "+t)}(t),t));return new E($($({className:"fill",border:{width:1,color:"#ff0000"}},e),{},{selectionType:i.P$}))};function Z(t){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var J=["headerClassName","rowClassName","columnClassName"];function Q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function tt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(r),!0).forEach(function(e){var n,o,i;n=t,o=e,i=r[e],(o=function(t){var e=function(t,e){if("object"!==Z(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Z(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Z(e)?e:String(e)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var te=function(t){var e=t.headerClassName,r=t.rowClassName,n=t.columnClassName,o=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,J);return new E(tt(tt({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:i.Nc}))};function tr(t){return(tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var to=(0,o.Z)("highlight/types"),ti=to.register,ta=to.getItem;function tl(t,e){return ta(t)(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?tn(Object(r),!0).forEach(function(e){var n,o,i;n=t,o=e,i=r[e],(o=function(t){var e=function(t,e){if("object"!==tr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tr(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tr(e)?e:String(e)}(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tn(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({type:t},e))}ti(i.CD,A),ti(i.AI,_),ti(i.d7,W),ti(i.$7,K),ti(i.P$,Y),ti(i.Nc,te);var ts=r(613);function tu(t){return(tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tc(t){return function(t){if(Array.isArray(t))return tf(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return tf(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tf(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tf(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function th(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function td(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?th(Object(r),!0).forEach(function(e){var n,o,i;n=t,o=e,i=r[e],(o=tp(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):th(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function ty(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tp(n.key),n)}}function tp(t){var e=function(t,e){if("object"!==tu(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tu(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tu(e)?e:String(e)}var tm=function(t){var e,r;function n(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,n),this.options=t,this.layerLevel=0,this.cell=tl(i.d7,t),this.fill=tl(i.P$,t),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return e=[{key:"isEnabledFor",value:function(t,e){var r=t;t===i.d7&&(r="current");var n=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(r)}},{key:"useLayerLevel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var t,e=this.layerLevel;return this.areas.has(e)?t=this.areas.get(e):(t=tl(i.AI,td({layerLevel:e},this.options)),this.areas.set(e,t)),t}},{key:"getAreas",value:function(){return tc(this.areas.values())}},{key:"createOrGetHeader",value:function(){var t,e=this.layerLevel;return this.headers.has(e)?t=this.headers.get(e):(t=tl(i.Nc,td({},this.options)),this.headers.set(e,t)),t}},{key:"getHeaders",value:function(){return tc(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var t,e=this.layerLevel;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=tl(i.CD,td({},this.options)),this.activeHeaders.set(e,t)),t}},{key:"getActiveHeaders",value:function(){return tc(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return tc(this.customSelections.values())}},{key:"addCustomSelection",value:function(t){this.customSelections.push(tl(i.$7,td(td({},this.options),t)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),(0,ts.Bk)(this.areas.values(),function(t){t.clear()}),(0,ts.Bk)(this.headers.values(),function(t){t.clear()}),(0,ts.Bk)(this.activeHeaders.values(),function(t){t.clear()})}},{key:t,value:function(){return[this.cell,this.fill].concat(tc(this.areas.values()),tc(this.headers.values()),tc(this.activeHeaders.values()),tc(this.customSelections))[Symbol.iterator]()}}],ty(n.prototype,e),r&&ty(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n}(Symbol.iterator);function tv(t){return(tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tg(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==tv(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tv(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tv(e)?e:String(e)}(n.key),n)}}var tb=function(t){var e,r;function n(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,n),this.ranges=[],this.createCellRange=t}return e=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}},{key:"add",value:function(t){return this.ranges.push(this.createCellRange(t)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(t){return this.ranges.some(function(e){return e.includes(t)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=this.size()+e-1;return r>=0&&(t=this.ranges[r]),t}},{key:t,value:function(){return this.ranges[Symbol.iterator]()}}],tg(n.prototype,e),r&&tg(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n}(Symbol.iterator),tw=r(1799),tS=r(5981);function tC(t){return(tC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tO(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==tC(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tC(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tC(e)?e:String(e)}(n.key),n)}}var tT=function(){var t,e;function r(t,e){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.range=t,this.options=e}return t=[{key:"transformStart",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.options.createCellCoords(t,e),o=this.range.current().highlight,i=this.options.visualToRenderableCoords(o),a=i.row,l=i.col,s=o,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",n),null!==a&&null!==l){var f=this.options.countRows(),h=this.options.countCols(),d=this.options.fixedRowsBottom(),y=this.options.minSpareRows(),p=this.options.minSpareCols(),m=this.options.autoWrapRow(),g=this.options.autoWrapCol();a+t>f-1?r&&y>0&&!(d&&a>=f-d-1)?(this.runLocalHooks("insertRowRequire",f),f=this.options.countRows()):g&&(n.row=1-f,n.col=l+n.col===h-1?1-h:1):g&&a+n.row<0&&l+n.col>=0&&(n.row=f-1,n.col=l+n.col===0?h-1:-1),l+n.col>h-1?r&&p>0?(this.runLocalHooks("insertColRequire",h),h=this.options.countCols()):m&&(n.row=a+n.row===f-1?1-f:1,n.col=1-h):m&&l+n.col<0&&a+n.row>=0&&(n.row=a+n.row===0?f-1:-1,n.col=h-1);var b=this.options.createCellCoords(a+n.row,l+n.col);u=0,c=0,b.row<0?(u=-1,b.row=0):b.row>0&&b.row>=f&&(u=1,b.row=f-1),b.col<0?(c=-1,b.col=0):b.col>0&&b.col>=h&&(c=1,b.col=h-1),s=this.options.renderableToVisualCoords(b)}return this.runLocalHooks("afterTransformStart",s,u,c),s}},{key:"transformEnd",value:function(t,e){var r=this.options.createCellCoords(t,e),n=this.range.current(),o=n.to,i=0,a=0;this.runLocalHooks("beforeTransformEnd",r);var l=this.options.visualToRenderableCoords(n.highlight),s=l.row,u=l.col;if(null!==s&&null!==u){var c=this.options.countRows(),f=this.options.countCols(),h=this.options.visualToRenderableCoords(n.to),d=h.row,y=h.col,p=this.options.createCellCoords(d+r.row,y+r.col);i=0,a=0,p.row<0?(i=-1,p.row=0):p.row>0&&p.row>=c&&(i=1,p.row=c-1),p.col<0?(a=-1,p.col=0):p.col>0&&p.col>=f&&(a=1,p.col=f-1),o=this.options.renderableToVisualCoords(p)}return this.runLocalHooks("afterTransformEnd",o,i,a),o}}],tO(r.prototype,t),e&&tO(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();(0,s.jB)(tT,tS.Z);var tR=r(1199),tE=r(8336);function tk(t){return(tk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tP(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return tj(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tj(t,e)}}(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tj(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function tx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==tk(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tk(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tk(e)?e:String(e)}(n.key),n)}}var tA=function(){var t,e;function r(t,e){var n=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.settings=t,this.tableProps=e,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new tb(function(t,e,r){return n.tableProps.createCellRange(t,e,r)}),this.highlight=new tm({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(t,e){return n.tableProps.isDisabledCellSelection(t,e)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(t){return n.tableProps.visualToRenderableCoords(t)},renderableToVisualCoords:function(t){return n.tableProps.renderableToVisualCoords(t)},createCellCoords:function(t,e){return n.tableProps.createCellCoords(t,e)},createCellRange:function(t,e,r){return n.tableProps.createCellRange(t,e,r)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new tT(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(t){return n.tableProps.visualToRenderableCoords(t)},renderableToVisualCoords:function(t){return n.tableProps.renderableToVisualCoords(t)},createCellCoords:function(t,e){return n.tableProps.createCellCoords(t,e)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(e))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(e))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(e))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(e))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(e))}),this.transformation.addLocalHook("insertColRequire",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.runLocalHooks.apply(n,["insertColRequire"].concat(e))})}return t=[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n="multiple"===this.settings.selectionMode,o=(0,tw.o8)(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,i=t.row<0,a=t.col<0,l=i&&a,s=t.clone();this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart".concat(r?"Only":""),s),(!n||n&&!o&&(0,tw.o8)(e))&&this.selectedRange.clear(),this.selectedRange.add(s),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),r||this.setRangeEnd(t)}},{key:"setRangeStartOnly",value:function(t,e){this.setRangeStart(t,e,!0)}},{key:"setRangeEnd",value:function(t){if(!this.selectedRange.isEmpty()){var e=t.clone();this.runLocalHooks("beforeSetRangeEnd",e),this.begin();var r=this.selectedRange.current();"single"!==this.settings.selectionMode&&r.setTo(this.tableProps.createCellCoords(e.row,e.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(i.d7,r.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(r);var n=this.getLayerLevel();n<this.highlight.layerLevel&&((0,ts.Bk)(this.highlight.getAreas(),function(t){t.clear()}),(0,ts.Bk)(this.highlight.getHeaders(),function(t){t.clear()}),(0,ts.Bk)(this.highlight.getActiveHeaders(),function(t){t.clear()})),this.highlight.useLayerLevel(n);var o=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(o.clear(),a.clear(),l.clear(),this.highlight.isEnabledFor(i.AI,r.highlight)&&(this.isMultiple()||n>=1)&&(o.add(r.from).add(r.to).commit(),1===n)){var s=this.selectedRange.previous();this.highlight.useLayerLevel(n-1).createOrGetArea().add(s.from).commit().syncWith(s),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(i.Nc,r.highlight)){var u=0===this.tableProps.countRowsTranslated(),c=0===this.tableProps.countColsTranslated(),f=r;(u||c)&&(f=r.clone()),u&&(f.from.row=-1),c&&(f.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&f.from.normalize(),a.add(f.from).commit()):a.add(f.from).add(f.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===r.getWidth()&&l.add(this.tableProps.createCellCoords(r.from.row,-1)).add(this.tableProps.createCellCoords(r.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===r.getHeight()&&l.add(this.tableProps.createCellCoords(-1,r.from.col)).add(this.tableProps.createCellCoords(-1,r.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",t)}}},{key:"isMultiple",value:function(){var t=(0,s.sm)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,r))}},{key:"transformEnd",value:function(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&this.isEntireRowSelected(t)}},{key:"isEntireRowSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return -1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}},{key:"isSelectedByColumnHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(t)}},{key:"isEntireColumnSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return -1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.tableProps.countRows(),n=this.tableProps.countCols();if(t||e||0!==r&&0!==n){var o=this.tableProps.createCellCoords(e?-1:0,t?-1:0),i=this.tableProps.createCellCoords(r-1,n-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(i),this.finish()}}},{key:"selectCells",value:function(t){var e=this,r=(0,tR.AV)(t);if(r===tR.gk)return!1;if(r===tR.Kk)throw Error((0,tE.e)(n||(n=Object.freeze(Object.defineProperties(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],{raw:{value:Object.freeze(["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."])}})))));var o=(0,tR.S5)(r,{propToCol:function(t){return e.tableProps.propToCol(t)},keepDirection:!0}),i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=!t.some(function(t){var e=tP(o(t),4),r=e[0],n=e[1],l=e[2],s=e[3];return!((0,tR.AO)(r,i)&&(0,tR.AO)(n,a)&&(0,tR.AO)(l,i)&&(0,tR.AO)(s,a))});return l&&(this.clear(),(0,ts.Bk)(t,function(t){var r=tP(o(t),4),n=r[0],i=r[1],a=r[2],l=r[3];e.setRangeStartOnly(e.tableProps.createCellCoords(n,i),!1),e.setRangeEnd(e.tableProps.createCellCoords(a,l)),e.finish()})),l}},{key:"selectColumns",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n="string"==typeof t?this.tableProps.propToCol(t):t,o="string"==typeof e?this.tableProps.propToCol(e):e,i=this.tableProps.countCols(),a=this.tableProps.countRows(),l=(0,tR.AO)(n,i)&&(0,tR.AO)(o,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,n)),this.setRangeEnd(this.tableProps.createCellCoords(a-1,o)),this.finish()),l}},{key:"selectRows",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=this.tableProps.countRows(),o=this.tableProps.countCols(),i=(0,tR.AO)(t,n)&&(0,tR.AO)(e,n);return i&&(this.setRangeStartOnly(this.tableProps.createCellCoords(t,r)),this.setRangeEnd(this.tableProps.createCellCoords(e,o-1)),this.finish()),i}},{key:"refresh",value:function(){if(this.highlight.getCustomSelections().forEach(function(t){t.commit()}),this.isSelected()){var t=this.highlight.getCell(),e=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(var r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);var n=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),i=this.highlight.createOrGetActiveHeader();n.commit(),o.commit(),i.commit()}this.highlight.useLayerLevel(e)}}}],tx(r.prototype,t),e&&tx(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();(0,s.jB)(tA,tS.Z);var tH=tA},1199:function(t,e,r){"use strict";r.d(e,{AO:function(){return w},AV:function(){return p},I8:function(){return b},Kk:function(){return u},S5:function(){return m},X8:function(){return g},gk:function(){return c}}),r(2526),r(1817),r(1539),r(6699),r(2023),r(6992),r(189),r(8783),r(3948),r(1038),r(2707),r(2165),r(7042),r(8309),r(4916);var n=r(1640),o=r(613),i=r(1799);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(t,e)}}(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var u=0,c=1,f=[3,2],h=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],d=Symbol("root"),y=Symbol("child");function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;if(e!==d&&e!==y)throw Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(t),o=e===d,i=u;if(r){var a=t[0];0===t.length?i=c:o&&a instanceof n.Z?i=3:o&&Array.isArray(a)?i=p(a,y):t.length>=2&&t.length<=4&&!t.some(function(t,e){return!h[e].includes(s(t))})&&(i=2)}return i}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.keepDirection,n=void 0!==r&&r,o=e.propToCol;if(!f.includes(t))throw Error("Unsupported selection ranges schema type was provided.");return function(e){var r=3===t,a=r?e.from.row:e[0],l=r?e.from.col:e[1],s=r?e.to.row:e[2],u=r?e.to.col:e[3];if("function"==typeof o&&("string"==typeof l&&(l=o(l)),"string"==typeof u&&(u=o(u))),(0,i.o8)(s)&&(s=a),(0,i.o8)(u)&&(u=l),!n){var c=a,f=l,h=s,d=u;a=Math.min(c,h),l=Math.min(f,d),s=Math.max(c,h),u=Math.max(f,d)}return[a,l,s,u]}}function g(t){var e=p(t);if(e===u||e===c)return[];var r=m(e),n=new Set;(0,o.Bk)(t,function(t){var e=a(r(t),4),i=e[1],l=e[3],s=Math.max(i,0);(0,o.Bk)(Array.from(Array(l-s+1),function(t,e){return s+e}),function(t){n.has(t)||n.add(t)})});var i=Array.from(n).sort(function(t,e){return t-e});return(0,o.k$)(i,function(t,e,r,n){return 0!==r&&e===n[r-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t},[])}function b(t){var e=p(t);if(e===u||e===c)return[];var r=m(e),n=new Set;(0,o.Bk)(t,function(t){var e=a(r(t),3),i=e[0],l=e[2],s=Math.max(i,0);(0,o.Bk)(Array.from(Array(l-s+1),function(t,e){return s+e}),function(t){n.has(t)||n.add(t)})});var i=Array.from(n).sort(function(t,e){return t-e});return(0,o.k$)(i,function(t,e,r,n){return 0!==r&&e===n[r-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t},[])}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof t&&t>=0&&t<e}},8524:function(t,e,r){"use strict";r.d(e,{U:function(){return C}});var n,o,i=r(8722);r(3371),r(2526),r(1817),r(2165),r(8783),r(8309),r(1038),r(4916),r(2222),r(6992),r(1539),r(3948),r(4747),r(4553),r(561),r(7327),r(7042),r(1532),r(9600),r(2707),r(1249);var a=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),l=function(t){return t.map(function(t){var e=t.toLowerCase();return a.has(e)?a.get(e):e}).sort().join("+")},s=function(t){return t.toLowerCase()},u=r(1799),c=r(7161),f=r(7772),h=r(8336);function d(t,e){if(t){if("string"==typeof t)return y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(t,e)}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var p=function(t){var e=(0,i.I)({errorIdExists:function(e){return'The "'.concat(e,'" shortcut is already registered in the "').concat(t,'" context.')}}),r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.keys,n=t.callback,i=t.group,a=t.runOnlyIf,s=t.captureCtrl,f=t.preventDefault,d=t.stopPropagation,y=t.relativeToGroup,p=t.position;if((0,u.o8)(i))throw Error("You need to define the shortcut's group.");if(!1===(0,c.mf)(n))throw Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(r))throw Error((0,h.e)(o||(o=Object.freeze(Object.defineProperties(["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],{raw:{value:Object.freeze(["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."])}})))));var m={callback:n,group:i,runOnlyIf:void 0===a?function(){return!0}:a,captureCtrl:void 0!==s&&s,preventDefault:void 0===f||f,stopPropagation:void 0!==d&&d};if((0,u.$K)(y)){var g=[y,p];m.relativeToGroup=g[0],m.position=g[1]}r.forEach(function(t){var r=l(t);if(e.hasItem(r)){var n=e.getItem(r),o=n.findIndex(function(t){return t.group===y});-1!==o?"before"===p?o-=1:o+=1:o=n.length,n.splice(o,0,m)}else e.addItem(r,[m])})},n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach(function(t){(0,f._l)(e,function(r,n){!1===Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=e[n])}),r(t)})},a=function(t){var r=l(t);e.removeItem(r)},s=function(t){e.getItems().forEach(function(e){var r=function(t){if(Array.isArray(t))return t}(e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,2)||d(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],o=r[1],i=o.filter(function(e){return e.group!==t});0===i.length?a(n.split("+")):(o.length=0,o.push.apply(o,function(t){if(Array.isArray(t))return y(t)}(i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||d(i)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))})};return{addShortcut:r,addShortcuts:n,getShortcuts:function(t){var r=l(t),n=e.getItem(r);return(0,u.$K)(n)?n.slice():[]},hasShortcut:function(t){var r=l(t);return e.hasItem(r)},removeShortcutsByKeys:a,removeShortcutsByGroup:s}};r(6699),r(2023),r(189);var m=r(8539),g=r(766),b=r(9931),w=["meta","alt","shift","control"],S=(n=new Set,{press:function(t){n.add(t)},release:function(t){n.delete(t)},releaseAll:function(){n.clear()},isPressed:function(t){return n.has(t)}}),C=function(t){var e,r,n,o,a,l,u=t.ownerWindow,c=t.handleEvent,f=t.beforeKeyDown,h=t.afterKeyDown,d=(0,i.I)({errorIdExists:function(t){return'The "'.concat(t,'" context name is already registered.')}}),y="grid",C=function(t){var e=p(t);return d.addItem(t,e),e},O=function(){return y},T=function(t){return d.getItem(t)},R=function(t){y=t},E=!1,k=(e=function(t,e){var r=T(O()),n=!1;if(!r.hasShortcut(e))return n;for(var o=r.getShortcuts(e),i=0;i<o.length;i++){var a=o[i],l=a.callback,s=a.runOnlyIf,u=a.preventDefault,c=a.stopPropagation,f=a.captureCtrl;if(!1!==s(t)&&(E=f,n=!1===l(t,e),E=!1,u&&t.preventDefault(),c&&t.stopPropagation(),n))break}return n},r=function(t){return w.includes(t)},n=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];return t.altKey&&r.push("alt"),e&&(t.ctrlKey||t.metaKey)?r.push("control/meta"):(t.ctrlKey&&r.push("control"),t.metaKey&&r.push("meta")),t.shiftKey&&r.push("shift"),r},o=function(t){if(!1!==c(t)){var o=f(t);if(!(229===t.keyCode||!1===o||(0,m.Ty)(t))){var i=s(t.key),a=[];r(i)?S.press(i):a=n(t);var l=[i].concat(a);!e(t,l)&&((0,b.eE)()&&a.includes("meta")||!(0,b.eE)()&&a.includes("control"))&&e(t,[i].concat(n(t,!0))),h(t)}}},a=function(t){if(!1!==c(t)){var e=s(t.key);!1!==r(e)&&S.release(e)}},l=function(){S.releaseAll()},{mount:function(){for(var t=u;t;)t.document.documentElement.addEventListener("keydown",o),t.document.documentElement.addEventListener("keyup",a),t.document.documentElement.addEventListener("blur",l),t=(0,g.f5)(t)},unmount:function(){for(var t=u;t;)t.document.documentElement.removeEventListener("keydown",o),t.document.documentElement.removeEventListener("keyup",a),t.document.documentElement.removeEventListener("blur",l),t=(0,g.f5)(t)},isPressed:function(t){return S.isPressed(t)}});return k.mount(),{addContext:C,getActiveContextName:O,getContext:T,setActiveContextName:R,isCtrlPressed:function(){return!E&&(k.isPressed("control")||k.isPressed("meta"))},destroy:function(){return k.unmount()}}}},6284:function(t,e,r){"use strict";r.d(e,{Z:function(){return nt}}),r(6992),r(1539),r(8783),r(4129),r(3948),r(3161),r(9653),r(6649),r(6078),r(2526),r(1817),r(2165),r(1038),r(7042),r(8309),r(4916);var n,o=r(766),i=r(6487),a=r(8539);r(8304),r(489),r(2419),r(2564),r(6699);var l=r(7161),s=r(5965),u=r(9931),c=r(1799);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==f(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==f(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===f(e)?e:String(e)}(n.key),n)}}var d=new WeakMap,y=function(){var t,e;function r(t,e,n,o,i,a){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.wtSettings=n,this.domBindings=e,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,d.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return t=[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(e){return t.onContextMenu(e)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(e){return t.onMouseOut(e)});var e=function(){t.eventManager.addEventListener(t.wtTable.holder,"touchstart",function(e){return t.onTouchStart(e)}),t.eventManager.addEventListener(t.wtTable.holder,"touchend",function(e){return t.onTouchEnd(e)}),t.momentumScrolling||(t.momentumScrolling={}),t.eventManager.addEventListener(t.wtTable.holder,"scroll",function(){clearTimeout(t.momentumScrolling._timeout),t.momentumScrolling.ongoing||t.wtSettings.getSetting("onBeforeTouchScroll"),t.momentumScrolling.ongoing=!0,t.momentumScrolling._timeout=setTimeout(function(){t.touchApplied||(t.momentumScrolling.ongoing=!1,t.wtSettings.getSetting("onAfterMomentumScroll"))},200)})};(0,u.K1)()?e():((0,s.JS)()&&e(),t.eventManager.addEventListener(t.wtTable.holder,"mouseup",function(e){return t.onMouseUp(e)}),t.eventManager.addEventListener(t.wtTable.holder,"mousedown",function(e){return t.onMouseDown(e)}))}},{key:"selectedCellWasTouched",value:function(t){var e=d.get(this),r=this.parentCell(t).coords;if(e.selectedCellBeforeTouchEnd&&r){var n=[r.row,e.selectedCellBeforeTouchEnd.from.row],o=n[0],i=n[1],a=[r.col,e.selectedCellBeforeTouchEnd.from.col],l=a[0],s=a[1];return o===i&&l===s}return!1}},{key:"parentCell",value:function(t){var e={},r=this.wtTable.TABLE,n=(0,o.W6)(t,["TD","TH"],r);return n?(e.coords=this.wtTable.getCoords(n),e.TD=n):(0,o.pv)(t,"wtBorder")&&(0,o.pv)(t,"current")?(e.coords=this.selections.getCell().cellRange.highlight,e.TD=this.wtTable.getCell(e.coords)):(0,o.pv)(t,"wtBorder")&&(0,o.pv)(t,"area")&&this.selections.createOrGetArea().cellRange&&(e.coords=this.selections.createOrGetArea().cellRange.to,e.TD=this.wtTable.getCell(e.coords)),e}},{key:"onMouseDown",value:function(t){var e=d.get(this),r=this.domBindings.rootDocument.activeElement,n=(0,l.r$)(o.G_,t.target),i=t.target;if(i!==r&&n(0)!==r&&n(1)!==r){var a=this.parentCell(i);(0,o.pv)(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",t,i):a.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,a.coords,a.TD),(0===t.button||this.touchApplied)&&a.TD&&(e.dblClickOrigin[0]=a.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout(function(){e.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(t){if(this.wtSettings.has("onCellContextMenu")){var e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}},{key:"onMouseOver",value:function(t){if(this.wtSettings.has("onCellMouseOver")){var e=this.wtTable.TABLE,r=(0,o.W6)(t.target,["TD","TH"],e),n=this.parent||this;r&&r!==n.lastMouseOver&&(0,o.MO)(r,e)&&(n.lastMouseOver=r,this.callListener("onCellMouseOver",t,this.wtTable.getCoords(r),r))}}},{key:"onMouseOut",value:function(t){if(this.wtSettings.has("onCellMouseOut")){var e=this.wtTable.TABLE,r=(0,o.W6)(t.target,["TD","TH"],e),n=(0,o.W6)(t.relatedTarget,["TD","TH"],e);r&&r!==n&&(0,o.MO)(r,e)&&this.callListener("onCellMouseOut",t,this.wtTable.getCoords(r),r)}}},{key:"onMouseUp",value:function(t){var e=d.get(this),r=this.parentCell(t.target);r.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,r.coords,r.TD),(0===t.button||this.touchApplied)&&(r.TD===e.dblClickOrigin[0]&&r.TD===e.dblClickOrigin[1]?((0,o.pv)(t.target,"corner")?this.callListener("onCellCornerDblClick",t,r.coords,r.TD):this.callListener("onCellDblClick",t,r.coords,r.TD),e.dblClickOrigin[0]=null,e.dblClickOrigin[1]=null):r.TD===e.dblClickOrigin[0]&&(e.dblClickOrigin[1]=r.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout(function(){e.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(t){d.get(this).selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(t)}},{key:"onTouchEnd",value:function(t){var e,r=t.target,n=null===(e=this.parentCell(r))||void 0===e?void 0:e.coords,o=(0,c.$K)(n)&&n.row>=0&&n.col>=0;t.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance")&&((0,u.gn)()&&((0,u.E6)()||(0,u.iF)())&&this.selectedCellWasTouched(r)&&!["A","BUTTON","INPUT"].includes(r.tagName)?t.preventDefault():this.selectedCellWasTouched(r)||t.preventDefault()),this.onMouseUp(t),this.touchApplied=!1}},{key:"callListener",value:function(t,e,r,n){var o=this.wtSettings.getSettingPure(t);o&&o(e,r,n,this.facadeGetter())}},{key:"destroy",value:function(){var t=d.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}],h(r.prototype,t),e&&h(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();r(2222),r(4747);var p=r(613),m=r(1975);function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==g(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==g(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===g(e)?e:String(e)}(n.key),n)}}var w=function(){var t;function e(t,r,n){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=r,this.countTH=n}return b(e.prototype,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),t&&b(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==S(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==S(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===S(e)?e:String(e)}(n.key),n)}}var O=function(){var t;function e(t,r,n){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=r,this.countTH=n}return C(e.prototype,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),t&&C(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==T(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==T(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===T(e)?e:String(e)}(n.key),n)}}var E=function(){var t;function e(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return R(e.prototype,[{key:"setSize",value:function(t){this.currentSize=this.nextSize,this.nextSize=t}},{key:"setOffset",value:function(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}]),t&&R(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==k(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==k(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===k(e)?e:String(e)}(n.key),n)}}var j=function(){var t,e;function r(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.size=new E,this.workingSpace=0,this.sharedSize=null}return t=[{key:"setSize",value:function(t){this.size.setSize(t)}},{key:"setOffset",value:function(t){this.size.setOffset(t)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof E}},{key:"isPlaceOn",value:function(t){return this.workingSpace===t}},{key:"append",value:function(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}},{key:"prepend",value:function(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}],P(r.prototype,t),e&&P(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==x(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==x(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===x(e)?e:String(e)}(n.key),n)}}var H=function(){var t,e;function r(t,e,n){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.rootNode=t,this.nodesPool=e,this.sizeSet=new j,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return t=[{key:"setSize",value:function(t){return this.sizeSet.setSize(t),this}},{key:"setOffset",value:function(t){return this.sizeSet.setOffset(t),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}},{key:"getCurrentNode",value:function(){var t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}},{key:"getRenderedChildCount",value:function(){var t=this.rootNode,e=this.sizeSet,r=0;if(this.isSharedViewSet())for(var n=t.firstElementChild;n;){if(n.tagName===this.childNodeType)r+=1;else if(e.isPlaceOn(1))break;n=n.nextElementSibling}else r=t.childElementCount;return r}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var t=this.rootNode,e=this.sizeSet,r=this.isSharedViewSet(),n=e.getViewSize().nextSize,o=this.getRenderedChildCount();o<n;){var i=this.nodesPool();!r||r&&e.isPlaceOn(2)?t.appendChild(i):t.insertBefore(i,t.firstChild),o+=1}for(var a=r&&e.isPlaceOn(1);o>n;)t.removeChild(a?t.firstChild:t.lastChild),o-=1}},{key:"render",value:function(){var t=this.rootNode,e=this.sizeSet,r=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(r+=e.sharedSize.nextSize);var n=t.childNodes[r];if(n.tagName!==this.childNodeType){var o=this.nodesPool();t.replaceChild(o,n),n=o}this.collectedNodes.push(n),this.visualIndex+=1}},{key:"end",value:function(){}}],A(r.prototype,t),e&&A(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==M(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==M(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===M(e)?e:String(e)}(n.key),n)}}function N(t,e){return(N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&N(t,e)}(o,t);var e,r,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=_(o);if(e){var n=_(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===M(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function o(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,o),n.apply(this,arguments)}return I(o.prototype,[{key:"prependView",value:function(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}]),r&&I(o,r),Object.defineProperty(o,"prototype",{writable:!1}),o}(H);function L(t){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==L(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==L(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===L(e)?e:String(e)}(n.key),n)}}var B=function(){var t;function e(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.nodeType=t.toUpperCase()}return V(e.prototype,[{key:"setRootDocument",value:function(t){this.rootDocument=t}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),t&&V(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function F(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==W(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==W(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===W(e)?e:String(e)}(n.key),n)}}var z=function(){var t;function e(t,r){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.nodesPool="string"==typeof t?new B(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return F(e.prototype,[{key:"setTable",value:function(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),t&&F(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();function U(t){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==U(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==U(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===U(e)?e:String(e)}(n.key),n)}}function K(t,e){return(K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function q(t){return(q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var X=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&K(t,e)}(i,t);var e,r,n,o=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=q(i);if(e){var n=q(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===U(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(){var t;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,"TH")).orderViews=new WeakMap,t.sourceRowIndex=0,t}return r=[{key:"obtainOrderView",value:function(t){var e,r=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new D(t,function(t){return r.nodesPool.obtain(r.sourceRowIndex,t)},this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,r=t.rowHeaderFunctions,n=t.rowHeadersCount,o=t.rows,i=t.cells,a=0;a<e;a++){var l=this.table.renderedRowToSource(a),s=o.getRenderedNode(a);this.sourceRowIndex=l;var u=this.obtainOrderView(s),c=i.obtainOrderView(s);u.appendView(c).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<n;f++){u.render();var h=u.getCurrentNode();h.className="",h.removeAttribute("style"),r[f](l,h,f)}u.end()}}}],G(i.prototype,r),n&&G(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(z);function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==$(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==$(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===$(e)?e:String(e)}(n.key),n)}}function Z(t,e){return(Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function J(t){return(J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Z(t,e)}(a,t);var e,r,n,i=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=J(a);if(e){var n=J(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===$(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),i.call(this,null,t)}return r=[{key:"adjust",value:function(){var t=this.table,e=t.columnHeadersCount,r=t.rowHeadersCount,n=this.rootNode.firstChild;if(e){for(var i=this.table.columnsToRender+r,a=0;a<e;a++){for((n=this.rootNode.childNodes[a])||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}var l=this.rootNode.childNodes.length;if(l>e)for(var s=e;s<l;s++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&(0,o.cS)(n)}},{key:"render",value:function(){for(var t=this.table.columnHeadersCount,e=0;e<t;e+=1)for(var r=this.table,n=r.columnHeaderFunctions,o=r.columnsToRender,i=r.rowHeadersCount,a=this.rootNode.childNodes[e],l=-1*i;l<o;l+=1){var s=this.table.renderedColumnToSource(l),u=a.childNodes[l+i];u.className="",u.removeAttribute("style"),n[e](s,u,e)}}}],Y(a.prototype,r),n&&Y(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(z);function tt(t){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==tt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tt(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tt(e)?e:String(e)}(n.key),n)}}function tr(t,e){return(tr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function tn(t){return(tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var to=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tr(t,e)}(a,t);var e,r,n,i=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=tn(a);if(e){var n=tn(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===tt(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),i.call(this,null,t)}return r=[{key:"adjust",value:function(){for(var t=this.table,e=t.columnsToRender+t.rowHeadersCount;this.renderedNodes<e;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>e;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var t=this.table,e=t.columnsToRender,r=t.rowHeadersCount,n=0;n<r;n++){var i=this.table.renderedColumnToSource(n),a=this.table.columnUtils.getHeaderWidth(i);this.rootNode.childNodes[n].style.width="".concat(a,"px")}for(var l=0;l<e;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[l+r].style.width="".concat(u,"px")}var c=this.rootNode.firstChild;c&&(0,o.cn)(c,"rowHeader")}}],te(a.prototype,r),n&&te(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(z);r(3371);var ti=r(3895),ta=r(8336);function tl(t){return(tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ts(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==tl(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tl(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tl(e)?e:String(e)}(n.key),n)}}function tu(t,e){return(tu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function tc(t){return(tc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var tf=!1,th=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tu(t,e)}(a,t);var e,r,o,i=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=tc(a);if(e){var n=tc(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===tl(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"TR",t)).orderView=new H(t,function(t){return e.nodesPool.obtain(t)},e.nodeType),e}return r=[{key:"getRenderedNode",value:function(t){return this.orderView.getNode(t)}},{key:"render",value:function(){var t=this.table.rowsToRender;!tf&&t>1e3&&(tf=!0,(0,ti.ZK)((0,ta.e)(n||(n=Object.freeze(Object.defineProperties(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],{raw:{value:Object.freeze(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'])}})))))),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(var e=0;e<t;e++)this.orderView.render();this.orderView.end()}}],ts(a.prototype,r),o&&ts(a,o),Object.defineProperty(a,"prototype",{writable:!1}),a}(z);function td(t){return(td="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ty(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==td(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==td(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===td(e)?e:String(e)}(n.key),n)}}function tp(t,e){return(tp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function tm(t){return(tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var tv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tp(t,e)}(a,t);var e,r,n,i=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=tm(a);if(e){var n=tm(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===td(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(){var t;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,"TD")).orderViews=new WeakMap,t.sourceRowIndex=0,t}return r=[{key:"obtainOrderView",value:function(t){var e,r=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new D(t,function(t){return r.nodesPool.obtain(r.sourceRowIndex,t)},this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,r=t.columnsToRender,n=t.rows,i=t.rowHeaders,a=0;a<e;a++){var l=this.table.renderedRowToSource(a),s=n.getRenderedNode(a);this.sourceRowIndex=l;var u=this.obtainOrderView(s),c=i.obtainOrderView(s);u.prependView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<r;f++){u.render();var h=u.getCurrentNode(),d=this.table.renderedColumnToSource(f);(0,o.pv)(h,"hide")||(h.className=""),h.removeAttribute("style"),h.removeAttribute("dir"),this.table.cellRenderer(l,d,h)}u.end()}}}],ty(a.prototype,r),n&&ty(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(z);function tg(t){return(tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tb(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==tg(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tg(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tg(e)?e:String(e)}(n.key),n)}}var tw=function(){var t,e;function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.cellRenderer;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return t=[{key:"setAxisUtils",value:function(t,e){this.rowUtils=t,this.columnUtils=e}},{key:"setViewportSize",value:function(t,e){this.rowsToRender=t,this.columnsToRender=e}},{key:"setFilters",value:function(t,e){this.rowFilter=t,this.columnFilter=e}},{key:"setHeaderContentRenderers",value:function(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}},{key:"setRenderers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.rowHeaders,r=t.columnHeaders,n=t.colGroup,o=t.rows,i=t.cells;e.setTable(this),r.setTable(this),n.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=o,this.cells=i}},{key:"renderedRowToSource",value:function(t){return this.rowFilter.renderedToSource(t)}},{key:"renderedColumnToSource",value:function(t){return this.columnFilter.renderedToSource(t)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var t=this.rowsToRender,e=this.rows,r=0;r<t;r++){var n=e.getRenderedNode(r);if(n.firstChild){var o=this.renderedRowToSource(r),i=this.rowUtils.getHeight(o);i?n.firstChild.style.height="".concat(i-1,"px"):n.firstChild.style.height=""}}}}],tb(r.prototype,t),e&&tb(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function tS(t){return(tS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tC(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==tS(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tS(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tS(e)?e:String(e)}(n.key),n)}}var tO=function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.renderer=new tw(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new X,columnHeaders:new Q(n),colGroup:new to(o),rows:new th(i),cells:new tv}),this.renderer.setAxisUtils(a,l)}return tC(e.prototype,[{key:"setFilters",value:function(t,e){return this.renderer.setFilters(t,e),this}},{key:"setViewportSize",value:function(t,e){return this.renderer.setViewportSize(t,e),this}},{key:"setHeaderContentRenderers",value:function(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),t&&tC(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();function tT(t){return(tT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tR(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==tT(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tT(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tT(e)?e:String(e)}(n.key),n)}}r(1532);var tE=function(){var t,e;function r(t,e){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.dataAccessObject=t,this.wtSettings=e,this.headerWidths=new Map}return t=[{key:"getWidth",value:function(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(t){var e=this.dataAccessObject.wtViewport.columnsRenderCalculator,r=this.getWidth(t);if(e){var n=e.getStretchedColumnWidth(t,r);n&&(r=n)}return r}},{key:"getHeaderHeight",value:function(t){var e=this.wtSettings.getSetting("defaultRowHeight"),r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==r&&(e=e?Math.max(e,r):r),e}},{key:"getHeaderWidth",value:function(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}},{key:"calculateWidths",value:function(){var t=this.wtSettings,e=this.dataAccessObject,r=e.wtTable,n=e.wtViewport,i=e.cloneSource,a=i?i.wtTable.holder:r.holder,l=a.offsetHeight<a.scrollHeight?(0,o.np)():0,s=t.getSetting("rowHeaderWidth");if(n.columnsRenderCalculator.refreshStretching(n.getViewportWidth()-l),null!=(s=t.getSetting("onModifyRowHeaderWidth",s)))for(var u=t.getSetting("rowHeaders").length,c=t.getSetting("defaultColumnWidth"),f=0;f<u;f++){var h=Array.isArray(s)?s[f]:s;h=null==h?c:h,this.headerWidths.set(f,h)}}}],tR(r.prototype,t),e&&tR(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function tk(t){return(tk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tP(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==tk(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tk(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tk(e)?e:String(e)}(n.key),n)}}var tj=function(){var t,e;function r(t,e){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.dataAccessObject=t,this.wtSettings=e}return t=[{key:"getHeight",value:function(t){var e=this.wtSettings.getSetting("rowHeight",t),r=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==r&&(e=void 0===e?r:Math.max(e,r)),e}}],tP(r.prototype,t),e&&tP(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}(),tx="bottom",tA="inline_start",tH="top_inline_start_corner",tM="bottom_inline_start_corner",tI=["top",tx,tA,tH,tM],tN=new Map([["top","ht_clone_".concat("top")],[tx,"ht_clone_".concat(tx)],[tA,"ht_clone_".concat(tA," ht_clone_left")],[tH,"ht_clone_".concat(tH," ht_clone_top_left_corner")],[tM,"ht_clone_".concat(tM," ht_clone_bottom_left_corner")]]);function t_(t){return(t_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tD(t,e){if(t){if("string"==typeof t)return tL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tL(t,e)}}function tL(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function tV(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tW(n.key),n)}}function tB(t,e,r){return(e=tW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tW(t){var e=function(t,e){if("object"!==t_(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==t_(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===t_(e)?e:String(e)}var tF=function(){var t,e;function r(t,e,n,i,a){var l=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),tB(this,"wtSettings",null),tB(this,"domBindings",void 0),tB(this,"TBODY",null),tB(this,"THEAD",null),tB(this,"COLGROUP",null),tB(this,"hasTableHeight",!0),tB(this,"hasTableWidth",!0),tB(this,"isTableVisible",!1),tB(this,"tableOffset",0),tB(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===a,this.name=a,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,(0,o.Wu)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return l._modifyRowHeaderWidth(s)}),this.rowUtils=new tj(this.dataAccessObject,this.wtSettings),this.columnUtils=new tE(this.dataAccessObject,this.wtSettings),this.tableRenderer=new tO({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return t=[{key:"is",value:function(t){return this.name===t}},{key:"fixTableDomTree",value:function(){var t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(t){var e,r=t.parentNode;return r&&r.nodeType===Node.ELEMENT_NODE&&(0,o.pv)(r,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",r&&r.insertBefore(e,t),e.appendChild(t)),e.style.position="relative",e}},{key:"createHider",value:function(t){var e,r=t.parentNode;return r&&r.nodeType===Node.ELEMENT_NODE&&(0,o.pv)(r,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtHider",r&&r.insertBefore(e,t),e.appendChild(t)),e}},{key:"createHolder",value:function(t){var e,r=t.parentNode;return r&&r.nodeType===Node.ELEMENT_NODE&&(0,o.pv)(r,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",r&&r.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable",e.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),e.appendChild(t)),e}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wtSettings,r=this.dataAccessObject,n=r.wtOverlays,i=r.wtViewport,a=e.getSetting("totalRows"),l=e.getSetting("totalColumns"),s=e.getSetting("rowHeaders"),u=s.length,c=e.getSetting("columnHeaders"),f=c.length,h=!1,d=t;if(this.isMaster&&(this.holderOffset=(0,o.cv)(this.holder),d=i.createRenderCalculators(d),u&&!e.getSetting("fixedColumnsStart"))){var y=n.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=0!==y,p!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(h=n.updateStateOfRendering()),d)this.isMaster&&i.createVisibleCalculators(),n&&n.refresh(!0);else{this.isMaster?this.tableOffset=(0,o.cv)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var m=a>0?this.getFirstRenderedRow():0,g=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new O(m,a,f),this.columnFilter=new w(g,l,u);var b=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var S={};this.wtSettings.getSetting("beforeDraw",!0,S),b=!0!==S.skipRender}if(b){if(this.tableRenderer.setHeaderContentRenderers(s,c),(this.is(tx)||this.is(tM))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(C=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(tx))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var C,T=(0,o.iO)(this.hider),R=(0,o.iO)(this.TABLE);0!==T&&R!==T&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),C!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(tx)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var E=!1;return this.isMaster&&(E=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(E=n.bottomOverlay.resetFixedPosition()||E),E=n.inlineStartOverlay.resetFixedPosition()||E,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),E?(n.refreshAll(),n.adjustElementsSize()):this.refreshSelections(d),h&&n.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(t){for(var e,r,n,i=this.columnFilter.renderedToSource(t),a=this.wtSettings.getSetting("columnHeaders").length,l=this.wtSettings.getSetting("defaultRowHeight"),s=this.wtSettings.getSetting("columnHeaderHeight")||[];a;)a-=1,e=this.getColumnHeaderHeight(a),(r=this.getColumnHeader(i,a))&&(n=(0,o.WS)(r),(!e&&l<n||e<n)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=n),Array.isArray(s)?null!==s[a]&&void 0!==s[a]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=s[a]):isNaN(s)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=s),this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]<(s[a]||s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=s[a]||s))}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wtSettings,e=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,n=t.getSetting("columnHeaders"),o=0,i=n.length;o<i;o++)if(r[o]){if(!e[o]||0===e[o].childNodes.length)return;e[o].childNodes[0].style.height="".concat(r[o],"px")}}},{key:"resetOversizedRows",value:function(){var t=this.wtSettings,e=this.dataAccessObject.wtViewport;if((this.isMaster||this.is(tx))&&!t.getSetting("externalRowCalculator"))for(var r=this.getRenderedRowsCount(),n=0;n<r;n++){var o=this.rowFilter.renderedToSource(n);e.oversizedRows&&e.oversizedRows[o]&&(e.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(t){for(var e=this.TABLE.querySelectorAll(".".concat(t)),r=0,n=e.length;r<n;r++)(0,o.IV)(e[r],t)}},{key:"refreshSelections",value:function(t){var e=this.wtSettings,r=this.dataAccessObject.selections;if(r){var n=Array.from(r),o=n.length;if(t){for(var i=[],a=0;a<o;a++){for(var l=n[a].settings,s=l.highlightHeaderClassName,u=l.highlightRowClassName,c=l.highlightColumnClassName,f=n[a].classNames,h=f.length,d=0;d<h;d++)i.includes(f[d])||i.push(f[d]);s&&!i.includes(s)&&i.push(s),u&&!i.includes(u)&&i.push(u),c&&!i.includes(c)&&i.push(c)}var y=e.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(y))for(var p=0;p<y.length;p++)i.push(y[p]);for(var m=i.length,g=0;g<m;g++)this.removeClassFromCells(i[g])}for(var b=0;b<o;b++)n[b].draw(this.facadeGetter(),t)}}},{key:"getCell",value:function(t){var e,r=t.row,n=t.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",r,n);if(o&&Array.isArray(o)){var i=function(t){if(Array.isArray(t))return t}(o)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(o,2)||tD(o,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();r=i[0],n=i[1]}if(this.isRowBeforeRenderedRows(r))return -1;if(this.isRowAfterRenderedRows(r))return -2;if(this.isColumnBeforeRenderedColumns(n))return -3;if(this.isColumnAfterRenderedColumns(n))return -4;if(!(e=r<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(r)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)])&&r>=0)throw Error("TR was expected to be rendered but is not");var a=e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!a&&n>=0)throw Error("TD or TH was expected to be rendered but is not");return a}},{key:"getColumnHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.THEAD.childNodes[e];return null==r?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}},{key:"getColumnHeaders",value:function(t){var e=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach(function(t){var n=t.childNodes[r];n&&e.push(n)}),e}},{key:"getRowHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)&&!(e>=this.wtSettings.getSetting("rowHeaders").length)){var r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return null==r?void 0:r.childNodes[e]}}},{key:"getRowHeaders",value:function(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var e=[],r=this.wtSettings.getSetting("rowHeaders").length,n=0;n<r;n++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null==o?void 0:o.childNodes[n];i&&e.push(i)}return e}},{key:"getCoords",value:function(t){var e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=(0,o.oq)(e,["TD","TH"])),null===e)return null;var r=e.parentNode,n=r.parentNode,i=(0,o.Kz)(r),a=e.cellIndex;return(0,o.mK)(tH,e,this.wtRootElement)||(0,o.mK)("top",e,this.wtRootElement)?"THEAD"===n.nodeName&&(i-=n.childNodes.length):i=(0,o.mK)(tM,e,this.wtRootElement)||(0,o.mK)(tx,e,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-n.childNodes.length+i:n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i),a=(0,o.mK)(tH,e,this.wtRootElement)||(0,o.mK)(tA,e,this.wtRootElement)||(0,o.mK)(tM,e,this.wtRootElement)?this.columnFilter.offsettedTH(a):this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(i,a)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var t,e,r,n,i,a=this.TBODY.childNodes.length;if(a*this.wtSettings.getSetting("defaultRowHeight")!=(0,o.WS)(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;a;)a-=1,r=this.rowFilter.renderedToSource(a),t=this.getRowHeight(r),e=(i=(n=this.getTrForRow(r)).querySelector("th"))?(0,o.WS)(i):(0,o.WS)(n)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<e||t<e)&&(e+=1,this.dataAccessObject.wtViewport.oversizedRows[r]=e)}}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"isColumnHeaderRendered",value:function(t){return!(t>=0)&&Math.abs(t)<=this.wtSettings.getSetting("rowHeaders").length}},{key:"isRowHeaderRendered",value:function(t){return!(t>=0)&&Math.abs(t)<=this.wtSettings.getSetting("columnHeaders").length}},{key:"isRowBeforeRenderedRows",value:function(t){var e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}},{key:"isRowAfterRenderedRows",value:function(t){return t>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(t){var e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}},{key:"isColumnAfterRenderedColumns",value:function(t){return this.columnFilter&&t>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&t>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&t>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&0>this.columnFilter.sourceToRendered(t)&&t>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(t){return this.rowUtils.getHeight(t)}},{key:"getColumnHeaderHeight",value:function(t){return this.columnUtils.getHeaderHeight(t)}},{key:"getColumnWidth",value:function(t){return this.columnUtils.getWidth(t)}},{key:"getStretchedColumnWidth",value:function(t){return this.columnUtils.getStretchedColumnWidth(t)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return(0,o.iO)(this.TABLE)}},{key:"getHeight",value:function(){return(0,o.Pb)(this.TABLE)}},{key:"getTotalWidth",value:function(){var t=(0,o.iO)(this.hider);return 0!==t?t:this.getWidth()}},{key:"getTotalHeight",value:function(){var t=(0,o.Pb)(this.hider);return 0!==t?t:this.getHeight()}},{key:"isVisible",value:function(){return(0,o.pn)(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(t){var e,r=(0,l.mf)(t)?t():null;return Array.isArray(r)?(r=function(t){if(Array.isArray(t))return tL(t)}(e=r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||tD(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[r.length-1]=this._correctRowHeaderWidth(r[r.length-1]):r=this._correctRowHeaderWidth(r),r}},{key:"_correctRowHeaderWidth",value:function(t){var e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}],tV(r.prototype,t),e&&tV(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}(),tz=r(7772),tU={getFirstRenderedRow:function(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};(0,tz.jW)(tU,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var tG={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};function tK(t){return(tK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tq(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==tK(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tK(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tK(e)?e:String(e)}(n.key),n)}}function tX(t,e){return(tX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function t$(t){return(t$=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(0,tz.jW)(tG,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var tY=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tX(t,e)}(i,t);var e,r,n,o=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=t$(i);if(e){var n=t$(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===tK(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e,r,n){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,e,r,n,"top")}return r&&tq(i.prototype,r),n&&tq(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(tF);(0,tz.jB)(tY,tU),(0,tz.jB)(tY,tG),r(2772);var tZ=r(9272);function tJ(t){return(tJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tQ(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,t1(n.key),n)}}function t0(t,e,r){return(e=t1(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t1(t){var e=function(t,e){if("object"!==tJ(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tJ(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===tJ(e)?e:String(e)}var t2=function(){var t,e;function r(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),t0(this,"dataAccessObject",void 0),t0(this,"lastScrolledColumnPos",-1),t0(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return t=[{key:"scrollViewport",value:function(t,e,r,n,o){var i=this.scrollViewportHorizontally(t.col,r,o),a=this.scrollViewportVertically(t.row,e,n);return i||a}},{key:"scrollViewportHorizontally",value:function(t,e,r){var n=this.dataAccessObject,o=n.drawn,i=n.totalColumns;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;var a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),s=void 0===e&&void 0===r,u=this.dataAccessObject,c=u.fixedColumnsStart,f=u.inlineStartOverlay;if(s&&t<c)return!1;var h=!1;return -1===a?h=f.scrollTo(t,s?t>this.lastScrolledColumnPos:e):(s&&(t<a||t>l)||!s)&&(h=f.scrollTo(t,s?t>l:e)),h&&(this.lastScrolledColumnPos=t),h}},{key:"scrollViewportVertically",value:function(t,e,r){var n=this.dataAccessObject,o=n.drawn,i=n.totalRows;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;var a=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),s=void 0===e&&void 0===r,u=this.dataAccessObject,c=u.fixedRowsBottom,f=u.fixedRowsTop,h=u.topOverlay;if(s&&(t<f||t>i-c-1))return!1;var d=!1;return -1===a?d=h.scrollTo(t,s?t>this.lastScrolledRowPos:r):(s&&(t<a||t>l)||!s)&&(d=h.scrollTo(t,s?t>l:r)),d&&(this.lastScrolledRowPos=t),d}},{key:"getFirstVisibleRow",value:function(){var t=this.dataAccessObject,e=t.topOverlay,r=t.wtTable,n=t.wtViewport,i=t.totalRows,a=t.fixedRowsTop,l=t.rootWindow,s=r.getFirstVisibleRow();if(e.mainTableScrollableElement===l){var u=(0,o.cv)(r.wtRootElement),c=(0,o.WS)(r.hider),f=(0,o.WS)(l),h=(0,o.cx)(l,l);if(u.top+c-f<=h){var d=n.getColumnHeaderHeight();d+=e.sumCellSizes(0,a);for(var y=i;y>0;y--)if(d+=e.sumCellSizes(y-1,y),u.top+c-d<=h){s=y;break}}}return s}},{key:"getLastVisibleRow",value:function(){var t=this.dataAccessObject,e=t.topOverlay,r=t.wtTable,n=t.wtViewport,i=t.totalRows,a=t.rootWindow,l=r.getLastVisibleRow();if(e.mainTableScrollableElement===a){var s=(0,o.cv)(r.wtRootElement),u=(0,o.cx)(a,a);if(s.top>u){for(var c=(0,o.WS)(a),f=n.getColumnHeaderHeight(),h=1;h<=i;h++)if(f+=e.sumCellSizes(h-1,h),s.top+f-u>=c){l=h-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var t=this.dataAccessObject,e=t.inlineStartOverlay,r=t.wtTable,n=t.wtViewport,i=t.totalColumns,a=t.rootWindow,l=r.getFirstVisibleColumn();if(e.mainTableScrollableElement===a){var s=(0,o.cv)(r.wtRootElement),u=(0,o.x9)(r.hider),c=(0,o.x9)(a),f=Math.abs((0,o.vj)(a,a));if(s.left+u-c<=f){for(var h=n.getRowHeaderWidth(),d=i;d>0;d--)if(h+=e.sumCellSizes(d-1,d),s.left+u-h<=f){l=d;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var t=this.dataAccessObject,e=t.inlineStartOverlay,r=t.wtTable,n=t.wtViewport,i=t.totalColumns,a=t.rootWindow,l=r.getLastVisibleColumn();if(e.mainTableScrollableElement===a){var s=(0,o.cv)(r.wtRootElement),u=Math.abs((0,o.vj)(a,a));if(s.left>u){for(var c=(0,o.x9)(a),f=n.getRowHeaderWidth(),h=1;h<=i;h++)if(f+=e.sumCellSizes(h-1,h),s.left+f-u>=c){l=h-2;break}}}return l}}],tQ(r.prototype,t),e&&tQ(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}(),t9=r(9368),t6=r(1640);function t3(t){return(t3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function t8(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,t4(n.key),n)}}function t7(t,e,r){return(e=t4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t4(t){var e=function(t,e){if("object"!==t3(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==t3(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===t3(e)?e:String(e)}var t5=function(){var t,e;function r(t,e){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),t7(this,"wtTable",void 0),t7(this,"wtScroll",void 0),t7(this,"wtViewport",void 0),t7(this,"wtOverlays",void 0),t7(this,"selections",void 0),t7(this,"wtEvent",void 0),t7(this,"guid","wt_".concat((0,tZ.O1)())),t7(this,"drawInterrupted",!1),t7(this,"drawn",!1),t7(this,"domBindings",void 0),t7(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new t2(this.createScrollDao())}return t=[{key:"eventManager",get:function(){return new i.Z(this)}},{key:"findOriginalHeaders",value:function(){var t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var e=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;e<r;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,r){(0,o.tT)(r,t[e])}])}}},{key:"createCellCoords",value:function(t,e){return new t9.Z(t,e,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(t,e,r){return new t6.Z(t,e,r,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}},{key:"getCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);var r=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<n&&t.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<i&&t.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else if(t.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);else if(t.row<r&&t.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t);return this.wtTable.getCell(t)}},{key:"scrollViewport",value:function(t,e,r,n,o){return!(t.col<0)&&!(t.row<0)&&this.wtScroll.scrollViewport(t,e,r,n,o)}},{key:"scrollViewportHorizontally",value:function(t,e,r){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,r)}},{key:"scrollViewportVertically",value:function(t,e,r){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,r)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selections(){return t.selections},get drawn(){return t.drawn},set drawn(v){t.drawn=v},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count}}}}],t8(r.prototype,t),e&&t8(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function et(t){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ee(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ea(n.key),n)}}function er(t,e){return(er=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function en(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eo(t){return(eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ei(t,e,r){return(e=ea(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ea(t){var e=function(t,e){if("object"!==et(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==et(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===et(e)?e:String(e)}var el=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&er(t,e)}(i,t);var e,r,n,o=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=eo(i);if(e){var n=eo(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===et(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return en(t)}(this,t)});function i(t,e,r){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),ei(en(n=o.call(this,t,e)),"cloneSource",void 0),ei(en(n),"cloneOverlay",void 0);var n,a=n.wtSettings.getSetting("facade",en(n));return n.cloneSource=r.source,n.cloneOverlay=r.overlay,n.wtTable=n.cloneOverlay.createTable(n.getTableDao(),a,n.domBindings,n.wtSettings),n.wtViewport=r.viewport,n.selections=r.selections,n.wtEvent=new y(a,n.domBindings,n.wtSettings,n.eventManager,n.wtTable,n.selections,r.event),n.findOriginalHeaders(),n}return r&&ee(i.prototype,r),n&&ee(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(t5);function es(t){return(es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ec(n.key),n)}}function ec(t){var e=function(t,e){if("object"!==es(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==es(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===es(e)?e:String(e)}var ef=function(){var t,e;function r(t,e,n,i,a){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),l=this,(s=ec(s="wtSettings"))in l?Object.defineProperty(l,s,{value:null,enumerable:!0,configurable:!0,writable:!0}):l[s]=null,(0,tz.jW)(this,"wot",t,{writable:!1}),this.domBindings=a,this.facadeGetter=e,this.wtSettings=i;var l,s,u=this.wot.wtTable,c=u.TABLE,f=u.hider,h=u.spreader,d=u.holder,y=u.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=c,this.hider=f,this.spreader=h,this.holder=d,this.wtRootElement=y,this.trimmingContainer=(0,o.$g)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return t=[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=(0,o.$g)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var t=this.wot.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,o.dD)(t.TABLE)}},{key:"getRelativeCellPosition",value:function(t,e,r){if(!1===this.clone.wtTable.holder.contains(t)){(0,ti.ZK)("The provided element is not a child of the ".concat(this.type," overlay"));return}var n=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),i=e<this.wtSettings.getSetting("fixedRowsTop"),a=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,s={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(t),top:t.offsetTop};return n?this.getRelativeCellPositionWithinWindow(i,o,u,s):this.getRelativeCellPositionWithinHolder(i,a,o,u,s)}},{key:"getRelativeStartPosition",value:function(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(t,e,r,n){var i=this.wot.wtTable.wtRootElement.getBoundingClientRect(),a=0,l=0;if(e){var s=i.left;this.isRtl()&&(s=this.domBindings.rootWindow.innerWidth-(i.left+i.width+(0,o.np)())),a=s<=0?-1*s:0}else a=n.start;return l=t?this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:n.top,{start:r.start+a,top:r.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(t,e,r,n,o){var i={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},a=0,l=0;if(r||(a=i.horizontal-o.start),e){var s=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+s.top}else t||(l=i.vertical-o.top);return{start:n.start-a,top:n.top-l}}},{key:"makeClone",value:function(){if(-1===tI.indexOf(this.type))throw Error('Clone type "'.concat(this.type,'" is not supported.'));var t=this.wot.wtTable,e=this.domBindings,r=e.rootDocument,n=e.rootWindow,i=r.createElement("DIV"),a=r.createElement("TABLE"),l=t.wtRootElement.parentNode;i.className="".concat(tN.get(this.type)," handsontable"),i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,a.className=t.TABLE.className,i.appendChild(a),l.appendChild(i);var s=this.wtSettings.getSetting("preventOverflow");return!0===s||"horizontal"===s&&"top"===this.type||"vertical"===s&&this.type===tA?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(l).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=(0,o.dD)(t.TABLE),new el(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,r=t.style,n=e.style,o=t.parentNode.style;(0,p.Bk)([r,n,o],function(t){t.width="",t.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}],eu(r.prototype,t),e&&eu(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function eh(t){return(eh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ed(t,e,r){return(ed=ev()?Reflect.construct.bind():function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&ep(o,r.prototype),o}).apply(null,arguments)}function ey(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eb(n.key),n)}}function ep(t,e){return(ep=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function em(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ev(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function eg(t){return(eg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eb(t){var e=function(t,e){if("object"!==eh(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==eh(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===eh(e)?e:String(e)}var ew=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ep(t,e)}(a,t);var e,r,n,i=(e=ev(),function(){var t,r=eg(a);if(e){var n=eg(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===eh(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return em(t)}(this,t)});function a(t,e,r,n){var o,l,s;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),l=em(o=i.call(this,t,e,"top",r,n)),(s=eb(s="cachedFixedRowsTop"))in l?Object.defineProperty(l,s,{value:-1,enumerable:!0,configurable:!0,writable:!0}):l[s]=-1,o.cachedFixedRowsTop=o.wtSettings.getSetting("fixedRowsTop"),o}return r=[{key:"createTable",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return ed(tY,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode,e=this.domBindings.rootWindow,r=this.wtSettings.getSetting("preventOverflow"),n=0,i=!1;this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),(0,o.WH)(t)):(i=Math.ceil(this.wot.wtTable.hider.getBoundingClientRect().bottom)===t.offsetHeight,n=this.getOverlayOffset(),(0,o.I2)(t,"0px","".concat(n,"px")));var a=this.adjustHeaderBordersPosition(n,i);return this.adjustElementsSize(),a}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,r=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo((0,o.DZ)(e),t),r=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,r=!0),r}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var r=this.wtSettings.getSetting("defaultRowHeight"),n=t,o=0;n<e;){var i=this.wot.wtTable.getRowHeight(n);o+=void 0===i?r:i,n+=1}return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable,e=this.domBindings,r=e.rootDocument,n=e.rootWindow,i=(0,o.np)(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===l){var s=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=i),s=Math.min(s,t.wtRootElement.scrollWidth),a.width="".concat(s,"px")}else a.width="";this.clone.wtTable.holder.style.width=a.width;var u=(0,o.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var t,e=this.clone.wtTable.holder,r=this.wot.selections,n=this.facadeGetter(),o=Math.abs(null!==(t=null==r?void 0:r.getCell().getBorder(n).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height="".concat(parseInt(e.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var t=this.isRtl()?"right":"left",e=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):e.style[t]=""}},{key:"scrollTo",value:function(t,e){var r=this.wot,n=this.wtSettings,i=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=this.getTableParentOffset(),l=0;if(e&&this.wot.wtTable.getRowHeight(t)>this.wot.wtViewport.getViewportHeight()&&(e=!1),e&&i.offsetHeight!==i.clientHeight&&(l=(0,o.np)(this.domBindings.rootDocument)),e){var s=n.getSetting("fixedRowsBottom"),u=n.getSetting("totalRows");a+=this.sumCellSizes(0,t+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(u-s,u),a+=1}else a+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return a+=l,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,o.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){var n=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight();(r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>n-o&&(r=0)}return r}},{key:"adjustHeaderBordersPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?(0,o.IV)(r,"emptyColumns"):(0,o.cn)(r,"emptyColumns");var n=!1;if(!e){var i=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==i,l=this.wtSettings.getSetting("columnHeaders");if((a||0===i)&&l.length>0){var s=(0,o.pv)(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?((0,o.cn)(r,"innerBorderTop"),n=!s):((0,o.IV)(r,"innerBorderTop"),n=s)}}return n}}],ey(a.prototype,r),n&&ey(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(ef),eS={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return 0===t||0===e?-1:r<0?0:r},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};function eC(t){return(eC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eO(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==eC(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==eC(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===eC(e)?e:String(e)}(n.key),n)}}function eT(t,e){return(eT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function eR(t){return(eR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(0,tz.jW)(eS,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var eE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eT(t,e)}(i,t);var e,r,n,o=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=eR(i);if(e){var n=eR(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===eC(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e,r,n){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,e,r,n,tx)}return r&&eO(i.prototype,r),n&&eO(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(tF);function ek(t){return(ek="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eP(t,e,r){return(eP=eH()?Reflect.construct.bind():function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&ex(o,r.prototype),o}).apply(null,arguments)}function ej(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eI(n.key),n)}}function ex(t,e){return(ex=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function eA(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eH(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function eM(t){return(eM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eI(t){var e=function(t,e){if("object"!==ek(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ek(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ek(e)?e:String(e)}(0,tz.jB)(eE,eS),(0,tz.jB)(eE,tG);var eN=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ex(t,e)}(a,t);var e,r,n,i=(e=eH(),function(){var t,r=eM(a);if(e){var n=eM(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===ek(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return eA(t)}(this,t)});function a(t,e,r,n){var o,l,s;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),l=eA(o=i.call(this,t,e,tx,r,n)),(s=eI(s="cachedFixedRowsBottom"))in l?Object.defineProperty(l,s,{value:-1,enumerable:!0,configurable:!0,writable:!0}):l[s]=-1,o.cachedFixedRowsBottom=o.wtSettings.getSetting("fixedRowsBottom"),o}return r=[{key:"createTable",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return eP(eE,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var t=this.domBindings.rootWindow,e=this.clone.wtTable.holder.parentNode;e.style.top="";var r=0,n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||n&&"vertical"===n?(r=this.getScrollPosition(),this.repositionOverlay()):(r=this.getOverlayOffset(),e.style.bottom="".concat(r,"px"));var o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,r=t.wtViewport,n=this.domBindings.rootDocument,i=this.clone.wtTable.holder.parentNode,a=0;r.hasVerticalScroll()||(a+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(a+=(0,o.np)(n)),i.style.bottom="".concat(a,"px")}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,r=!1;return this.mainTableScrollableElement===e?(e.scrollTo((0,o.DZ)(e),t),r=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,r=!0),r}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var r=this.wot,n=r.wtTable,o=r.wtSettings.getSetting("defaultRowHeight"),i=t,a=0;i<e;){var l=n.getRowHeight(i);a+=void 0===l?o:l,i+=1}return a}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,r=t.wtViewport,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,l=(0,o.np)(i),s=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||"horizontal"===u){var c=r.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=l),c=Math.min(c,e.wtRootElement.scrollWidth),s.width="".concat(c,"px")}else s.width="";this.clone.wtTable.holder.style.width=s.width;var f=(0,o.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(f=0),s.height="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var t=this.isRtl()?"right":"left",e=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):e.style[t]=""}},{key:"scrollTo",value:function(t,e){var r=this.getTableParentOffset(),n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,i=0;e&&n.offsetHeight!==n.clientHeight&&(i=(0,o.np)(this.domBindings.rootDocument)),e?(r+=this.sumCellSizes(0,t+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),r+=i,this.setScrollPosition(r)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,o.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){var n=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=this.domBindings.rootDocument.documentElement.clientHeight;(r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-i+n,0))>n-o&&(r=0)}return r}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==e,n=this.wtSettings.getSetting("columnHeaders"),i=!1;if((r||0===e)&&n.length>0){var a=this.wot.wtTable.holder.parentNode,l=(0,o.pv)(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?((0,o.cn)(a,"innerBorderBottom"),i=!l):((0,o.IV)(a,"innerBorderBottom"),i=l)}return i}}],ej(a.prototype,r),n&&ej(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(ef),e_={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};(0,tz.jW)(e_,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var eD={getFirstRenderedColumn:function(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};function eL(t){return(eL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eV(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==eL(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==eL(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===eL(e)?e:String(e)}(n.key),n)}}function eB(t,e){return(eB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function eW(t){return(eW=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(0,tz.jW)(eD,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});var eF=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eB(t,e)}(i,t);var e,r,n,o=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=eW(i);if(e){var n=eW(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===eL(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e,r,n){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,e,r,n,tA)}return r&&eV(i.prototype,r),n&&eV(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(tF);function ez(t){return(ez="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eU(t,e,r){return(eU=eq()?Reflect.construct.bind():function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&eK(o,r.prototype),o}).apply(null,arguments)}function eG(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==ez(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ez(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ez(e)?e:String(e)}(n.key),n)}}function eK(t,e){return(eK=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function eq(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function eX(t){return(eX=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(0,tz.jB)(eF,e_),(0,tz.jB)(eF,eD);var e$=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eK(t,e)}(a,t);var e,r,n,i=(e=eq(),function(){var t,r=eX(a);if(e){var n=eX(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===ez(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),i.call(this,t,e,tA,r,n)}return r=[{key:"createTable",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return eU(eF,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var t=this.wot.wtTable;if(!this.needFullRender||!t.holder.parentNode)return!1;var e=this.domBindings.rootWindow,r=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow"),i=0;this.trimmingContainer!==e||n&&"horizontal"===n?(i=this.getScrollPosition(),(0,o.WH)(r)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,o.I2)(r,"".concat(i,"px"),"0px"));var a=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),a}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,r=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,(0,o.AQ)(e)),r=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,r=!0),r}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var r=this.wtSettings.getSetting("defaultColumnWidth"),n=t,o=0;n<e;)o+=this.wot.wtTable.getStretchedColumnWidth(n)||r,n+=1;return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable,e=this.domBindings,r=e.rootDocument,n=e.rootWindow,i=(0,o.np)(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"vertical"===l){var s=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(s-=i),s=Math.min(s,t.wtRootElement.scrollHeight),a.height="".concat(s,"px")}else a.height="";this.clone.wtTable.holder.style.height=a.height;var u=(0,o.iO)(this.clone.wtTable.TABLE);a.width="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var t,e=this.clone.wtTable.holder,r=this.wot.selections,n=this.facadeGetter(),o=Math.abs(null!==(t=null==r?void 0:r.getCell().getBorder(n).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width="".concat(parseInt(e.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(0===t)this.spreader.style[e]="0";else throw Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(t,e){var r=this.getTableParentOffset(),n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,i=0;return e&&this.wot.wtTable.getColumnWidth(t)>this.wot.wtViewport.getViewportWidth()&&(e=!1),e&&n.offsetWidth!==n.clientWidth&&(i=(0,o.np)(this.domBindings.rootDocument)),e?(r+=this.sumCellSizes(0,t+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),r+=i,this.setScrollPosition(r)}},{key:"getTableParentOffset",value:function(){var t=this.wtSettings.getSetting("preventOverflow"),e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return Math.abs((0,o.vj)(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),r=0;return this.trimmingContainer===t&&(!e||"horizontal"!==e)&&(r=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(r=0),r}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),n=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?(0,o.IV)(e,"emptyRows"):(0,o.cn)(e,"emptyRows");var i=!1;if(n&&!r.length)(0,o.cn)(e,"innerBorderLeft innerBorderInlineStart");else if(!n&&r.length){var a=(0,o.pv)(e,"innerBorderInlineStart");t?((0,o.cn)(e,"innerBorderLeft innerBorderInlineStart"),i=!a):((0,o.IV)(e,"innerBorderLeft innerBorderInlineStart"),i=a)}return i}}],eG(a.prototype,r),n&&eG(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(ef);function eY(t){return(eY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eZ(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==eY(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==eY(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===eY(e)?e:String(e)}(n.key),n)}}function eJ(t,e){return(eJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function eQ(t){return(eQ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var e0=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eJ(t,e)}(i,t);var e,r,n,o=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=eQ(i);if(e){var n=eQ(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===eY(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e,r,n){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,e,r,n,tH)}return r&&eZ(i.prototype,r),n&&eZ(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(tF);function e1(t){return(e1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function e2(t,e,r){return(e2=e8()?Reflect.construct.bind():function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&e6(o,r.prototype),o}).apply(null,arguments)}function e9(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,e5(n.key),n)}}function e6(t,e){return(e6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function e3(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function e8(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function e7(t){return(e7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function e4(t,e,r){return(e=e5(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e5(t){var e=function(t,e){if("object"!==e1(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==e1(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===e1(e)?e:String(e)}(0,tz.jB)(e0,tU),(0,tz.jB)(e0,eD);var rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&e6(t,e)}(a,t);var e,r,n,i=(e=e8(),function(){var t,r=e7(a);if(e){var n=e7(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===e1(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return e3(t)}(this,t)});function a(t,e,r,n,o,l){var s;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),e4(e3(s=i.call(this,t,e,tH,r,n)),"topOverlay",void 0),e4(e3(s),"inlineStartOverlay",void 0),s.topOverlay=o,s.inlineStartOverlay=l,s}return r=[{key:"createTable",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return e2(e0,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),r=this.topOverlay.getOverlayOffset();(0,o.I2)(t,"".concat(e,"px"),"".concat(r,"px"))}else(0,o.WH)(t);var n=(0,o.Pb)(this.clone.wtTable.TABLE),i=(0,o.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height="".concat(n,"px"),t.style.width="".concat(i,"px"),!1}}],e9(a.prototype,r),n&&e9(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(ef);function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==re(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==re(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===re(e)?e:String(e)}(n.key),n)}}function rn(t,e){return(rn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ro(t){return(ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ri=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rn(t,e)}(i,t);var e,r,n,o=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=ro(i);if(e){var n=ro(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===re(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e,r,n){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,e,r,n,tM)}return r&&rr(i.prototype,r),n&&rr(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(tF);function ra(t){return(ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rl(t,e,r){return(rl=rc()?Reflect.construct.bind():function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&ru(o,r.prototype),o}).apply(null,arguments)}function rs(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==ra(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ra(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ra(e)?e:String(e)}(n.key),n)}}function ru(t,e){return(ru=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rc(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function rf(t){return(rf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(0,tz.jB)(ri,eS),(0,tz.jB)(ri,eD);var rh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ru(t,e)}(a,t);var e,r,n,i=(e=rc(),function(){var t,r=rf(a);if(e){var n=rf(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===ra(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o,l){var s;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),(s=i.call(this,t,e,tM,r,n)).bottomOverlay=o,s.inlineStartOverlay=l,s}return r=[{key:"createTable",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return rl(ri,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var t=this.wot;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var r=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]="".concat(r,"px"),e.style.bottom="".concat(n,"px")}else(0,o.WH)(e),this.repositionOverlay();var i=(0,o.Pb)(this.clone.wtTable.TABLE),a=(0,o.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),e.style.height="".concat(i,"px"),e.style.width="".concat(a,"px"),!1}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,r=t.wtViewport,n=this.domBindings.rootDocument,i=this.clone.wtTable.holder.parentNode,a=0;r.hasVerticalScroll()||(a+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(a+=(0,o.np)(n)),i.style.bottom="".concat(a,"px")}}],rs(a.prototype,r),n&&rs(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(ef);function rd(t){return(rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ry(t,e,r){return(ry=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&rp(o,r.prototype),o}:Reflect.construct.bind()).apply(null,arguments)}function rp(t,e){return(rp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rm(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rg(n.key),n)}}function rv(t,e,r){return(e=rg(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rg(t){var e=function(t,e){if("object"!==rd(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==rd(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rd(e)?e:String(e)}var rb=function(){var t,e;function r(t,e,n,i,a,l){var u=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),rv(this,"wot",null),rv(this,"topOverlay",null),rv(this,"bottomOverlay",null),rv(this,"inlineStartOverlay",null),rv(this,"topInlineStartCornerOverlay",null),rv(this,"bottomInlineStartCornerOverlay",null),rv(this,"browserLineHeight",void 0),rv(this,"wtSettings",null),rv(this,"resizeObserver",new ResizeObserver(function(t){(0,s.U7)(function(){Array.isArray(t)&&t.length&&u.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=e,this.wtTable=l;var c=this.domBindings,f=c.rootDocument,h=c.rootWindow;this.instance=this.wot,this.eventManager=a,this.scrollbarSize=(0,o.np)(f);var d="hidden"===h.getComputedStyle(l.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=d?l.holder:(0,o.dD)(l.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}return t=[{key:"initBrowserLineHeight",value:function(){var t=this.domBindings,e=t.rootWindow,r=t.rootDocument,n=e.getComputedStyle(r.body),o=parseInt(n.lineHeight,10),i=1.2*parseInt(n.fontSize,10);this.browserLineHeight=o||i}},{key:"initOverlays",value:function(){var t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=ry(ew,t),this.bottomOverlay=ry(eN,t),this.inlineStartOverlay=ry(e$,t),this.topInlineStartCornerOverlay=ry(rt,t.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=ry(rh,t.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var t,e=this,r=this.domBindings,n=r.rootDocument,o=r.rootWindow,i=this.topOverlay.mainTableScrollableElement,a=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",function(t){return e.onKeyDown(t)}),this.eventManager.addEventListener(n.documentElement,"keyup",function(){return e.onKeyUp()}),this.eventManager.addEventListener(n,"visibilitychange",function(){return e.onKeyUp()}),this.eventManager.addEventListener(i,"scroll",function(t){return e.onTableScroll(t)},{passive:!0}),i!==a&&this.eventManager.addEventListener(a,"scroll",function(t){return e.onTableScroll(t)},{passive:!0});var l=o.devicePixelRatio&&o.devicePixelRatio>1,s=this.scrollableElement===o,c=this.wtSettings.getSetting("preventWheel"),f={passive:s};(c||l||!(0,u.i7)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(t){return e.onCloneWheel(t,c)},f),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(function(t){if(t&&t.needFullRender){var r=t.clone.wtTable.holder;e.eventManager.addEventListener(r,"wheel",function(t){return e.onCloneWheel(t,c)},f)}}),this.eventManager.addEventListener(o,"resize",function(){clearTimeout(t),t=setTimeout(function(){e.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(t){var e=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=t.target;(!this.keyPressed||(n===e||o===e||t.target.contains(n))&&(r===e||o===e||t.target.contains(r)))&&this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function(t,e){var r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=t.target,a=o!==r&&i!==r&&!i.contains(o),l=n!==r&&i!==r&&!i.contains(n);if(!this.keyPressed||!a&&!l){var s=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==r&&s)&&t.preventDefault()}}},{key:"onKeyDown",value:function(t){this.keyPressed=(0,m.ot)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,r=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(r+=r*this.browserLineHeight,e+=e*this.browserLineHeight);var n=this.scrollVertically(e),o=this.scrollHorizontally(r);return n||o}},{key:"scrollVertically",value:function(t){var e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(t){var e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var t=this.domBindings.rootWindow,e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,n=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=n[0],i=n[1];if(this.horizontalScrolling=e.scrollLeft!==o||this.lastScrollX!==t.scrollX,this.verticalScrolling=r.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=o;var a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,e=t.scrollLeft,r=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var t=this.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=(0,o.dD)(t.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}},{key:"updateLastSpreaderSize",value:function(){var t=this.wtTable.spreader,e=t.clientWidth,r=t.clientHeight,n=e!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=r),n}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot.wtViewport,r=this.wtTable,n=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),i=e.getRowHeaderWidth(),a=e.getColumnHeaderHeight(),l=r.hider.style;if(l.width="".concat(i+this.inlineStartOverlay.sumCellSizes(0,n),"px"),l.height="".concat(a+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var s=r.wtRootElement,u=s.scrollHeight,c=s.scrollWidth,f=r.holder,h=f.scrollHeight,d=f.scrollWidth;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(t){if(!t)return null;var e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],r=null;return(0,p.Bk)(e,function(e){e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(r=e.clone)}),r}},{key:"syncOverlayTableClassNames",value:function(){var t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,p.Bk)(e,function(e){e&&(e.clone.wtTable.TABLE.className=t.className)})}}],rm(r.prototype,t),e&&rm(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function rw(t){return(rw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rS(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rO(n.key),n)}}function rC(t,e,r){return(e=rO(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rO(t){var e=function(t,e){if("object"!==rw(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==rw(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rw(e)?e:String(e)}var rT=function(){var t,e;function r(t){var e=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),rC(this,"settings",{}),rC(this,"defaults",Object.freeze(this.getDefaults())),(0,tz._l)(this.defaults,function(r,n){if(void 0!==t[n])e.settings[n]=t[n];else if(void 0===r)throw Error('A required setting "'.concat(n,'" was not provided'));else e.settings[n]=r})}return t=[{key:"getDefaults",value:function(){var t=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return t.getSetting("fixedColumnsStart")>0||t.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return t.getSetting("fixedRowsTop")>0||t.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return t.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,r,n){var i=t.getSetting("data",e,r);(0,o.tT)(n,null==i?"":i)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(t){return t},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(t){return t},onBeforeHighlightingColumnHeader:function(t){return t},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(t,e){var r=this;return void 0===e?(0,tz._l)(t,function(t,e){r.settings[e]=t}):this.settings[t]=e,this}},{key:"getSetting",value:function(t,e,r,n,o){return"function"==typeof this.settings[t]?this.settings[t](e,r,n,o):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}},{key:"getSettingPure",value:function(t){return this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}],rS(r.prototype,t),e&&rS(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function rR(t){return(rR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rE(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==rR(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==rR(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rR(e)?e:String(e)}(n.key),n)}}function rk(t,e){return(rk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rP(t){return(rP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rj=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rk(t,e)}(a,t);var e,r,n,i=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=rP(a);if(e){var n=rP(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===rR(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),i.call(this,t,e,r,n,"master")}return r=[{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=(0,o.$g)(this.wtRootElement),e=this.domBindings.rootWindow;if(t===e)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var r=t.parentElement,n=(0,o.C2)(t,"height",e),i=(0,o.C2)(t,"overflow",e),a=this.holder.style,l=t.scrollWidth,s=t.scrollHeight,u=t.getBoundingClientRect(),c=u.width,f=u.height;if(r&&["auto","hidden","scroll"].includes(i)){var h=t.cloneNode(!1);h.style.overflow="auto",h.style.position="absolute",t.nextElementSibling?r.insertBefore(h,t.nextElementSibling):r.appendChild(h);var d=parseInt((0,o.Dx)(h,e).height,10);r.removeChild(h),0===d&&(f=0)}f=Math.min(f,s),a.height="auto"===n?"auto":"".concat(f,"px"),c=Math.min(c,l),a.width="".concat(c,"px"),a.overflow="",this.hasTableHeight="auto"===a.height||f>0,this.hasTableWidth=c>0}this.isTableVisible=(0,o.pn)(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wtSettings,e=this.dataAccessObject.wtViewport,r="master",n=t.getSetting("columnHeaders").length;if(n&&!e.hasOversizedColumnHeadersMarked[r]){for(var o=t.getSetting("rowHeaders").length,i=this.getRenderedColumnsCount(),a=0;a<n;a++)for(var l=-1*o;l<i;l++)this.markIfOversizedColumnHeader(l);e.hasOversizedColumnHeadersMarked[r]=!0}}}],rE(a.prototype,r),n&&rE(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(tF);(0,tz.jB)(rj,e_),(0,tz.jB)(rj,tG);var rx=r(6223),rA=r(1343),rH=r(2792);function rM(t){return(rM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==rM(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==rM(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rM(e)?e:String(e)}(n.key),n)}}var rN=function(){var t,e;function r(t,e,n,o,i){var a=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return t=[{key:"getWorkspaceHeight",value:function(){var t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;return e===this.domBindings.rootWindow?t.documentElement.clientHeight:(0,o.Pb)(e)>0&&e.clientHeight>0?e.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var t,e,r=this.wtSettings,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,l=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,u=r.getSetting("totalColumns"),c=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),h=this.wtTable.TABLE.getBoundingClientRect(),d=f?h.right-s:h.left,y=s-d;if(c)return(0,o.iO)(this.wtTable.wtRootElement);if(t=r.getSetting("freezeOverlays")?Math.min(y,s):Math.min(this.getContainerFillWidth(),y,s),l===a&&u>0&&this.sumColumnWidths(0,u-1)>t)return i.documentElement.clientWidth;if(l!==a&&("scroll"===(e=(0,o.C2)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",a))||"hidden"===e||"auto"===e))return Math.max(t,l.clientWidth);var p=r.getSetting("stretchH");return"none"!==p&&p?t:Math.max(t,(0,o.iO)(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,e){for(var r=0,n=t;n<e;)r+=this.wtTable.getColumnWidth(n),n+=1;return r}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);var r=e.offsetWidth;return this.containerWidth=r,t.removeChild(e),r}},{key:"getWorkspaceOffset",value:function(){return(0,o.cv)(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,o.Pb)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight();if(t===1/0)return t;var e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}},{key:"getRowHeaderWidth",value:function(){var t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var r=0,n=e.length;r<n;r++)this.rowHeaderWidth+=t[r]||t}if(isNaN(this.rowHeaderWidth)){if(e.length){var i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var a=0,l=e.length;a<l;a++)i?(this.rowHeaderWidth+=(0,o.iO)(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth();if(t===1/0)return t;var e=this.getRowHeaderWidth();return e>0?t-e:t}},{key:"createRowsCalculator",value:function(){var t,e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rx.Ii,i=this.wtSettings,a=this.wtTable;this.rowHeaderWidth=NaN,t=i.getSetting("renderAllRows")&&n===rx.Ii?1/0:this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;l<0&&(l=0);var s=i.getSetting("fixedRowsTop"),u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");return s&&(l+=r=this.dataAccessObject.topOverlay.sumCellSizes(0,s),t-=r),u&&this.dataAccessObject.bottomOverlay.clone&&(t-=r=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c)),e=a.holder.clientHeight===a.holder.offsetHeight?0:(0,o.np)(this.domBindings.rootDocument),new rA.Z({viewportSize:t,scrollOffset:l,totalItems:i.getSetting("totalRows"),itemSizeFn:function(t){return a.getRowHeight(t)},overrideFn:i.getSettingPure("viewportRowCalculatorOverride"),calculationType:n,scrollbarHeight:e})}},{key:"createColumnsCalculator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rx.Ii,e=this.wtSettings,r=this.wtTable,n=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,i<0&&(i=0);var a=e.getSetting("fixedColumnsStart");if(a){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);i+=l,n-=l}return r.holder.clientWidth!==r.holder.offsetWidth&&(n-=(0,o.np)(this.domBindings.rootDocument)),new rH.Z({viewportSize:n,scrollOffset:Math.abs(i),totalItems:e.getSetting("totalColumns"),itemSizeFn:function(t){return r.getColumnWidth(t)},overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,stretchMode:e.getSetting("stretchH"),stretchingItemWidthFn:function(t,r){return e.getSetting("onBeforeStretchingColumnWidth",t,r)}})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t;if(e){var r=this.createRowsCalculator(rx.vp),n=this.createColumnsCalculator(rx.vp);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(rx.Ii),this.columnsRenderCalculator=this.createColumnsCalculator(rx.Ii)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(rx.vp),this.columnsVisibleCalculator=this.createColumnsCalculator(rx.vp)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){if(!this.rowsVisibleCalculator)return!1;var e=t.startRow,r=t.endRow;if(null===e&&null===r)return!1;var n=this.rowsRenderCalculator,o=n.startRow,i=n.endRow;return!(e<o)&&(e!==o||!(e>0))&&!(r>i||r===i&&r<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){if(!this.columnsVisibleCalculator)return!1;var e=t.startColumn,r=t.endColumn;if(null===e&&null===r)return!1;var n=this.columnsRenderCalculator,o=n.startColumn,i=n.endColumn;return!(e<o)&&(e!==o||!(e>0))&&!(r>i||r===i&&r<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){(0,tz._l)(this.hasOversizedColumnHeadersMarked,function(t,e,r){r[e]=void 0})}}],rI(r.prototype,t),e&&rI(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function r_(t){return(r_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==r_(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==r_(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r_(e)?e:String(e)}(n.key),n)}}function rL(t,e){return(rL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rV(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rB(t){return(rB=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rW=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rL(t,e)}(i,t);var e,r,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=rB(i);if(e){var n=rB(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===r_(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return rV(t)}(this,t)});function i(t,e){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i);var r,o=(r=n.call(this,t,new rT(e))).wtSettings.getSetting("facade",rV(r));return r.wtTable=new rj(r.getTableDao(),o,r.domBindings,r.wtSettings),r.wtViewport=new rN(r.getViewportDao(),r.domBindings,r.wtSettings,r.eventManager,r.wtTable),r.selections=r.wtSettings.getSetting("selections"),r.wtEvent=new y(o,r.domBindings,r.wtSettings,r.eventManager,r.wtTable,r.selections),r.wtOverlays=new rb(rV(r),o,r.domBindings,r.wtSettings,r.eventManager,r.wtTable),r.exportSettingsAsClassNames(),r.findOriginalHeaders(),r}return rD(i.prototype,[{key:"exportSettingsAsClassNames",value:function(){var t=this,e=[],r=[];(0,tz._l)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},function(n,o){t.wtSettings.getSetting(o).length&&r.push(n),e.push(n)}),(0,o.IV)(this.wtTable.wtRootElement.parentNode,e),(0,o.cn)(this.wtTable.wtRootElement.parentNode,r)}},{key:"getViewportDao",value:function(){var t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}]),r&&rD(i,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(t5);function rF(t){return(rF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rz(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==rF(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==rF(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rF(e)?e:String(e)}(n.key),n)}}var rU=function(){var t,e;function r(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),t instanceof t5?this._wot=t:this._initFromSettings(t)}return t=[{key:"_initFromSettings",value:function(t){t.facade=function(t){var e=new r(t);return function(){return e}},this._wot=new rW(t.table,t)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(t){this._wot.drawn=t}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(t){this._wot.drawInterrupted=t}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(t){this._wot.lastMouseOver=t}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(t){this._wot.momentumScrolling=t}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(t){this._wot.touchApplied=t}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(t){this._wot.eventListeners=t}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(t,e){return this._wot.createCellCoords(t,e)}},{key:"createCellRange",value:function(t,e,r){return this._wot.createCellRange(t,e,r)}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}},{key:"getCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}},{key:"scrollViewport",value:function(t,e,r,n,o){return this._wot.scrollViewport(t,e,r,n,o)}},{key:"scrollViewportHorizontally",value:function(t,e,r){return this._wot.scrollViewportHorizontally(t,e,r)}},{key:"scrollViewportVertically",value:function(t,e,r){return this._wot.scrollViewportVertically(t,e,r)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(t,e){return this._wot.wtSettings.update(t,e),this}},{key:"getSetting",value:function(t,e,r,n,o){return this._wot.wtSettings.getSetting(t,e,r,n,o)}},{key:"hasSetting",value:function(t){return this._wot.wtSettings.hasSetting(t)}},{key:"destroy",value:function(){this._wot.destroy()}}],rz(r.prototype,t),e&&rz(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function rG(t){var e=t.isShiftKey,r=t.isLeftClick,n=t.isRightClick,o=t.coords,i=t.selection,a=t.controller,l=t.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(e&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):c&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),h=r||n&&f;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}var rK=new Map([["mousedown",rG],["mouseover",function(t){var e=t.isLeftClick,r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;if(e){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}],["touchstart",rG]]);function rq(t,e){var r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;rK.get(t.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:t.shiftKey,isLeftClick:(0,a.pW)(t)||"touchstart"===t.type,isRightClick:(0,a.dO)(t)})}var rX=r(6728);function r$(t){return(r$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rY(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||rJ(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rZ(t){return function(t){if(Array.isArray(t))return rQ(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||rJ(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rJ(t,e){if(t){if("string"==typeof t)return rQ(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rQ(t,e)}}function rQ(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function r0(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,r9(n.key),n)}}function r1(t,e,r){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function r2(t,e,r){return(e=r9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r9(t){var e=function(t,e){if("object"!==r$(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==r$(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r$(e)?e:String(e)}function r6(t,e){var r=r8(t,e,"get");return r.get?r.get.call(t):r.value}function r3(t,e,r){var n=r8(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,n,r),r}function r8(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var r7=new WeakMap,r4=new WeakMap,r5=new WeakMap,nt=function(){var t,e;function r(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),r2(this,"instance",void 0),r2(this,"eventManager",void 0),r2(this,"settings",void 0),r2(this,"THEAD",void 0),r2(this,"TBODY",void 0),r2(this,"_wt",void 0),r2(this,"activeWt",void 0),r1(this,r4,{writable:!0,value:0}),r1(this,r5,{writable:!0,value:0}),r2(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new i.Z(this.instance),this.settings=this.instance.getSettings(),r7.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return t=[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}},{key:"getCellAtCoords",value:function(t,e){var r=this._wt.getCell(t,e);return r<0?null:r}},{key:"scrollViewport",value:function(t,e,r,n,o){return this._wt.scrollViewport(t,e,r,n,o)}},{key:"scrollViewportHorizontally",value:function(t,e,r){return this._wt.scrollViewportHorizontally(t,e,r)}},{key:"scrollViewportVertically",value:function(t,e,r){return this._wt.scrollViewportVertically(t,e,r)}},{key:"createElements",value:function(){var t=r7.get(this),e=this.instance,r=e.rootElement,n=e.rootDocument,i=r.getAttribute("style");i&&r.setAttribute("data-originalstyle",i),(0,o.cn)(r,"handsontable"),t.table=n.createElement("TABLE"),(0,o.cn)(t.table,"htCore"),this.instance.getSettings().tableClassName&&(0,o.cn)(t.table,this.instance.getSettings().tableClassName),this.THEAD=n.createElement("THEAD"),t.table.appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),t.table.appendChild(this.TBODY),this.instance.table=t.table,this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var t=this,e=r7.get(this),r=this.instance,n=r.rootElement,i=r.rootDocument,l=r.selection,s=i.documentElement;this.eventManager.addEventListener(n,"mousedown",function(r){if(e.selectionMouseDown=!0,!t.isTextSelectionAllowed(r.target)){var n=t.instance.rootWindow;(0,o.a7)(n),r.preventDefault(),n.focus()}}),this.eventManager.addEventListener(n,"mouseup",function(){e.selectionMouseDown=!1}),this.eventManager.addEventListener(n,"mousemove",function(r){e.selectionMouseDown&&!t.isTextSelectionAllowed(r.target)&&(t.settings.fragmentSelection&&(0,o.a7)(t.instance.rootWindow),r.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(t){l.isInProgress()&&!t.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(r){l.isInProgress()&&(0,a.pW)(r)&&l.finish(),e.mouseDown=!1,!(0,o.pV)(i.activeElement)&&(l.isSelected()||l.isSelectedByAnyHeader()||n.contains(r.target)||(0,a.dO)(r))||t.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(t){l.isInProgress()&&(0,a.dO)(t)&&(l.finish(),e.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),e.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(r){var a=r.target,l=r.x||r.clientX,u=r.y||r.clientY,c=r.target;if(!e.mouseDown&&n&&t.instance.view){var f=t.instance.view._wt.wtTable.holder;if(c===f){var h=(0,o.np)(i);if(i.elementFromPoint(l+h,u)!==f||i.elementFromPoint(l,u+h)!==f)return}else for(;c!==s;){if(null===c){if(r.isTargetWebComponent)break;return}if(c===n)return;c=c.parentNode}("function"==typeof t.settings.outsideClickDeselects?t.settings.outsideClickDeselects(a):t.settings.outsideClickDeselects)?t.instance.deselectCell():t.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(e.table,"selectstart",function(e){t.settings.fragmentSelection||(0,o.u7)(e.target)||e.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(t){var e,r=t.row,n=t.col;return(e=this.instance)._createCellCoords.apply(e,rZ(this.translateFromRenderableToVisualIndex(r,n)))}},{key:"translateFromRenderableToVisualIndex",value:function(t,e){var r=t>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t,n=e>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===r&&(r=t),null===n&&(n=e),[r,n]}},{key:"countRenderableIndexes",value:function(t,e){var r=Math.min(t.getNotTrimmedIndexesLength(),e),n=t.getNearestNotHiddenIndex(r-1,-1);return null===n?0:t.getRenderableFromVisualIndex(n)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(t,e){return this.countNotHiddenIndexes(t,e,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(t,e){return this.countNotHiddenIndexes(t,e,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(t,e,r,n){if(isNaN(t)||t<0)return 0;var o=r.getNearestNotHiddenIndex(t,e),i=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;var a=0;return e<0?a=i+1:e>0&&(a=n-i),a}},{key:"countNotHiddenFixedColumnsStart",value:function(){var t=this.instance.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var t=this.instance.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var t=Math.max(this.instance.countRows()-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>t&&this.instance.countRenderedCols()>e}},{key:"initializeWalkontable",value:function(){var t=this,e=r7.get(this),r={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:function(){return(0,rX._v)(t.instance)},preventOverflow:function(){return t.settings.preventOverflow},preventWheel:function(){return t.settings.preventWheel},stretchH:function(){return t.settings.stretchH},data:function(e,r){var n;return(n=t.instance).getDataAtCell.apply(n,rZ(t.translateFromRenderableToVisualIndex(e,r)))},totalRows:function(){return t.countRenderableRows()},totalColumns:function(){return t.countRenderableColumns()},fixedColumnsStart:function(){return t.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return t.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return t.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return t.settings.fixedColumnsStart>0||r.rowHeaders().length>0},shouldRenderTopOverlay:function(){return t.settings.fixedRowsTop>0||r.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return t.settings.fixedRowsBottom>0},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var e=[];return t.instance.hasRowHeaders()&&e.push(function(e,r){var n=e>=0?t.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e;t.appendRowHeader(n,r)}),t.instance.runHooks("afterGetRowHeaderRenderers",e),r3(t,r5,e.length),e},columnHeaders:function(){var e=[];return t.instance.hasColHeaders()&&e.push(function(e,r){var n=e>=0?t.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;t.appendColHeader(n,r)}),t.instance.runHooks("afterGetColumnHeaderRenderers",e),r3(t,r4,e.length),e},columnWidth:function(e){var r=t.instance.columnIndexMapper.getVisualFromRenderableIndex(e);return t.instance.getColWidth(null===r?e:r)},rowHeight:function(e){var r=t.instance.rowIndexMapper.getVisualFromRenderableIndex(e);return t.instance.getRowHeight(null===r?e:r)},cellRenderer:function(e,r,n){var o=rY(t.translateFromRenderableToVisualIndex(e,r),2),i=o[0],a=o[1],l=t.instance.runHooks("modifyGetCellCoords",i,a),s=i,u=a;if(Array.isArray(l)){var c=rY(l,2);s=c[0],u=c[1]}var f=t.instance.getCellMeta(s,u),h=t.instance.colToProp(u),d=t.instance.getDataAtRowProp(s,h);t.instance.hasHook("beforeValueRender")&&(d=t.instance.runHooks("beforeValueRender",d,f)),t.instance.runHooks("beforeRenderer",n,i,a,h,d,f),t.instance.getCellRenderer(f)(t.instance,n,i,a,h,d,f),t.instance.runHooks("afterRenderer",n,i,a,h,d,f)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onWindowResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onContainerElementResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onCellMouseDown:function(r,n,o,i){var l=t.translateFromRenderableToVisualCoords(n),s={row:!1,column:!1,cell:!1};t.instance.listen(),t.activeWt=i,e.mouseDown=!0,t.instance.runHooks("beforeOnCellMouseDown",r,l,o,s),(0,a.Ty)(r)||(rq(r,{coords:l,selection:t.instance.selection,controller:s,cellCoordsFactory:function(e,r){return t.instance._createCellCoords(e,r)}}),t.instance.runHooks("afterOnCellMouseDown",r,l,o),t.activeWt=t._wt)},onCellContextMenu:function(r,n,o,i){var l=t.translateFromRenderableToVisualCoords(n);t.activeWt=i,e.mouseDown=!1,t.instance.selection.isInProgress()&&t.instance.selection.finish(),t.instance.runHooks("beforeOnCellContextMenu",r,l,o),(0,a.Ty)(r)||(t.instance.runHooks("afterOnCellContextMenu",r,l,o),t.activeWt=t._wt)},onCellMouseOut:function(e,r,n,o){var i=t.translateFromRenderableToVisualCoords(r);t.activeWt=o,t.instance.runHooks("beforeOnCellMouseOut",e,i,n),(0,a.Ty)(e)||(t.instance.runHooks("afterOnCellMouseOut",e,i,n),t.activeWt=t._wt)},onCellMouseOver:function(r,n,o,i){var l=t.translateFromRenderableToVisualCoords(n),s={row:!1,column:!1,cell:!1};t.activeWt=i,t.instance.runHooks("beforeOnCellMouseOver",r,l,o,s),(0,a.Ty)(r)||(e.mouseDown&&rq(r,{coords:l,selection:t.instance.selection,controller:s,cellCoordsFactory:function(e,r){return t.instance._createCellCoords(e,r)}}),t.instance.runHooks("afterOnCellMouseOver",r,l,o),t.activeWt=t._wt)},onCellMouseUp:function(e,r,n,o){var i=t.translateFromRenderableToVisualCoords(r);t.activeWt=o,t.instance.runHooks("beforeOnCellMouseUp",e,i,n),(0,a.Ty)(e)||t.instance.isDestroyed||(t.instance.runHooks("afterOnCellMouseUp",e,i,n),t.activeWt=t._wt)},onCellCornerMouseDown:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:function(e,r){return t.beforeRender(e,r)},onDraw:function(e){return t.afterRender(e)},onScrollVertically:function(){return t.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return t.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return t.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(e,r,n){var o=t.instance.rowIndexMapper,i=o.getVisualFromRenderableIndex(e),a=t.instance.runHooks("beforeHighlightingRowHeader",i,r,n);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onBeforeHighlightingColumnHeader:function(e,r,n){var o=t.instance.columnIndexMapper,i=o.getVisualFromRenderableIndex(e),a=t.instance.runHooks("beforeHighlightingColumnHeader",i,r,n);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onAfterDrawSelection:function(e,r,n){var o,i=rY(t.translateFromRenderableToVisualIndex(e,r),2),a=i[0],l=i[1],s=t.instance.selection.getSelectedRange(),u=s.size();if(u>0){var c=s.peekByIndex((null!=n?n:0)+1-u);o=[c.from.row,c.from.col,c.to.row,c.to.col]}return t.instance.runHooks("afterDrawSelection",a,l,o,n)},onBeforeDrawBorders:function(e,r){var n=rY(e,4),o=n[0],i=n[1],a=n[2],l=n[3],s=[t.instance.rowIndexMapper.getVisualFromRenderableIndex(o),t.instance.columnIndexMapper.getVisualFromRenderableIndex(i),t.instance.rowIndexMapper.getVisualFromRenderableIndex(a),t.instance.columnIndexMapper.getVisualFromRenderableIndex(l)];return t.instance.runHooks("beforeDrawBorders",s,r)},onBeforeTouchScroll:function(){return t.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return t.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(e,r){var n=t.instance.columnIndexMapper.getVisualFromRenderableIndex(r);return t.instance.runHooks("beforeStretchingColumnWidth",e,n)},onModifyRowHeaderWidth:function(e){return t.instance.runHooks("modifyRowHeaderWidth",e)},onModifyGetCellCoords:function(e,r,n){var o=t.instance.rowIndexMapper,i=t.instance.columnIndexMapper,a=r>=0?i.getVisualFromRenderableIndex(r):r,l=e>=0?o.getVisualFromRenderableIndex(e):e,s=t.instance.runHooks("modifyGetCellCoords",l,a,n);if(Array.isArray(s)){var u=rY(s,4),c=u[0],f=u[1],h=u[2],d=u[3];return[c>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1)):c,f>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(f,1)):f,h>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1)):h,d>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(d,-1)):d]}},viewportRowCalculatorOverride:function(e){var r=t.settings.viewportRowRenderingOffset;if("auto"===r&&t.settings.fixedRowsTop&&(r=10),r>0||"auto"===r){var n=t.countRenderableRows(),o=e.startRow,i=e.endRow;if("number"==typeof r)e.startRow=Math.max(o-r,0),e.endRow=Math.min(i+r,n-1);else if("auto"===r){var a=Math.ceil(i/n*12);e.startRow=Math.max(o-a,0),e.endRow=Math.min(i+a,n-1)}}t.instance.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){var r=t.settings.viewportColumnRenderingOffset;if("auto"===r&&t.settings.fixedColumnsStart&&(r=10),r>0||"auto"===r){var n=t.countRenderableColumns(),o=e.startColumn,i=e.endColumn;if("number"==typeof r&&(e.startColumn=Math.max(o-r,0),e.endColumn=Math.min(i+r,n-1)),"auto"===r){var a=Math.ceil(i/n*6);e.startColumn=Math.max(o-a,0),e.endColumn=Math.min(i+a,n-1)}}t.instance.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var e=t.instance.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||e}};this.instance.runHooks("beforeInitWalkontable",r),this._wt=new rU(r),this.activeWt=this._wt;var n=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),i=o.width,l=o.height;this.setLastSize(i,l),this.eventManager.addEventListener(n,"mousedown",function(t){t.target===n&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",function(t){t.target===n&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){t.settings.observeDOMVisibility&&t._wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())})}},{key:"isTextSelectionAllowed",value:function(t){if((0,o.u7)(t))return!0;var e=(0,o.MO)(t,this.instance.view._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&e||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&e||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return r7.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var t,e;return null!==(t=null===(e=this.instance.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&void 0!==t&&t}},{key:"isCellEdited",value:function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()}},{key:"beforeRender",value:function(t,e){t&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,e)}},{key:"afterRender",value:function(t){t&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(t,e){if(e.firstChild){var r=e.firstChild;if(!(0,o.pv)(r,"relative")){(0,o.cS)(e),this.appendRowHeader(t,e);return}this.updateCellHeader(r.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var n=this.instance,i=n.rootDocument,a=n.getRowHeader,l=i.createElement("div"),s=i.createElement("span");l.className="relative",s.className="rowHeader",this.updateCellHeader(s,t,a),l.appendChild(s),e.appendChild(l)}this.instance.runHooks("afterGetRowHeader",t,e)}},{key:"appendColHeader",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){var i=e.firstChild;(0,o.pv)(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),t,r,n):((0,o.cS)(e),this.appendColHeader(t,e,r,n))}else{var a=this.instance.rootDocument,l=a.createElement("div"),s=a.createElement("span");l.className="relative",s.className="colHeader",this.updateCellHeader(s,t,r,n),l.appendChild(s),e.appendChild(l)}this.instance.runHooks("afterGetColHeader",t,e,n)}},{key:"updateCellHeader",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e,a=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&((0,o.pv)(t,"colHeader")?i=a.wtTable.columnFilter.sourceToRendered(e):(0,o.pv)(t,"rowHeader")&&(i=a.wtTable.rowFilter.sourceToRendered(e))),i>-1?(0,o.uS)(t,r(e,n)):((0,o.tT)(t,String.fromCharCode(160)),(0,o.cn)(t,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(t){var e=this._wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}},{key:"maximumVisibleElementHeight",value:function(t){var e=this._wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}},{key:"setLastSize",value:function(t,e){var r=r7.get(this),n=[t,e];r.lastWidth=n[0],r.lastHeight=n[1]}},{key:"getLastSize",value:function(){var t=r7.get(this);return{width:t.lastWidth,height:t.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return r6(this,r4)}},{key:"getRowHeadersCount",value:function(){return r6(this,r5)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}],r0(r.prototype,t),e&&r0(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}()},350:function(t,e,r){"use strict";r.d(e,{d:function(){return Z}}),r(6992),r(1539),r(189),r(8783),r(3948),r(1532),r(1038),r(4553),r(5069),r(1249),r(7327),r(2772),r(6699),r(2023),r(3290),r(6649),r(6078),r(2526),r(1817),r(9653),r(7042),r(3371),r(2165),r(8309),r(4916);var n,o=r(613),i=r(8336),a=r(3895),l=r(1923),s=r(331),u=r(1496),c=r(7099),f=r(4165),h=r(7469),d=new Map([["hiding",s.o],["index",u.n],["linkedPhysicalIndexToValue",c.A],["physicalIndexToValue",f.L],["trimming",h.n]]),y=r(1023);r(8304),r(489),r(2419),r(4747);var p=r(1799),m=r(7772),g=r(5981);function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==b(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==b(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===b(e)?e:String(e)}(n.key),n)}}var S=0,C=function(){var t,e;function r(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.collection=new Map}return t=[{key:"register",value:function(t,e){var r=this;!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",function(){return r.runLocalHooks("change",e)}),S+=1)}},{key:"unregister",value:function(t){var e=this.collection.get(t);(0,p.$K)(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),S-=1)}},{key:"unregisterAll",value:function(){var t=this;this.collection.forEach(function(e,r){return t.unregister(r)}),this.collection.clear()}},{key:"get",value:function(t){return(0,p.o8)(t)?Array.from(this.collection.values()):this.collection.get(t)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(t){this.collection.forEach(function(e){e.remove(t)})}},{key:"insertToEvery",value:function(t,e){this.collection.forEach(function(r){r.insert(t,e)})}},{key:"initEvery",value:function(t){this.collection.forEach(function(e){e.init(t)})}}],w(r.prototype,t),e&&w(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function O(t){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function T(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==O(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==O(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===O(e)?e:String(e)}(n.key),n)}}function R(t,e){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(0,m.jB)(C,g.Z);var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(a,t);var e,r,n,i=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=E(a);if(e){var n=E(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===O(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var r;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this)).mergedValuesCache=[],r.aggregationFunction=t,r.fallbackValue=e,r}return r=[{key:"getMergedValues",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];for(var e=(0,o.Sc)(this.get(),function(t){return t.getValues()}),r=[],n=(0,p.$K)(e[0])&&e[0].length||0,i=0;i<n;i+=1){for(var a=[],l=0;l<this.getLength();l+=1)a.push(e[l][i]);r.push(a)}return(0,o.Sc)(r,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(t,e){var r=this.getMergedValues(e)[t];return(0,p.$K)(r)?r:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}],T(a.prototype,r),n&&T(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(C);function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==P(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==P(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===P(e)?e:String(e)}(n.key),n)}}function x(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}r(4129);var A=new WeakMap,H=function(){var t,e;function r(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,A),A.set(this,{writable:!0,value:[]})}return t=[{key:"subscribe",value:function(t){var e;return this.addLocalHook("change",t),this._write((e=x(this,A,"get")).get?e.get.call(this):e.value),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(t){return t.length>0&&this.runLocalHooks("change",t),this}},{key:"_writeInitialChanges",value:function(t){(function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}})(this,x(this,A,"set"),t)}}],j(r.prototype,t),e&&j(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function M(t,e){for(var r=[],n=0,o=0;n<t.length&&o<e.length;n++,o++)t[n]!==e[o]&&r.push({op:"replace",index:o,oldValue:t[n],newValue:e[o]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;o<t.length;o++)r.push({op:"remove",index:o,oldValue:t[o],newValue:void 0});return r}function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==I(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==I(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===I(e)?e:String(e)}(n.key),n)}}function _(t,e,r){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function D(t,e){var r=V(t,e,"get");return r.get?r.get.call(t):r.value}function L(t,e,r){var n=V(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,n,r),r}function V(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}(0,m.jB)(H,g.Z);var B=new WeakMap,W=new WeakMap,F=new WeakMap,z=new WeakMap,U=new WeakMap,G=function(){var t,e;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.initialIndexValue;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),_(this,B,{writable:!0,value:new Set}),_(this,W,{writable:!0,value:[]}),_(this,F,{writable:!0,value:[]}),_(this,z,{writable:!0,value:!1}),_(this,U,{writable:!0,value:!1}),L(this,U,null!=e&&e)}return t=[{key:"createObserver",value:function(){var t=this,e=new H;return D(this,B).add(e),e.addLocalHook("unsubscribe",function(){D(t,B).delete(e)}),e._writeInitialChanges(M(D(this,W),D(this,F))),e}},{key:"emit",value:function(t){var e=D(this,F);D(this,z)&&D(this,W).length===t.length||(0===t.length?t=Array(e.length).fill(D(this,U)):L(this,W,Array(t.length).fill(D(this,U))),D(this,z)||(L(this,z,!0),e=D(this,W)));var r=M(e,t);D(this,B).forEach(function(t){return t._write(r)}),L(this,F,t)}}],N(r.prototype,t),e&&N(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();function K(t){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t){return function(t){if(Array.isArray(t))return X(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return X(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function $(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==K(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==K(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===K(e)?e:String(e)}(n.key),n)}}var Y=new Set(["getFirstNotHiddenIndex"]),Z=function(){var t,e;function r(){var t=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.indexesSequence=new l.b,this.trimmingMapsCollection=new k(function(t){return t.some(function(t){return!0===t})},!1),this.hidingMapsCollection=new k(function(t){return t.some(function(t){return!0===t})},!1),this.variousMapsCollection=new C,this.hidingChangesObservable=new G({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(e){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(e){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(e){t.runLocalHooks("change",e,t.variousMapsCollection)})}return t=[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(t){if("hiding"!==t)throw Error('Unsupported index map type "'.concat(t,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(t,e,r){return this.registerMap(t,function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!d.has(t))throw Error('The provided map type ("'.concat(t,'") does not exist.'));return new(d.get(t))(e)}(e,r))}},{key:"registerMap",value:function(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error('Map with name "'.concat(t,'" has been already registered.'));e instanceof h.n?this.trimmingMapsCollection.register(t,e):e instanceof s.o?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);var r=this.getNumberOfIndexes();return r>0&&e.init(r),e}},{key:"unregisterMap",value:function(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(t){var e=this.notTrimmedIndexesCache[t];return(0,p.$K)(e)?e:null}},{key:"getPhysicalFromRenderableIndex",value:function(t){var e=this.renderablePhysicalIndexesCache[t];return(0,p.$K)(e)?e:null}},{key:"getVisualFromPhysicalIndex",value:function(t){var e=this.fromPhysicalToVisualIndexesCache.get(t);return(0,p.$K)(e)?e:null}},{key:"getVisualFromRenderableIndex",value:function(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}},{key:"getRenderableFromVisualIndex",value:function(t){var e=this.fromVisualToRenderableIndexesCache.get(t);return(0,p.$K)(e)?e:null}},{key:"getFirstNotHiddenIndex",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t-e;Y.has("getFirstNotHiddenIndex")&&(Y.delete("getFirstNotHiddenIndex"),(0,a.ZK)((0,i.e)(n||(n=Object.freeze(Object.defineProperties(['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next \n                        major release. Please use "getNearestNotHiddenIndex" instead.'],{raw:{value:Object.freeze(['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20\n                        major release. Please use "getNearestNotHiddenIndex" instead.'])}}))))));var l=this.getPhysicalFromVisualIndex(t);return null===l?!0===r&&o!==t-e?this.getFirstNotHiddenIndex(o,-e,!1,o):null:!1===this.isHidden(l)?t:this.getFirstNotHiddenIndex(t+e,e,r,o)}},{key:"getNearestNotHiddenIndex",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;var n=Array.from(this.fromVisualToRenderableIndexesCache.keys()),o=-1;return -1===(o=e>0?n.findIndex(function(e){return e>t}):n.reverse().findIndex(function(e){return e<t}))?r?this.getNearestNotHiddenIndex(t,-e,!1):null:n[o]}},{key:"initToLength",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=q(Array(t).keys()),this.notHiddenIndexesCache=q(Array(t).keys()),this.suspendOperations(),this.indexesSequence.init(t),this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(t){var e=this.getNumberOfIndexes();if(t<e){var r=q(Array(this.getNumberOfIndexes()-t).keys()).map(function(e){return e+t});this.removeIndexes(r)}else this.insertIndexes(e,t-e)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(t){this.indexesSequence.setValues(t)}},{key:"getNotTrimmedIndexes",value:function(){var t=this,e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===e?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(function(e){return!1===t.isTrimmed(e)})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var t=this,e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===e?this.notHiddenIndexesCache:this.getIndexesSequence().filter(function(e){return!1===t.isHidden(e)})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var t=this,e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===e?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(function(e){return!1===t.isHidden(e)})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(t,e){var r=this;"number"==typeof t&&(t=[t]);var n=(0,o.Sc)(t,function(t){return r.getPhysicalFromVisualIndex(t)}),i=this.getNotTrimmedIndexesLength(),a=t.length,l=(0,y.t)(this.getIndexesSequence(),n),s=i-a;if(e+a<i){var u=l.filter(function(t){return!1===r.isTrimmed(t)})[e];s=l.indexOf(u)}this.setIndexesSequence((0,y.S)(l,s,n))}},{key:"isTrimmed",value:function(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}},{key:"isHidden",value:function(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}},{key:"insertIndexes",value:function(t,e){var r=this.getNotTrimmedIndexes()[t],n=(0,p.$K)(r)?r:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),a=(0,o.Sc)(Array(e).fill(n),function(t,e){return t+e});this.suspendOperations(),this.indexesSequence.insert(i,a),this.trimmingMapsCollection.insertToEvery(i,a),this.hidingMapsCollection.insertToEvery(i,a),this.variousMapsCollection.insertToEvery(i,a),this.resumeOperations()}},{key:"removeIndexes",value:function(t){this.suspendOperations(),this.indexesSequence.remove(t),this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}},{key:"updateCache",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var e=0;e<t;e+=1){var r=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(r,e)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var e=0;e<t;e+=1){var r=this.getPhysicalFromRenderableIndex(e),n=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(n,e)}}}],$(r.prototype,t),e&&$(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();(0,m.jB)(Z,g.Z)},331:function(t,e,r){"use strict";r.d(e,{o:function(){return u}}),r(8304),r(489),r(1539),r(2419),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165),r(6992),r(8783),r(3948);var n=r(4165),o=r(613);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==i(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(u,t);var e,r,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=s(u);if(e){var n=s(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,u),n.call(this,t)}return a(u.prototype,[{key:"getHiddenIndexes",value:function(){return(0,o.k$)(this.getValues(),function(t,e,r){return e&&t.push(r),t},[])}}]),r&&a(u,r),Object.defineProperty(u,"prototype",{writable:!1}),u}(n.L)},1496:function(t,e,r){"use strict";r.d(e,{n:function(){return u}}),r(7042),r(6649),r(6078),r(2526),r(1817),r(1539),r(9653),r(2165),r(6992),r(8783),r(3948);var n=r(2226),o=r(7772),i=r(7161),a=r(5981);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==l(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===l(e)?e:String(e)}(n.key),n)}}var u=function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.indexedValues=[],this.initValueOrFn=t}return s(e.prototype,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(t){var e=this.indexedValues;if(t<e.length)return e[t]}},{key:"setValues",value:function(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,i.mf)(this.initValueOrFn)?(0,n.q4)(e-1,function(e){return t.indexedValues.push(t.initValueOrFn(e))}):(0,n.q4)(e-1,function(){return t.indexedValues.push(t.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),t&&s(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();(0,o.jB)(u,a.Z)},1923:function(t,e,r){"use strict";r.d(e,{b:function(){return f}}),r(8304),r(489),r(1539),r(2419),r(4819),r(5003),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165),r(6992),r(8783),r(3948);var n=r(1496),o=r(1023),i=r(3166);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==a(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(h,t);var e,r,n,f=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=c(h);if(e){var n=c(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function h(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,h),f.call(this,function(t){return t})}return r=[{key:"insert",value:function(t,e){var r=(0,i.X)(this.indexedValues,e);this.indexedValues=(0,o.S)(r,t,e),s(c(h.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){var e=(0,o.t)(this.indexedValues,t);this.indexedValues=(0,i.i)(e,t),s(c(h.prototype),"remove",this).call(this,t)}}],l(h.prototype,r),n&&l(h,n),Object.defineProperty(h,"prototype",{writable:!1}),h}(n.n)},7099:function(t,e,r){"use strict";r.d(e,{A:function(){return m}}),r(2222),r(1249),r(6992),r(1539),r(3948),r(6699),r(2023),r(561),r(6649),r(6078),r(2526),r(1817),r(9653),r(8304),r(489),r(2419),r(4819),r(5003),r(2165),r(8783),r(1038),r(7042),r(8309),r(4916);var n=r(1496),o=r(8863),i=r(1023),a=r(3166),l=r(7161);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function h(t,e){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function d(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t){var e=function(t,e){if("object"!==s(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==s(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===s(e)?e:String(e)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(g,t);var e,r,n,m=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=y(g);if(e){var n=y(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return d(t)}(this,t)});function g(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,g);for(var t,e,r,n,o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=d(t=m.call.apply(m,[this].concat(i))),n=[],(r=p(r="orderOfIndexes"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t}return r=[{key:"getValues",value:function(){var t=this;return this.orderOfIndexes.map(function(e){return t.indexedValues[e]})}},{key:"setValues",value:function(t){var e;this.orderOfIndexes=function(t){if(Array.isArray(t))return u(t)}(e=Array(t.length).keys())||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),f(y(g.prototype),"setValues",this).call(this,t)}},{key:"setValueAtIndex",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(r,0,t),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(t){this.orderOfIndexes=(0,i.t)(this.orderOfIndexes,[t]),(0,l.mf)(this.initValueOrFn)?f(y(g.prototype),"setValueAtIndex",this).call(this,t,this.initValueOrFn(t)):f(y(g.prototype),"setValueAtIndex",this).call(this,t,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,f(y(g.prototype),"setDefaultValues",this).call(this,t)}},{key:"insert",value:function(t,e){this.indexedValues=(0,o.S)(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=(0,a.X)(this.orderOfIndexes,e),f(y(g.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=(0,o.t)(this.indexedValues,t),this.orderOfIndexes=(0,i.t)(this.orderOfIndexes,t),this.orderOfIndexes=(0,a.i)(this.orderOfIndexes,t),f(y(g.prototype),"remove",this).call(this,t)}},{key:"getEntries",value:function(){var t=this;return this.orderOfIndexes.map(function(e){return[e,t.getValueAtIndex(e)]})}}],c(g.prototype,r),n&&c(g,n),Object.defineProperty(g,"prototype",{writable:!1}),g}(n.n)},4165:function(t,e,r){"use strict";r.d(e,{L:function(){return c}}),r(8304),r(489),r(1539),r(2419),r(4819),r(5003),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165),r(6992),r(8783),r(3948);var n=r(1496),o=r(8863);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==i(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,t);var e,r,n,c=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=u(f);if(e){var n=u(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function f(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,f),c.apply(this,arguments)}return r=[{key:"insert",value:function(t,e){this.indexedValues=(0,o.S)(this.indexedValues,t,e,this.initValueOrFn),l(u(f.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=(0,o.t)(this.indexedValues,t),l(u(f.prototype),"remove",this).call(this,t)}}],a(f.prototype,r),n&&a(f,n),Object.defineProperty(f,"prototype",{writable:!1}),f}(n.n)},7469:function(t,e,r){"use strict";r.d(e,{n:function(){return u}}),r(8304),r(489),r(1539),r(2419),r(6649),r(6078),r(2526),r(1817),r(9653),r(2165),r(6992),r(8783),r(3948);var n=r(4165),o=r(613);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==i(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===i(e)?e:String(e)}(n.key),n)}}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(u,t);var e,r,n=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=s(u);if(e){var n=s(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,u),n.call(this,t)}return a(u.prototype,[{key:"getTrimmedIndexes",value:function(){return(0,o.k$)(this.getValues(),function(t,e,r){return e&&t.push(r),t},[])}}]),r&&a(u,r),Object.defineProperty(u,"prototype",{writable:!1}),u}(n.L)},3166:function(t,e,r){"use strict";r.d(e,{X:function(){return i},i:function(){return o}}),r(7327),r(1539);var n=r(613);function o(t,e){return(0,n.Sc)(t,function(t){return t-e.filter(function(e){return e<t}).length})}function i(t,e){var r=e[0],o=e.length;return(0,n.Sc)(t,function(t){return t>=r?t+o:t})}},1023:function(t,e,r){"use strict";r.d(e,{S:function(){return a},t:function(){return l}}),r(2222),r(7042),r(6699),r(2023),r(2526),r(1817),r(1539),r(2165),r(6992),r(8783),r(3948),r(1038),r(8309),r(4916);var n=r(613);function o(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e,r){return[].concat(o(t.slice(0,e)),o(r),o(t.slice(e)))}function l(t,e){return(0,n.w7)(t,function(t){return!1===e.includes(t)})}},8863:function(t,e,r){"use strict";r.d(e,{S:function(){return l},t:function(){return s}}),r(2222),r(7042),r(1249),r(6699),r(2023),r(2526),r(1817),r(1539),r(2165),r(6992),r(8783),r(3948),r(1038),r(8309),r(4916);var n=r(7161),o=r(613);function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e,r,o){var a=r.length?r[0]:void 0;return[].concat(i(t.slice(0,a)),i(r.map(function(t,e){return(0,n.mf)(o)?o(t,e):o})),i(void 0===a?[]:t.slice(a)))}function s(t,e){return(0,o.w7)(t,function(t,r){return!1===e.includes(r)})}},8722:function(t,e,r){"use strict";r.d(e,{I:function(){return s}}),r(6992),r(1532),r(1539),r(8783),r(3948),r(9826),r(2526),r(1817),r(2165),r(7042),r(8309),r(1038),r(4916);var n=r(7161);function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(t,e)||i(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var l=function(t){return"The id '".concat(t,"' is already declared in a map.")};function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorIdExists,r=new Map;function s(){return function(t){if(Array.isArray(t))return a(t)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||i(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t){return r.has(t)}return e=(0,n.mf)(e)?e:l,{addItem:function(t,n){if(u(t))throw Error(e(t));r.set(t,n)},clear:function(){r.clear()},getId:function(t){var e=s().find(function(e){var r=o(e,2),n=r[0];return t===r[1]&&n})||[null];return o(e,1)[0]},getItem:function(t){return r.get(t)},getItems:s,hasItem:u,removeItem:function(t){return r.delete(t)}}}},9906:function(t,e,r){"use strict";r.d(e,{BU:function(){return c},bt:function(){return u},vo:function(){return s}}),r(4603),r(4916),r(9714),r(9600),r(1249),r(7941),r(5306),r(1539),r(2222),r(561),r(4723),r(8670),r(5827),r(1038),r(8783),r(7327),r(4553),r(6699),r(2023),r(2526),r(1817),r(2165),r(6992),r(3948),r(7042),r(8309);var n=r(1799);function o(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var a={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},l=RegExp(Object.keys(a).map(function(t){return"(".concat(t,")")}).join("|"),"gi");function s(t){for(var e=t.hasColHeaders(),r=t.hasRowHeaders(),o=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData.apply(t,o),a=i.length,l=a>0?i[0].length:0,s=["<table>","</table>"],u=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],f=r?1:0,h=e?1:0,d=0;d<a;d+=1){for(var y=e&&0===d,p=[],m=0;m<l;m+=1){var g=!y&&r&&0===m,b="";if(y)b="<th>".concat(t.getColHeader(m-f),"</th>");else if(g)b="<th>".concat(t.getRowHeader(d-h),"</th>");else{var w=i[d][m],S=t.getCellMeta(d-h,m-f),C=S.hidden,O=S.rowspan,T=S.colspan;if(!C){var R=[];if(O&&R.push('rowspan="'.concat(O,'"')),T&&R.push('colspan="'.concat(T,'"')),(0,n.xb)(w))b="<td ".concat(R.join(" "),"></td>");else{var E=w.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b="<td ".concat(R.join(" "),">").concat(E,"</td>")}}}p.push(b)}var k=["<tr>"].concat(p,["</tr>"]).join("");y?u.splice(1,0,k):c.splice(-1,0,k)}return s.splice(1,0,u.join(""),c.join("")),s.join("")}function u(t){for(var e=t.length,r=["<table>"],o=0;o<e;o+=1){var i=t[o],a=i.length,l=[];0===o&&r.push("<tbody>");for(var s=0;s<a;s+=1){var u=i[s],c=(0,n.xb)(u)?"":u.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l.push("<td>".concat(c,"</td>"))}r.push.apply(r,["<tr>"].concat(l,["</tr>"])),o+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function c(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n={},i=r.createDocumentFragment(),s=r.createElement("div");i.appendChild(s);var u=t;if("string"==typeof u){var c=u.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(t){var e=t.match(/<td\b[^>]*?>/g)[0],r=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(e).concat(r).concat("</td>")});s.insertAdjacentHTML("afterbegin","".concat(c)),u=s.querySelector("table")}if(u&&"TABLE"===((e=u)&&e.nodeName||"")){var f=s.querySelector('meta[name$="enerator"]'),h=null!==u.querySelector("tbody th"),d=u.querySelector("tr"),y=d?Array.from(d.cells).reduce(function(t,e){return t+e.colSpan},0)-(h?1:0):0,p=u.tFoot&&Array.from(u.tFoot.rows)||[],m=[],g=!1,b=0,w=0;if(u.tHead){var S=Array.from(u.tHead.rows).filter(function(t){var e=null!==t.querySelector("td");return e&&m.push(t),!e});g=(b=S.length)>0,b>1?n.nestedHeaders=Array.from(S).reduce(function(t,e){var r=Array.from(e.cells).reduce(function(t,e,r){if(h&&0===r)return t;var n=e.colSpan,o=e.innerHTML;return t.push(n>1?{label:o,colspan:n}:o),t},[]);return t.push(r),t},[]):g&&(n.colHeaders=Array.from(S[0].children).reduce(function(t,e,r){return h&&0===r||t.push(e.innerHTML),t},[]))}m.length&&(n.fixedRowsTop=m.length),p.length&&(n.fixedRowsBottom=p.length);for(var C=[].concat(m,o(Array.from(u.tBodies).reduce(function(t,e){return t.push.apply(t,o(Array.from(e.rows))),t},[])),o(p)),O=Array(w=C.length),T=0;T<w;T++)O[T]=Array(y);for(var R=[],E=[],k=0;k<w;k++)for(var P=Array.from(C[k].cells),j=P.length,x=0;x<j;x++){var A=P[x],H=A.nodeName,M=A.innerHTML,I=A.rowSpan,N=A.colSpan,_=O[k].findIndex(function(t){return void 0===t});if("TD"===H){if(I>1||N>1){for(var D=k;D<k+I;D++)if(D<w)for(var L=_;L<_+N;L++)O[D][L]=null;var V=A.getAttribute("style");V&&V.includes("mso-ignore:colspan")||R.push({col:_,row:k,rowspan:I,colspan:N})}var B="";B=f&&/excel/gi.test(f.content)?M.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):M.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),O[k][_]=B.replace(l,function(t){return a[t]})}else E.push(M)}return R.length&&(n.mergeCells=R),E.length&&(n.rowHeaders=E),O.length&&(n.data=O),n}}},6728:function(t,e,r){"use strict";r.d(e,{IU:function(){return i},_v:function(){return l},dU:function(){return a},mc:function(){return o}}),r(6992),r(1539),r(8783),r(4129),r(3948),r(2526),r(1817);var n=new WeakMap,o=Symbol("rootInstance");function i(t){n.set(t,!0)}function a(t){return t===o}function l(t){return n.has(t)}},8894:function(t,e,r){"use strict";r.d(e,{Ie:function(){return s},Te:function(){return l},oh:function(){return a}});var n=(0,r(5872).Z)("validators"),o=n.register,i=n.getItem,a=n.hasItem;function l(t){if("function"==typeof t)return t;if(!a(t))throw Error('No registered validator found under "'.concat(t,'" name'));return i(t)}function s(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),o(t,e)}n.getNames,n.getValues}}]);