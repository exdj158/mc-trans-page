(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[950],{1285:function(e,t,n){"use strict";var r=n(7908),o=n(1400),i=n(6244);e.exports=function(e){for(var t=r(this),n=i(t),a=arguments.length,l=o(a>1?arguments[1]:void 0,n),s=a>2?arguments[2]:void 0,u=void 0===s?n:o(s,n);u>l;)t[l++]=e;return t}},6583:function(e,t,n){"use strict";var r=n(2104),o=n(5656),i=n(9303),a=n(6244),l=n(9341),s=Math.min,u=[].lastIndexOf,c=!!u&&1/[1].lastIndexOf(1,-0)<0,f=l("lastIndexOf");e.exports=c||!f?function(e){if(c)return r(u,this,arguments)||0;var t=o(this),n=a(t),l=n-1;for(arguments.length>1&&(l=s(l,i(arguments[1]))),l<0&&(l=n+l);l>=0;l--)if(l in t&&t[l]===e)return l||0;return -1}:u},3671:function(e,t,n){var r=n(9662),o=n(7908),i=n(8361),a=n(6244),l=TypeError,s=function(e){return function(t,n,s,u){r(n);var c=o(t),f=i(c),h=a(c),d=e?h-1:0,p=e?-1:1;if(s<2)for(;;){if(d in f){u=f[d],d+=p;break}if(d+=p,e?d<0:h<=d)throw l("Reduce of empty array with no initial value")}for(;e?d>=0:h>d;d+=p)d in f&&(u=n(u,f[d],d,c));return u}};e.exports={left:s(!1),right:s(!0)}},3658:function(e,t,n){"use strict";var r=n(9781),o=n(3157),i=TypeError,a=Object.getOwnPropertyDescriptor,l=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=l?function(e,t){if(o(e)&&!a(e,"length").writable)throw i("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},4362:function(e,t,n){var r=n(1589),o=Math.floor,i=function(e,t){var n=e.length,s=o(n/2);return n<8?a(e,t):l(e,i(r(e,0,s),t),i(r(e,s),t),t)},a=function(e,t){for(var n,r,o=e.length,i=1;i<o;){for(r=i,n=e[i];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==i++&&(e[r]=n)}return e},l=function(e,t,n,r){for(var o=t.length,i=n.length,a=0,l=0;a<o||l<i;)e[a+l]=a<o&&l<i?0>=r(t[a],n[l])?t[a++]:n[l++]:a<o?t[a++]:n[l++];return e};e.exports=i},9320:function(e,t,n){"use strict";var r=n(1702),o=n(9190),i=n(2423).getWeakData,a=n(5787),l=n(9670),s=n(8554),u=n(111),c=n(408),f=n(2092),h=n(7409),d=n(9909),p=d.set,y=d.getterFor,g=f.find,m=f.findIndex,b=r([].splice),w=0,S=function(e){return e.frozen||(e.frozen=new C)},C=function(){this.entries=[]},O=function(e,t){return g(e.entries,function(e){return e[0]===t})};C.prototype={get:function(e){var t=O(this,e);if(t)return t[1]},has:function(e){return!!O(this,e)},set:function(e,t){var n=O(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=m(this.entries,function(t){return t[0]===e});return~t&&b(this.entries,t,1),!!~t}},e.exports={getConstructor:function(e,t,n,r){var f=e(function(e,o){a(e,d),p(e,{type:t,id:w++,frozen:void 0}),s(o)||c(o,e[r],{that:e,AS_ENTRIES:n})}),d=f.prototype,g=y(t),m=function(e,t,n){var r=g(e),o=i(l(t),!0);return!0===o?S(r).set(t,n):o[r.id]=n,e};return o(d,{delete:function(e){var t=g(this);if(!u(e))return!1;var n=i(e);return!0===n?S(t).delete(e):n&&h(n,t.id)&&delete n[t.id]},has:function(e){var t=g(this);if(!u(e))return!1;var n=i(e);return!0===n?S(t).has(e):n&&h(n,t.id)}}),o(d,n?{get:function(e){var t=g(this);if(u(e)){var n=i(e);return!0===n?S(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return m(this,e,t)}}:{add:function(e){return m(this,e,!0)}}),f}}},5117:function(e,t,n){"use strict";var r=n(6330),o=TypeError;e.exports=function(e,t){if(!delete e[t])throw o("Cannot delete property "+r(t)+" of "+r(e))}},8886:function(e,t,n){var r=n(8113).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},256:function(e,t,n){var r=n(8113);e.exports=/MSIE|Trident/.test(r)},6833:function(e,t,n){var r=n(8113);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},5268:function(e,t,n){var r=n(4326),o=n(7854);e.exports="process"==r(o.process)},8008:function(e,t,n){var r=n(8113).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},7065:function(e,t,n){"use strict";var r=n(1702),o=n(9662),i=n(111),a=n(7409),l=n(206),s=n(4374),u=Function,c=r([].concat),f=r([].join),h={},d=function(e,t,n){if(!a(h,t)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";h[t]=u("C,a","return new C("+f(r,",")+")")}return h[t](e,n)};e.exports=s?u.bind:function(e){var t=o(this),n=t.prototype,r=l(arguments,1),a=function(){var n=c(r,l(arguments));return this instanceof a?d(t,n.length,n):t.apply(e,n)};return i(n)&&(a.prototype=n),a}},5032:function(e,t,n){var r=n(7409);e.exports=function(e){return void 0!==e&&(r(e,"value")||r(e,"writable"))}},1574:function(e,t,n){"use strict";var r=n(9781),o=n(1702),i=n(6916),a=n(7293),l=n(1956),s=n(5181),u=n(5296),c=n(7908),f=n(8361),h=Object.assign,d=Object.defineProperty,p=o([].concat);e.exports=!h||a(function(){if(r&&1!==h({b:1},h(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach(function(e){t[e]=e}),7!=h({},e)[n]||l(h({},t)).join("")!=o})?function(e,t){for(var n=c(e),o=arguments.length,a=1,h=s.f,d=u.f;o>a;)for(var y,g=f(arguments[a++]),m=h?p(l(g),h(g)):l(g),b=m.length,w=0;b>w;)y=m[w++],(!r||i(d,g,y))&&(n[y]=g[y]);return n}:h},4699:function(e,t,n){var r=n(9781),o=n(1702),i=n(1956),a=n(5656),l=o(n(5296).f),s=o([].push),u=function(e){return function(t){for(var n,o=a(t),u=i(o),c=u.length,f=0,h=[];c>f;)n=u[f++],(!r||l(o,n))&&s(h,e?[n,o[n]]:o[n]);return h}};e.exports={entries:u(!0),values:u(!1)}},2626:function(e,t,n){var r=n(3070).f;e.exports=function(e,t,n){n in e||r(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})}},7152:function(e,t,n){var r=n(7854),o=n(2104),i=n(614),a=n(8113),l=n(206),s=n(8053),u=/MSIE .\./.test(a),c=r.Function,f=function(e){return u?function(t,n){var r=s(arguments.length,1)>2,a=i(t)?t:c(t),u=r?l(arguments,2):void 0;return e(r?function(){o(a,this,u)}:a,n)}:e};e.exports={setTimeout:f(r.setTimeout),setInterval:f(r.setInterval)}},261:function(e,t,n){var r,o,i,a,l=n(7854),s=n(2104),u=n(9974),c=n(614),f=n(7409),h=n(7293),d=n(490),p=n(206),y=n(317),g=n(8053),m=n(6833),b=n(5268),w=l.setImmediate,S=l.clearImmediate,C=l.process,O=l.Dispatch,R=l.Function,T=l.MessageChannel,k=l.String,E=0,x={},A="onreadystatechange";try{r=l.location}catch(P){}var H=function(e){if(f(x,e)){var t=x[e];delete x[e],t()}},M=function(e){return function(){H(e)}},j=function(e){H(e.data)},I=function(e){l.postMessage(k(e),r.protocol+"//"+r.host)};w&&S||(w=function(e){g(arguments.length,1);var t=c(e)?e:R(e),n=p(arguments,1);return x[++E]=function(){s(t,void 0,n)},o(E),E},S=function(e){delete x[e]},b?o=function(e){C.nextTick(M(e))}:O&&O.now?o=function(e){O.now(M(e))}:T&&!m?(a=(i=new T).port2,i.port1.onmessage=j,o=u(a.postMessage,a)):l.addEventListener&&c(l.postMessage)&&!l.importScripts&&r&&"file:"!==r.protocol&&!h(I)?(o=I,l.addEventListener("message",j,!1)):o=A in y("script")?function(e){d.appendChild(y("script"))[A]=function(){d.removeChild(this),H(e)}}:function(e){setTimeout(M(e),0)}),e.exports={set:w,clear:S}},8053:function(e){var t=TypeError;e.exports=function(e,n){if(e<n)throw t("Not enough arguments");return e}},3290:function(e,t,n){var r=n(2109),o=n(1285),i=n(1223);r({target:"Array",proto:!0},{fill:o}),i("fill")},4553:function(e,t,n){"use strict";var r=n(2109),o=n(2092).findIndex,i=n(1223),a="findIndex",l=!0;a in[]&&[,][a](function(){l=!1}),r({target:"Array",proto:!0,forced:l},{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i(a)},9826:function(e,t,n){"use strict";var r=n(2109),o=n(2092).find,i=n(1223),a="find",l=!0;a in[]&&[,][a](function(){l=!1}),r({target:"Array",proto:!0,forced:l},{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i(a)},9600:function(e,t,n){"use strict";var r=n(2109),o=n(1702),i=n(8361),a=n(5656),l=n(9341),s=o([].join),u=i!=Object,c=l("join",",");r({target:"Array",proto:!0,forced:u||!c},{join:function(e){return s(a(this),void 0===e?",":e)}})},8670:function(e,t,n){var r=n(2109),o=n(6583);r({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},1249:function(e,t,n){"use strict";var r=n(2109),o=n(2092).map;r({target:"Array",proto:!0,forced:!n(1194)("map")},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},5827:function(e,t,n){"use strict";var r=n(2109),o=n(3671).left,i=n(9341),a=n(7392),l=n(5268);r({target:"Array",proto:!0,forced:!i("reduce")||!l&&a>79&&a<83},{reduce:function(e){var t=arguments.length;return o(this,e,t,t>1?arguments[1]:void 0)}})},5069:function(e,t,n){"use strict";var r=n(2109),o=n(1702),i=n(3157),a=o([].reverse),l=[1,2];r({target:"Array",proto:!0,forced:String(l)===String(l.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),a(this)}})},2707:function(e,t,n){"use strict";var r=n(2109),o=n(1702),i=n(9662),a=n(7908),l=n(6244),s=n(5117),u=n(1340),c=n(7293),f=n(4362),h=n(9341),d=n(8886),p=n(256),y=n(7392),g=n(8008),m=[],b=o(m.sort),w=o(m.push),S=c(function(){m.sort(void 0)}),C=c(function(){m.sort(null)}),O=h("sort"),R=!c(function(){if(y)return y<70;if(!d||!(d>3)){if(p)return!0;if(g)return g<603;var e,t,n,r,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)m.push({k:t+r,v:n})}for(m.sort(function(e,t){return t.v-e.v}),r=0;r<m.length;r++)t=m[r].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}});r({target:"Array",proto:!0,forced:S||!C||!O||!R},{sort:function(e){void 0!==e&&i(e);var t,n,r=a(this);if(R)return void 0===e?b(r):b(r,e);var o=[],c=l(r);for(n=0;n<c;n++)n in r&&w(o,r[n]);for(f(o,function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:u(t)>u(n)?1:-1}),t=l(o),n=0;n<t;)r[n]=o[n++];for(;n<c;)s(r,n++);return r}})},561:function(e,t,n){"use strict";var r=n(2109),o=n(7908),i=n(1400),a=n(9303),l=n(6244),s=n(3658),u=n(7207),c=n(5417),f=n(6135),h=n(5117),d=n(1194)("splice"),p=Math.max,y=Math.min;r({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var n,r,d,g,m,b,w=o(this),S=l(w),C=i(e,S),O=arguments.length;for(0===O?n=r=0:1===O?(n=0,r=S-C):(n=O-2,r=y(p(a(t),0),S-C)),u(S+n-r),d=c(w,r),g=0;g<r;g++)(m=C+g)in w&&f(d,g,w[m]);if(d.length=r,n<r){for(g=C;g<S-r;g++)m=g+r,b=g+n,m in w?w[b]=w[m]:h(w,b);for(g=S;g>S-r+n;g--)h(w,g-1)}else if(n>r)for(g=S-r;g>C;g--)m=g+r-1,b=g+n-1,m in w?w[b]=w[m]:h(w,b);for(g=0;g<n;g++)w[g+C]=arguments[g+2];return s(w,S-r+n),d}})},9601:function(e,t,n){var r=n(2109),o=n(1574);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},5003:function(e,t,n){var r=n(2109),o=n(7293),i=n(5656),a=n(1236).f,l=n(9781),s=o(function(){a(1)});r({target:"Object",stat:!0,forced:!l||s,sham:!l},{getOwnPropertyDescriptor:function(e,t){return a(i(e),t)}})},9337:function(e,t,n){var r=n(2109),o=n(9781),i=n(3887),a=n(5656),l=n(1236),s=n(6135);r({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(e){for(var t,n,r=a(e),o=l.f,u=i(r),c={},f=0;u.length>f;)void 0!==(n=o(r,t=u[f++]))&&s(c,t,n);return c}})},489:function(e,t,n){var r=n(2109),o=n(7293),i=n(7908),a=n(9518),l=n(8544);r({target:"Object",stat:!0,forced:o(function(){a(1)}),sham:!l},{getPrototypeOf:function(e){return a(i(e))}})},7941:function(e,t,n){var r=n(2109),o=n(7908),i=n(1956);r({target:"Object",stat:!0,forced:n(7293)(function(){i(1)})},{keys:function(e){return i(o(e))}})},8304:function(e,t,n){n(2109)({target:"Object",stat:!0},{setPrototypeOf:n(7674)})},2479:function(e,t,n){var r=n(2109),o=n(4699).values;r({target:"Object",stat:!0},{values:function(e){return o(e)}})},2419:function(e,t,n){var r=n(2109),o=n(5005),i=n(2104),a=n(7065),l=n(8873),s=n(9670),u=n(111),c=n(30),f=n(7293),h=o("Reflect","construct"),d=Object.prototype,p=[].push,y=f(function(){function e(){}return!(h(function(){},[],e) instanceof e)}),g=!f(function(){h(function(){})}),m=y||g;r({target:"Reflect",stat:!0,forced:m,sham:m},{construct:function(e,t){l(e),s(t);var n=arguments.length<3?e:l(arguments[2]);if(g&&!y)return h(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return i(p,r,t),new(i(a,e,r))}var o=n.prototype,f=c(u(o)?o:d),m=i(e,f,t);return u(m)?m:f}})},4819:function(e,t,n){var r=n(2109),o=n(6916),i=n(111),a=n(9670),l=n(5032),s=n(1236),u=n(9518);r({target:"Reflect",stat:!0},{get:function e(t,n){var r,c,f=arguments.length<3?t:arguments[2];return a(t)===f?t[n]:(r=s.f(t,n))?l(r)?r.value:void 0===r.get?void 0:o(r.get,f):i(c=u(t))?e(c,n,f):void 0}})},4603:function(e,t,n){var r=n(9781),o=n(7854),i=n(1702),a=n(4705),l=n(9587),s=n(8880),u=n(8006).f,c=n(7976),f=n(7850),h=n(1340),d=n(4706),p=n(2999),y=n(2626),g=n(8052),m=n(7293),b=n(7409),w=n(9909).enforce,S=n(6340),C=n(5112),O=n(9441),R=n(7168),T=C("match"),k=o.RegExp,E=k.prototype,x=o.SyntaxError,A=i(E.exec),P=i("".charAt),H=i("".replace),M=i("".indexOf),j=i("".slice),I=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,N=/a/g,_=/a/g,D=new k(N)!==N,V=p.MISSED_STICKY,L=p.UNSUPPORTED_Y,B=r&&(!D||V||O||R||m(function(){return _[T]=!1,k(N)!=N||k(_)==_||"/a/i"!=k(N,"i")})),W=function(e){for(var t,n=e.length,r=0,o="",i=!1;r<=n;r++){if("\\"===(t=P(e,r))){o+=t+P(e,++r);continue}i||"."!==t?("["===t?i=!0:"]"===t&&(i=!1),o+=t):o+="[\\s\\S]"}return o},F=function(e){for(var t,n=e.length,r=0,o="",i=[],a={},l=!1,s=!1,u=0,c="";r<=n;r++){if("\\"===(t=P(e,r)))t+=P(e,++r);else if("]"===t)l=!1;else if(!l)switch(!0){case"["===t:l=!0;break;case"("===t:A(I,j(e,r+1))&&(r+=2,s=!0),o+=t,u++;continue;case">"===t&&s:if(""===c||b(a,c))throw new x("Invalid capture group name");a[c]=!0,i[i.length]=[c,u],s=!1,c="";continue}s?c+=t:o+=t}return[o,i]};if(a("RegExp",B)){for(var z=function(e,t){var n,r,o,i,a,u,p=c(E,this),y=f(e),g=void 0===t,m=[],b=e;if(!p&&y&&g&&e.constructor===z)return e;if((y||c(E,e))&&(e=e.source,g&&(t=d(b))),e=void 0===e?"":h(e),t=void 0===t?"":h(t),b=e,O&&("dotAll"in N)&&(r=!!t&&M(t,"s")>-1)&&(t=H(t,/s/g,"")),n=t,V&&("sticky"in N)&&(o=!!t&&M(t,"y")>-1)&&L&&(t=H(t,/y/g,"")),R&&(e=(i=F(e))[0],m=i[1]),a=l(k(e,t),p?this:E,z),(r||o||m.length)&&(u=w(a),r&&(u.dotAll=!0,u.raw=z(W(e),n)),o&&(u.sticky=!0),m.length&&(u.groups=m)),e!==b)try{s(a,"source",""===b?"(?:)":b)}catch(S){}return a},U=u(k),G=0;U.length>G;)y(z,k,U[G++]);E.constructor=z,z.prototype=E,g(o,"RegExp",z,{constructor:!0})}S("RegExp")},4723:function(e,t,n){"use strict";var r=n(6916),o=n(7007),i=n(9670),a=n(8554),l=n(7466),s=n(1340),u=n(4488),c=n(8173),f=n(1530),h=n(7651);o("match",function(e,t,n){return[function(t){var n=u(this),o=a(t)?void 0:c(t,e);return o?r(o,t,n):RegExp(t)[e](s(n))},function(e){var r,o=i(this),a=s(e),u=n(t,o,a);if(u.done)return u.value;if(!o.global)return h(o,a);var c=o.unicode;o.lastIndex=0;for(var d=[],p=0;null!==(r=h(o,a));){var y=s(r[0]);d[p]=y,""===y&&(o.lastIndex=f(a,l(o.lastIndex),c)),p++}return 0===p?null:d}]})},6755:function(e,t,n){"use strict";var r,o=n(2109),i=n(1702),a=n(1236).f,l=n(7466),s=n(1340),u=n(3929),c=n(4488),f=n(4964),h=n(1913),d=i("".startsWith),p=i("".slice),y=Math.min,g=f("startsWith");o({target:"String",proto:!0,forced:!(!h&&!g&&(r=a(String.prototype,"startsWith"))&&!r.writable)&&!g},{startsWith:function(e){var t=s(c(this));u(e);var n=l(y(arguments.length>1?arguments[1]:void 0,t.length)),r=s(e);return d?d(t,r,n):p(t,n,n+r.length)===r}})},1202:function(e,t,n){"use strict";var r,o=n(7854),i=n(1702),a=n(9190),l=n(2423),s=n(7710),u=n(9320),c=n(111),f=n(2050),h=n(9909).enforce,d=n(4811),p=!o.ActiveXObject&&"ActiveXObject"in o,y=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},g=s("WeakMap",y,u);if(d&&p){r=u.getConstructor(y,"WeakMap",!0),l.enable();var m=g.prototype,b=i(m.delete),w=i(m.has),S=i(m.get),C=i(m.set);a(m,{delete:function(e){if(c(e)&&!f(e)){var t=h(this);return t.frozen||(t.frozen=new r),b(this,e)||t.frozen.delete(e)}return b(this,e)},has:function(e){if(c(e)&&!f(e)){var t=h(this);return t.frozen||(t.frozen=new r),w(this,e)||t.frozen.has(e)}return w(this,e)},get:function(e){if(c(e)&&!f(e)){var t=h(this);return t.frozen||(t.frozen=new r),w(this,e)?S(this,e):t.frozen.get(e)}return S(this,e)},set:function(e,t){if(c(e)&&!f(e)){var n=h(this);n.frozen||(n.frozen=new r),w(this,e)?C(this,e,t):n.frozen.set(e,t)}else C(this,e,t);return this}})}},4129:function(e,t,n){n(1202)},1091:function(e,t,n){var r=n(2109),o=n(7854),i=n(261).clear;r({global:!0,bind:!0,enumerable:!0,forced:o.clearImmediate!==i},{clearImmediate:i})},4633:function(e,t,n){n(1091),n(2986)},2986:function(e,t,n){var r=n(2109),o=n(7854),i=n(261).set;r({global:!0,bind:!0,enumerable:!0,forced:o.setImmediate!==i},{setImmediate:i})},6815:function(e,t,n){var r=n(2109),o=n(7854),i=n(7152).setInterval;r({global:!0,bind:!0,forced:o.setInterval!==i},{setInterval:i})},8417:function(e,t,n){var r=n(2109),o=n(7854),i=n(7152).setTimeout;r({global:!0,bind:!0,forced:o.setTimeout!==i},{setTimeout:i})},2564:function(e,t,n){n(6815),n(8417)},7856:function(e){var t;t=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,n){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,n)}function n(e,r,o){return(n=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,n,r){var o=[null];o.push.apply(o,n);var i=new(Function.bind.apply(e,o));return r&&t(i,r.prototype),i}:Reflect.construct).apply(null,arguments)}function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i,a=Object.hasOwnProperty,l=Object.setPrototypeOf,s=Object.isFrozen,u=Object.getPrototypeOf,c=Object.getOwnPropertyDescriptor,f=Object.freeze,h=Object.seal,d=Object.create,p="undefined"!=typeof Reflect&&Reflect,y=p.apply,g=p.construct;y||(y=function(e,t,n){return e.apply(t,n)}),f||(f=function(e){return e}),h||(h=function(e){return e}),g||(g=function(e,t){return n(e,r(t))});var m=x(Array.prototype.forEach),b=x(Array.prototype.pop),w=x(Array.prototype.push),S=x(String.prototype.toLowerCase),C=x(String.prototype.match),O=x(String.prototype.replace),R=x(String.prototype.indexOf),T=x(String.prototype.trim),k=x(RegExp.prototype.test),E=(i=TypeError,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return g(i,t)});function x(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return y(e,t,r)}}function A(e,t,n){n=n||S,l&&l(e,null);for(var r=t.length;r--;){var o=t[r];if("string"==typeof o){var i=n(o);i!==o&&(s(t)||(t[r]=i),o=i)}e[o]=!0}return e}function P(e){var t,n=d(null);for(t in e)y(a,e,[t])&&(n[t]=e[t]);return n}function H(e,t){for(;null!==e;){var n=c(e,t);if(n){if(n.get)return x(n.get);if("function"==typeof n.value)return x(n.value)}e=u(e)}return function(e){return console.warn("fallback value for",e),null}}var M=f(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),j=f(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),I=f(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),N=f(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_=f(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),D=f(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),V=f(["#text"]),L=f(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),B=f(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),W=f(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),F=f(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=h(/\{\{[\w\W]*|[\w\W]*\}\}/gm),U=h(/<%[\w\W]*|[\w\W]*%>/gm),G=h(/^data-[\-\w.\u00B7-\uFFFF]/),K=h(/^aria-[\-\w]+$/),q=h(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$=h(/^(?:\w+script|data):/i),X=h(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Y=h(/^html$/i),Z=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var r=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(a){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};return function t(){var n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,a=function(e){return t(e)};if(a.version="2.4.0",a.removed=[],!i||!i.document||9!==i.document.nodeType)return a.isSupported=!1,a;var l=i.document,s=i.document,u=i.DocumentFragment,c=i.HTMLTemplateElement,h=i.Node,d=i.Element,p=i.NodeFilter,y=i.NamedNodeMap,g=void 0===y?i.NamedNodeMap||i.MozNamedAttrMap:y,x=i.HTMLFormElement,J=i.DOMParser,Q=i.trustedTypes,ee=d.prototype,et=H(ee,"cloneNode"),en=H(ee,"nextSibling"),er=H(ee,"childNodes"),eo=H(ee,"parentNode");if("function"==typeof c){var ei=s.createElement("template");ei.content&&ei.content.ownerDocument&&(s=ei.content.ownerDocument)}var ea=Z(Q,l),el=ea?ea.createHTML(""):"",es=s,eu=es.implementation,ec=es.createNodeIterator,ef=es.createDocumentFragment,eh=es.getElementsByTagName,ed=l.importNode,ep={};try{ep=P(s).documentMode?s.documentMode:{}}catch(ey){}var ev={};a.isSupported="function"==typeof eo&&eu&&void 0!==eu.createHTMLDocument&&9!==ep;var eg=q,em=null,eb=A({},[].concat(r(M),r(j),r(I),r(_),r(V))),ew=null,eS=A({},[].concat(r(L),r(B),r(W),r(F))),eC=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),eO=null,eR=null,eT=!0,ek=!0,eE=!1,ex=!1,eA=!1,eP=!1,eH=!1,eM=!1,ej=!1,eI=!1,eN=!0,e_=!1,eD=!0,eV=!1,eL={},eB=null,eW=A({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),eF=null,ez=A({},["audio","video","img","source","image","track"]),eU=null,eG=A({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),eK="http://www.w3.org/1998/Math/MathML",eq="http://www.w3.org/2000/svg",e$="http://www.w3.org/1999/xhtml",eX=e$,eY=!1,eZ=["application/xhtml+xml","text/html"],eJ=null,eQ=s.createElement("form"),e0=function(e){return e instanceof RegExp||e instanceof Function},e1=function(t){eJ&&eJ===t||(t&&"object"===e(t)||(t={}),t=P(t),o="application/xhtml+xml"===(n=n=-1===eZ.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE)?function(e){return e}:S,em="ALLOWED_TAGS"in t?A({},t.ALLOWED_TAGS,o):eb,ew="ALLOWED_ATTR"in t?A({},t.ALLOWED_ATTR,o):eS,eU="ADD_URI_SAFE_ATTR"in t?A(P(eG),t.ADD_URI_SAFE_ATTR,o):eG,eF="ADD_DATA_URI_TAGS"in t?A(P(ez),t.ADD_DATA_URI_TAGS,o):ez,eB="FORBID_CONTENTS"in t?A({},t.FORBID_CONTENTS,o):eW,eO="FORBID_TAGS"in t?A({},t.FORBID_TAGS,o):{},eR="FORBID_ATTR"in t?A({},t.FORBID_ATTR,o):{},eL="USE_PROFILES"in t&&t.USE_PROFILES,eT=!1!==t.ALLOW_ARIA_ATTR,ek=!1!==t.ALLOW_DATA_ATTR,eE=t.ALLOW_UNKNOWN_PROTOCOLS||!1,ex=t.SAFE_FOR_TEMPLATES||!1,eA=t.WHOLE_DOCUMENT||!1,eM=t.RETURN_DOM||!1,ej=t.RETURN_DOM_FRAGMENT||!1,eI=t.RETURN_TRUSTED_TYPE||!1,eH=t.FORCE_BODY||!1,eN=!1!==t.SANITIZE_DOM,e_=t.SANITIZE_NAMED_PROPS||!1,eD=!1!==t.KEEP_CONTENT,eV=t.IN_PLACE||!1,eg=t.ALLOWED_URI_REGEXP||eg,eX=t.NAMESPACE||e$,t.CUSTOM_ELEMENT_HANDLING&&e0(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(eC.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&e0(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(eC.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(eC.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ex&&(ek=!1),ej&&(eM=!0),eL&&(em=A({},r(V)),ew=[],!0===eL.html&&(A(em,M),A(ew,L)),!0===eL.svg&&(A(em,j),A(ew,B),A(ew,F)),!0===eL.svgFilters&&(A(em,I),A(ew,B),A(ew,F)),!0===eL.mathMl&&(A(em,_),A(ew,W),A(ew,F))),t.ADD_TAGS&&(em===eb&&(em=P(em)),A(em,t.ADD_TAGS,o)),t.ADD_ATTR&&(ew===eS&&(ew=P(ew)),A(ew,t.ADD_ATTR,o)),t.ADD_URI_SAFE_ATTR&&A(eU,t.ADD_URI_SAFE_ATTR,o),t.FORBID_CONTENTS&&(eB===eW&&(eB=P(eB)),A(eB,t.FORBID_CONTENTS,o)),eD&&(em["#text"]=!0),eA&&A(em,["html","head","body"]),em.table&&(A(em,["tbody"]),delete eO.tbody),f&&f(t),eJ=t)},e2=A({},["mi","mo","mn","ms","mtext"]),e9=A({},["foreignobject","desc","title","annotation-xml"]),e3=A({},["title","style","font","a","script"]),e6=A({},j);A(e6,I),A(e6,N);var e8=A({},_);A(e8,D);var e7=function(e){var t=eo(e);t&&t.tagName||(t={namespaceURI:e$,tagName:"template"});var n=S(e.tagName),r=S(t.tagName);return e.namespaceURI===eq?t.namespaceURI===e$?"svg"===n:t.namespaceURI===eK?"svg"===n&&("annotation-xml"===r||e2[r]):Boolean(e6[n]):e.namespaceURI===eK?t.namespaceURI===e$?"math"===n:t.namespaceURI===eq?"math"===n&&e9[r]:Boolean(e8[n]):e.namespaceURI===e$&&(t.namespaceURI!==eq||!!e9[r])&&(t.namespaceURI!==eK||!!e2[r])&&!e8[n]&&(e3[n]||!e6[n])},e4=function(e){w(a.removed,{element:e});try{e.parentNode.removeChild(e)}catch(n){try{e.outerHTML=el}catch(t){e.remove()}}},e5=function(e,t){try{w(a.removed,{attribute:t.getAttributeNode(e),from:t})}catch(n){w(a.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!ew[e]){if(eM||ej)try{e4(t)}catch(r){}else try{t.setAttribute(e,"")}catch(o){}}},te=function(e){if(eH)e="<remove></remove>"+e;else{var t,r,o=C(e,/^[\r\n\t ]+/);r=o&&o[0]}"application/xhtml+xml"===n&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=ea?ea.createHTML(e):e;if(eX===e$)try{t=new J().parseFromString(i,n)}catch(a){}if(!t||!t.documentElement){t=eu.createDocument(eX,"template",null);try{t.documentElement.innerHTML=eY?"":i}catch(l){}}var u=t.body||t.documentElement;return(e&&r&&u.insertBefore(s.createTextNode(r),u.childNodes[0]||null),eX===e$)?eh.call(t,eA?"html":"body")[0]:eA?t.documentElement:u},tt=function(e){return ec.call(e.ownerDocument||e,e,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT,null,!1)},tn=function(t){return"object"===e(h)?t instanceof h:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},tr=function(e,t,n){ev[e]&&m(ev[e],function(e){e.call(a,t,n,eJ)})},to=function(e){if(tr("beforeSanitizeElements",e,null),e instanceof x&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof g)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)||k(/[\u0080-\uFFFF]/,e.nodeName))return e4(e),!0;var t,n=o(e.nodeName);if(tr("uponSanitizeElement",e,{tagName:n,allowedTags:em}),e.hasChildNodes()&&!tn(e.firstElementChild)&&(!tn(e.content)||!tn(e.content.firstElementChild))&&k(/<[/\w]/g,e.innerHTML)&&k(/<[/\w]/g,e.textContent)||"select"===n&&k(/<template/i,e.innerHTML))return e4(e),!0;if(!em[n]||eO[n]){if(!eO[n]&&ta(n)&&(eC.tagNameCheck instanceof RegExp&&k(eC.tagNameCheck,n)||eC.tagNameCheck instanceof Function&&eC.tagNameCheck(n)))return!1;if(eD&&!eB[n]){var r=eo(e)||e.parentNode,i=er(e)||e.childNodes;if(i&&r)for(var l=i.length,s=l-1;s>=0;--s)r.insertBefore(et(i[s],!0),en(e))}return e4(e),!0}return e instanceof d&&!e7(e)||("noscript"===n||"noembed"===n)&&k(/<\/no(script|embed)/i,e.innerHTML)?(e4(e),!0):(ex&&3===e.nodeType&&(t=O(t=e.textContent,z," "),t=O(t,U," "),e.textContent!==t&&(w(a.removed,{element:e.cloneNode()}),e.textContent=t)),tr("afterSanitizeElements",e,null),!1)},ti=function(e,t,n){if(eN&&("id"===t||"name"===t)&&(n in s||n in eQ))return!1;if(ek&&!eR[t]&&k(G,t));else if(eT&&k(K,t));else if(!ew[t]||eR[t]){if(!(ta(e)&&(eC.tagNameCheck instanceof RegExp&&k(eC.tagNameCheck,e)||eC.tagNameCheck instanceof Function&&eC.tagNameCheck(e))&&(eC.attributeNameCheck instanceof RegExp&&k(eC.attributeNameCheck,t)||eC.attributeNameCheck instanceof Function&&eC.attributeNameCheck(t))||"is"===t&&eC.allowCustomizedBuiltInElements&&(eC.tagNameCheck instanceof RegExp&&k(eC.tagNameCheck,n)||eC.tagNameCheck instanceof Function&&eC.tagNameCheck(n))))return!1}else if(eU[t]);else if(k(eg,O(n,X,"")));else if(("src"===t||"xlink:href"===t||"href"===t)&&"script"!==e&&0===R(n,"data:")&&eF[e]);else if(eE&&!k($,O(n,X,"")));else if(n)return!1;return!0},ta=function(e){return e.indexOf("-")>0},tl=function(t){tr("beforeSanitizeAttributes",t,null);var n,r,i,l,s=t.attributes;if(s){var u={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ew};for(l=s.length;l--;){var c=(n=s[l]).name,f=n.namespaceURI;if(r="value"===c?n.value:T(n.value),i=o(c),u.attrName=i,u.attrValue=r,u.keepAttr=!0,u.forceKeepAttr=void 0,tr("uponSanitizeAttribute",t,u),r=u.attrValue,!u.forceKeepAttr&&(e5(c,t),u.keepAttr)){if(k(/\/>/i,r)){e5(c,t);continue}ex&&(r=O(r,z," "),r=O(r,U," "));var h=o(t.nodeName);if(ti(h,i,r)){if(e_&&("id"===i||"name"===i)&&(e5(c,t),r="user-content-"+r),ea&&"object"===e(Q)&&"function"==typeof Q.getAttributeType){if(f);else switch(Q.getAttributeType(h,i)){case"TrustedHTML":r=ea.createHTML(r);break;case"TrustedScriptURL":r=ea.createScriptURL(r)}}try{f?t.setAttributeNS(f,c,r):t.setAttribute(c,r),b(a.removed)}catch(d){}}}}tr("afterSanitizeAttributes",t,null)}},ts=function e(t){var n,r=tt(t);for(tr("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)tr("uponSanitizeShadowNode",n,null),to(n)||(n.content instanceof u&&e(n.content),tl(n));tr("afterSanitizeShadowDOM",t,null)};return a.sanitize=function(t){var n,r,s,c,f,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((eY=!t)&&(t="<!-->"),"string"!=typeof t&&!tn(t)){if("function"!=typeof t.toString)throw E("toString is not a function");if("string"!=typeof(t=t.toString()))throw E("dirty is not a string, aborting")}if(!a.isSupported){if("object"===e(i.toStaticHTML)||"function"==typeof i.toStaticHTML){if("string"==typeof t)return i.toStaticHTML(t);if(tn(t))return i.toStaticHTML(t.outerHTML)}return t}if(eP||e1(d),a.removed=[],"string"==typeof t&&(eV=!1),eV){if(t.nodeName){var p=o(t.nodeName);if(!em[p]||eO[p])throw E("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof h)1===(r=(n=te("<!---->")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===r.nodeName?n=r:"HTML"===r.nodeName?n=r:n.appendChild(r);else{if(!eM&&!ex&&!eA&&-1===t.indexOf("<"))return ea&&eI?ea.createHTML(t):t;if(!(n=te(t)))return eM?null:eI?el:""}n&&eH&&e4(n.firstChild);for(var y=tt(eV?t:n);s=y.nextNode();)3===s.nodeType&&s===c||to(s)||(s.content instanceof u&&ts(s.content),tl(s),c=s);if(c=null,eV)return t;if(eM){if(ej)for(f=ef.call(n.ownerDocument);n.firstChild;)f.appendChild(n.firstChild);else f=n;return ew.shadowroot&&(f=ed.call(l,f,!0)),f}var g=eA?n.outerHTML:n.innerHTML;return eA&&em["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&k(Y,n.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+g),ex&&(g=O(g,z," "),g=O(g,U," ")),ea&&eI?ea.createHTML(g):g},a.setConfig=function(e){e1(e),eP=!0},a.clearConfig=function(){eJ=null,eP=!1},a.isValidAttribute=function(e,t,n){return eJ||e1({}),ti(o(e),o(t),n)},a.addHook=function(e,t){"function"==typeof t&&(ev[e]=ev[e]||[],w(ev[e],t))},a.removeHook=function(e){if(ev[e])return b(ev[e])},a.removeHooks=function(e){ev[e]&&(ev[e]=[])},a.removeAllHooks=function(){ev={}},a}()},e.exports=t()},1655:function(e,t,n){"use strict";n.d(t,{P:function(){return l},Q:function(){return a}}),n(4916),n(4723),n(5306),n(6755),n(7042),n(9600),n(3290),n(2772);var r=/^(\r\n|\n\r|\r|\n)/,o=/^[^\t\r\n]+/,i=/^\t/;function a(e){var t,n=[[""]];if(0===e.length)return n;for(var a=0,l=0;e.length>0&&t!==e.length;)if(t=e.length,e.match(i))e=e.replace(i,""),a+=1,n[l][a]="";else if(e.match(r))e=e.replace(r,""),a=0,n[l+=1]=[""];else{var s="";if(e.startsWith('"')){for(var u=0,c=!0;c;){var f=e.slice(0,1);'"'===f&&(u+=1),s+=f,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&u%2==0)&&(c=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(e){return Array(Math.floor(e.length/2)).fill('"').join("")})}else{var h=e.match(o);s=h?h[0]:"",e=e.slice(s.length)}n[l][a]=s}return n}function l(e){var t,n,r,o,i,a="";for(t=0,n=e.length;t<n;t+=1){for(r=0,o=e[t].length;r<o;r+=1)r>0&&(a+="	"),"string"==typeof(i=e[t][r])?i.indexOf("\n")>-1?a+='"'.concat(i.replace(/"/g,'""'),'"'):a+=i:null==i?a+="":a+=i;t!==n-1&&(a+="\n")}return a}},6223:function(e,t,n){"use strict";n.d(t,{Ii:function(){return r},vp:function(){return o}});var r=1,o=2},2792:function(e,t,n){"use strict";n(6992),n(1539),n(8783),n(4129),n(3948);var r=n(6223);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=new WeakMap,a=function(){var e,t;function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.viewportSize,r=e.scrollOffset,o=e.totalItems,a=e.itemSizeFn,l=e.overrideFn,s=e.calculationType,u=e.stretchMode,c=e.stretchingItemWidthFn;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),i.set(this,{viewportWidth:t,scrollOffset:r,totalColumns:o,columnWidthFn:a,overrideFn:l,calculationType:s,stretchingColumnWidthFn:void 0===c?function(e){return e}:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=u,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return t=[{key:"DEFAULT_WIDTH",get:function(){return 50}}],e=[{key:"calculate",value:function(){for(var e,t=0,n=!0,o=[],a=i.get(this),l=a.calculationType,s=a.overrideFn,u=a.scrollOffset,c=a.totalColumns,f=a.viewportWidth,h=0;h<c;h++){e=this._getColumnWidth(h),t<=u&&l!==r.vp&&(this.startColumn=h);var d=u>0?f+1:f;if(t>=u&&t+(l===r.vp?e:0)<=u+d&&((null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=h),this.endColumn=h),o.push(t),t+=e,l!==r.vp&&(this.endColumn=h),t>=u+f){n=!1;break}}if(this.endColumn===c-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var p=o[this.endColumn]+e-o[this.startColumn-1];if((p<=f||l!==r.vp)&&(this.startColumn-=1),p>f)break}l===r.Ii&&null!==this.startColumn&&s&&s(this),this.startPosition=o[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),c<this.endColumn&&(this.endColumn=c-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){var t=e;this.totalTargetWidth=t;for(var n=i.get(this),r=n.totalColumns,o=0,a=0;a<r;a++){var l=this._getColumnWidth(a),s=n.stretchingColumnWidthFn(void 0,a);"number"==typeof s?t-=s:o+=l}var u=t-o;if("all"===this.stretch&&u>0)this.stretchAllRatio=t/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var c=this._getColumnWidth(r-1),f=u+c;this.stretchLastWidth=f>=0?f:c}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,r=i.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[e]){var a=Math.round(t*this.stretchAllRatio),l=r.stretchingColumnWidthFn(a,e);void 0===l?this.stretchAllColumnsWidth[e]=a:this.stretchAllColumnsWidth[e]=isNaN(l)?this._getColumnWidth(e):l}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var s=0;s<this.stretchAllColumnsWidth.length;s++)n+=this.stretchAllColumnsWidth[s];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){return e===i.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var t=i.get(this).columnWidthFn(e);return isNaN(t)&&(t=n.DEFAULT_WIDTH),t}}],o(n.prototype,e),t&&o(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();t.Z=a},1343:function(e,t,n){"use strict";n(6992),n(1539),n(8783),n(4129),n(3948);var r=n(6223);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=new WeakMap,a=function(){var e,t;function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.viewportSize,r=e.scrollOffset,o=e.totalItems,a=e.itemSizeFn,l=e.overrideFn,s=e.calculationType,u=e.scrollbarHeight;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),i.set(this,{viewportHeight:t,scrollOffset:r,totalRows:o,rowHeightFn:a,overrideFn:l,calculationType:s,horizontalScrollbarHeight:u}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return t=[{key:"DEFAULT_HEIGHT",get:function(){return 23}}],e=[{key:"calculate",value:function(){for(var e,t=0,o=!0,a=[],l=i.get(this),s=l.calculationType,u=l.overrideFn,c=l.rowHeightFn,f=l.scrollOffset,h=l.totalRows,d=l.viewportHeight,p=l.horizontalScrollbarHeight||0,y=0;y<h;y++)if(isNaN(e=c(y))&&(e=n.DEFAULT_HEIGHT),t<=f&&s!==r.vp&&(this.startRow=y),t>=f&&t+(s===r.vp?e:0)<=f+d-p&&(null===this.startRow&&(this.startRow=y),this.endRow=y),a.push(t),t+=e,s!==r.vp&&(this.endRow=y),t>=f+d-p){o=!1;break}if(this.endRow===h-1&&o)for(this.startRow=this.endRow;this.startRow>0;){var g=a[this.endRow]+e-a[this.startRow-1];if((g<=d-p||s!==r.vp)&&(this.startRow-=1),g>=d-p)break}s===r.Ii&&null!==this.startRow&&u&&u(this),this.startPosition=a[this.startRow],void 0===this.startPosition&&(this.startPosition=null),h<this.endRow&&(this.endRow=h-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}],o(n.prototype,e),t&&o(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();t.Z=a},9368:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=a(e,t,"get");return n.get?n.get.call(e):n.value}function a(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}n(6992),n(1539),n(8783),n(4129),n(3948);var l=new WeakMap,s=function(){var e;function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),o(this,"row",null),o(this,"col",null),function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:!1}),function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(this,a(this,l,"set"),r),void 0!==e&&void 0!==n&&(this.row=e,this.col=n)}return r(t.prototype,[{key:"isValid",value:function(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&(i(this,l)?this.col<=e.col:this.col>=e.col)}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&(i(this,l)?this.col>=e.col:this.col<=e.col)}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&(i(this,l)?this.col>=e.col:this.col<=e.col)}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&(i(this,l)?this.col<=e.col:this.col>=e.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new t(this.row,this.col,i(this,l))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e&&r(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();t.Z=s},1640:function(e,t,n){"use strict";n(6699),n(2023),n(2772),n(6992),n(1539),n(8783),n(4129),n(3948);var r=n(9368);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=l(e,t,"get");return n.get?n.get.call(e):n.value}function l(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var s=new WeakMap,u=function(){var e,t;function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),i(this,"highlight",null),i(this,"from",null),i(this,"to",null),function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,s),s.set(this,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=t.clone(),this.to=r.clone(),function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(this,l(this,s,"set"),o)}return e=[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){var e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getWidth",value:function(){var e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(e){var t=e.row,n=e.col,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=t&&o.row>=t&&r.col<=n&&o.col>=n}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=this.getDirection(),o=e.getOuterTopStartCorner(),i=e.getOuterBottomEndCorner(),a=Math.min(t.row,o.row),l=Math.min(t.col,o.col),s=Math.max(n.row,i.row),u=Math.max(n.col,i.col),c=this._createCellCoords(a,l),f=this._createCellCoords(s,u);return this.from=c,this.to=f,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var e=this.getDirection();switch(e){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){var e=this.getDirection();switch(e){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return a(this,s)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return a(this,s)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return a(this,s)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return a(this,s)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return a(this,s)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return a(this,s)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return a(this,s)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return a(this,s)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col))))||e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof r.Z))return!1;if(t){var n=t.from,o=t.to;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}return e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return t.top===n.top&&r.push("top"),t.right===n.right&&r.push("right"),t.bottom===n.bottom&&r.push("bottom"),t.left===n.left&&r.push("left"),r}},{key:"getInner",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(this._createCellCoords(r,o));return n}},{key:"getAll",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)e.row===r&&e.col===o?n.push(e):t.row===r&&t.col===o?n.push(t):n.push(this._createCellCoords(r,o));return n}},{key:"forAll",value:function(e){for(var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=t.row;r<=n.row;r++)for(var o=t.col;o<=n.col;o++)if(!1===e(r,o))return}},{key:"clone",value:function(){return new n(this.highlight,this.from,this.to,a(this,s))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(e,t){return new r.Z(e,t,a(this,s))}}],o(n.prototype,e),t&&o(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();t.Z=u},6475:function(e,t,n){"use strict";n.d(t,{DA:function(){return f},V1:function(){return c},xN:function(){return h}});var r=n(4388),o=n(6187),i=n(9847),a=n(8894),l=(0,r.Z)("cellTypes"),s=l.register,u=l.getItem,c=l.hasItem;function f(e){if(!c(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return u(e)}function h(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);var n=t,r=n.editor,l=n.renderer,u=n.validator;r&&(0,o.qm)(e,r),l&&(0,i.zn)(e,l),u&&(0,a.Ie)(e,u),s(e,t)}l.getNames,l.getValues},5864:function(e,t,n){"use strict";n.d(t,{n:function(){return i}});var r=n(631),o=n(337),i={CELL_TYPE:"text",editor:r.H,renderer:o.V}},7002:function(e,t,n){"use strict";n(3161),n(9653),n(1539),n(4747);var r=n(7772),o=n(3817),i=n(613),a=n(2226),l=n(7161);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){var e,t;function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.hot=e,this.data=t,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return e=[{key:"modifyRowData",value:function(e){var t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var t=this,n=[];return(0,i.Bk)(this.data,function(r,o){var i=t.getAtCell(o,e);n.push(i)}),n}},{key:"getAtRow",value:function(e,t,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=void 0===t&&void 0===n,u=null,c=null;if(Array.isArray(u=this.modifyRowData(e)))c=[],s?u.forEach(function(t,n){c[n]=o.getAtPhysicalCell(e,n,u)}):(0,a.q4)(t,n,function(n){c[n-t]=o.getAtPhysicalCell(e,n,u)});else if((0,r.Kn)(u)||(0,l.mf)(u)){if(c=i?[]:{},!s||i){var f=this.countFirstRowKeys()-1;(0,a.q4)(0,f,function(a){var l=o.colToProp(a);if(a>=(t||0)&&a<=(n||f)&&!Number.isInteger(l)){var s=o.getAtPhysicalCell(e,l,u);i?c.push(s):(0,r.Hn)(c,l,s)}})}else(0,r._l)(u,function(t,n){(0,r.Hn)(c,n,o.getAtPhysicalCell(e,n,u))})}return c}},{key:"setAtCell",value:function(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=(0,r.sm)(n);this.hot.runHooks("modifySourceData",e,this.propToCol(t),o,"set"),o.isTouched()&&(n=o.value)}Number.isInteger(t)?this.data[e][t]=n:(0,r.Hn)(this.data[e],t,n)}}},{key:"getAtPhysicalCell",value:function(e,t,n){var o=null;if(n&&(o="string"==typeof t?(0,r.$s)(n,t):"function"==typeof t?t(n):n[t]),this.hot.hasHook("modifySourceData")){var i=(0,r.sm)(o);this.hot.runHooks("modifySourceData",e,this.colToProp(t),i,"get"),i.isTouched()&&(o=i.value)}return o}},{key:"getAtCell",value:function(e,t){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}},{key:"getByRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,l=null,s=null,u=null;null===t||null===n?(o=!0,i=0,s=this.countRows()-1):(i=Math.min(t.row,n.row),l=Math.min(t.col,n.col),s=Math.max(t.row,n.row),u=Math.max(t.col,n.col));var c=[];return(0,a.q4)(i,s,function(t){c.push(o?e.getAtRow(t,void 0,void 0,r):e.getAtRow(t,l,u,r))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return(0,o.Eb)(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}],s(n.prototype,e),t&&s(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();t.Z=u},2264:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}}),n(1539),n(4747);var r=n(7772);n(3161),n(9653);var o=n(6475);function i(e,t){var n="string"==typeof e?(0,o.DA)(e):e;if((0,r.Kn)(n)){var i=(0,r.Kn)(t),a={};return(0,r._l)(n,function(e,n){var o;"CELL_TYPE"!==n&&(!i||i&&(!(0,r.nr)(t,n)||(null==t?void 0:null===(o=t._automaticallyAssignedMetaProps)||void 0===o?void 0:o[n])===!0))&&(a[n]=e,null!=t&&t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps[n]=!0))}),a}}function a(e){return Number.isInteger(e)&&e>=0}function l(e,t){if(!e())throw Error("Assertion failed: ".concat(t))}var s=n(2004);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}var h=function(){function e(t){f(this,e),this.metaCtor=c(function e(){f(this,e)}),this.meta=this.metaCtor.prototype,(0,r.l7)(this.meta,(0,s.Z)()),this.meta.instance=t}return c(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){(0,r.l7)(this.meta,e),(0,r.l7)(this.meta,i(e.type,e))}}]),e}();function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){var e;function t(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t);var n=e.getMetaConstructor();this.meta=new n}return d(t.prototype,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){(0,r.l7)(this.meta,e),(0,r.l7)(this.meta,i(e.type,e))}}]),e&&d(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();n(6992),n(189),n(8783),n(3948),n(2222),n(7042),n(561),n(2165),n(2526),n(1817),n(2772),n(1038),n(8309),n(4916);var y=n(613);function g(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(e){var t,n;function r(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,r),this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}return t=[{key:"obtain",value:function(e){l(function(){return a(e)},"Expecting an unsigned number.");var t,n=this._getStorageIndexByKey(e);if(n>=0)void 0===(t=this.data[n])&&(t=this.valueFactory(e),this.data[n]=t);else if(t=this.valueFactory(e),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=t,this.index[e]=r}else this.data.push(t),this.index[e]=this.data.length-1;return t}},{key:"insert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l(function(){return a(e)||null==e},"Expecting an unsigned number or null/undefined argument.");for(var n=[],r=this.data.length,o=0;o<t;o++)n.push(r+o),this.data.push(void 0);var i=null==e?this.index.length:e;this.index=[].concat(g(this.index.slice(0,i)),n,g(this.index.slice(i)))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l(function(){return a(e)||null==e},"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(null==e?this.index.length-t:e,t),r=0;r<n.length;r++){var o=n[r];"number"==typeof o&&this.holes.add(o)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var e=this;return(0,y.w7)(this.data,function(t,n){return!e.holes.has(n)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var e=[],t=0;t<this.data.length;t++){var n=this._getKeyByStorageIndex(t);-1!==n&&e.push([n,this.data[t]])}var r=0;return{next:function(){if(r<e.length){var t=e[r];return r+=1,{value:t,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(e){return this.index.length>e?this.index[e]:-1}},{key:"_getKeyByStorageIndex",value:function(e){return this.index.indexOf(e)}},{key:e,value:function(){return this.entries()}}],b(r.prototype,t),n&&b(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}(Symbol.iterator);function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=["data","width"],O=function(){var e,t;function n(e){var t=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.globalMeta=e,this.metas=new w(function(){return t._createMeta()})}return e=[{key:"updateMeta",value:function(e,t){var n=this.getMeta(e);(0,r.l7)(n,t),(0,r.l7)(n,i(t.type,n))}},{key:"createColumn",value:function(e,t){this.metas.insert(e,t)}},{key:"removeColumn",value:function(e,t){this.metas.remove(e,t)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}(0,r.ED)(n,e);for(var o=0;o<t.length;o++)n.prototype[t[o]]=void 0;return n}(this.globalMeta.getMetaConstructor(),C).prototype}}],S(n.prototype,e),t&&S(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(1532);var k=function(){var e,t;function n(e){var t=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.columnMeta=e,this.metas=new w(function(){return t._createRow()})}return e=[{key:"updateMeta",value:function(e,t,n){var o=this.getMeta(e,t);(0,r.l7)(o,n),(0,r.l7)(o,i(n.type,o))}},{key:"createRow",value:function(e,t){this.metas.insert(e,t)}},{key:"createColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}},{key:"removeRow",value:function(e,t){this.metas.remove(e,t)}},{key:"removeColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}},{key:"getMeta",value:function(e,t,n){var r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}},{key:"setMeta",value:function(e,t,n,r){var o=this.metas.obtain(e).obtain(t);o[n]=r,!0===o._automaticallyAssignedMetaProps[n]&&(o._automaticallyAssignedMetaProps[n]=void 0)}},{key:"removeMeta",value:function(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}},{key:"getMetas",value:function(){for(var e,t=[],n=Array.from(this.metas.values()),r=0;r<n.length;r++)t.push.apply(t,function(e){if(Array.isArray(e))return R(e)}(e=n[r].values())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return t}},{key:"getMetasAtRow",value:function(e){l(function(){return a(e)},"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new w(function(t){return e._createMeta(t)})}},{key:"_createMeta",value:function(e){return new(this.columnMeta.getMetaConstructor(e))}}],T(n.prototype,e),t&&T(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}(),E=n(5981);function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var A=function(){var e,t;function n(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.hot=e,this.globalMeta=new h(e),this.tableMeta=new p(this.globalMeta),this.columnMeta=new O(this.globalMeta),this.cellMeta=new k(this.columnMeta),o.forEach(function(e){return new e(t)}),this.globalMeta.updateMeta(r)}return e=[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,t){this.columnMeta.updateMeta(e,t)}},{key:"getCellMeta",value:function(e,t,n){var r=n.visualRow,o=n.visualColumn,i=this.cellMeta.getMeta(e,t);return i.visualRow=r,i.visualCol=o,i.row=e,i.col=t,this.runLocalHooks("afterGetCellMeta",i),i}},{key:"getCellMetaKeyValue",value:function(e,t,n){if("string"!=typeof n)throw Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}},{key:"setCellMeta",value:function(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}},{key:"updateCellMeta",value:function(e,t,n){this.cellMeta.updateMeta(e,t,n)}},{key:"removeCellMeta",value:function(e,t,n){this.cellMeta.removeMeta(e,t,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}},{key:"createColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}},{key:"removeColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}],x(n.prototype,e),t&&x(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();(0,r.jB)(A,E.Z)},2654:function(e,t,n){"use strict";n.d(t,{$:function(){return l}}),n(6992),n(1532),n(1539),n(8783),n(3948),n(189);var r=n(3909),o=n(7772),i=n(7161);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){var e,t;function n(e){var t=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",function(e){return t.extendCellMeta(e)}),r.Z.getSingleton().add("beforeRender",function(e){e&&t.metaSyncMemo.clear()},this.metaManager.hot)}return e=[{key:"extendCellMeta",value:function(e){var t,n,r=e.row,a=e.col;if(!(null!==(t=this.metaSyncMemo.get(r))&&void 0!==t&&t.has(a))){var l=e.visualRow,s=e.visualCol,u=this.metaManager.hot,c=u.colToProp(s);e.prop=c,u.runHooks("beforeGetCellMeta",l,s,e);var f=(0,o.nr)(e,"type")?e.type:null,h=(0,i.mf)(e.cells)?e.cells(r,a,c):null;f&&(h?h.type=null!==(n=h.type)&&void 0!==n?n:f:h={type:f}),h&&this.metaManager.updateCellMeta(r,a,h),u.runHooks("afterGetCellMeta",l,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(a)}}}],a(n.prototype,e),t&&a(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}()},7226:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{_:function(){return o}}),n(6992),n(1539),n(189),n(8783),n(3948),n(1532),n(4747);var o=function(){var e,t;function n(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(e,t,n){if(!n)throw Error("The `".concat(e,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return e=[{key:"extendMetaProps",value:function(){var e=this;this.propDescriptors.forEach(function(t,n){var r=t.target,o=t.onChange,i=void 0===o?function(){}:o,a="string"==typeof r,l=a?r:n,s="_".concat(l);e.metaManager.globalMeta.meta[s]=e.metaManager.globalMeta.meta[l],e.installPropWatcher(n,s,i),a&&e.installPropWatcher(r,s,i)})}},{key:"installPropWatcher",value:function(e,t,n){var r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get:function(){return this[t]},set:function(o){var i=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,o,i),this[t]=o},enumerable:!0,configurable:!0})}}],r(n.prototype,e),t&&r(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}()},6068:function(e,t,n){"use strict";n.d(t,{o:function(){return b}}),n(561),n(2222),n(2526),n(1817),n(1539),n(2165),n(6992),n(8783),n(3948);var r=n(9272),o=n(7161);n(1532),n(3161),n(9653),n(2707),n(7042),n(4747),n(7327),n(2772),n(1038),n(8309),n(4916);var i=n(1655),a=n(3817),l=n(7772),s=n(613),u=n(2226),c=n(1799);function f(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=(0,a.$2)("copyable",!1),g=function(){var e,t;function n(e,t,r){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.instance=e,this.tableMeta=r,this.dataSource=t,this.duckSchema=this.dataSource&&this.dataSource[0]?(0,l.ie)(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return t=[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}],e=[{key:"createMap",value:function(){var e,t=this.getSchema();if(void 0===t)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,n){var r=0,o=0,i=!1;if("function"==typeof n){var a=(0,l.Q8)(t);r=a>0?a:this.countFirstRowKeys(),i=!0}else r=Math.min(this.tableMeta.maxCols,n.length);for(e=0;e<r;e++){var s=i?n(e):n[e];if((0,l.Kn)(s)){if(void 0!==s.data){var u=i?o:e;this.colToPropCache[u]=s.data,this.propToColCache.set(s.data,u)}o+=1}}}else this.recursiveDuckColumns(t)}},{key:"countFirstRowKeys",value:function(){return(0,a.Eb)(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,t,n){var r,o=this,i=t,a=n;return void 0===i&&(i=0,a=""),"object"!==d(e)||Array.isArray(e)||(0,l._l)(e,function(e,t){null===e?(r=a+t,o.colToPropCache.push(r),o.propToColCache.set(r,i),i+=1):i=o.recursiveDuckColumns(e,i,"".concat(t,"."))}),i}},{key:"colToProp",value:function(e){if(!1===Number.isInteger(e))return e;var t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&(0,c.$K)(this.colToPropCache[t])?this.colToPropCache[t]:t}},{key:"propToCol",value:function(e){var t=this.propToColCache.get(e);if((0,c.$K)(t))return this.instance.toVisualColumn(t);var n=this.instance.toVisualColumn(e);return null===n?e:n}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}},{key:"createRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.source,i=r.mode,a=this.instance.countSourceRows(),s=a,c=0,f=e;if(("number"!=typeof f||f>=a)&&(f=a),f<this.instance.countRows()&&(s=this.instance.toPhysicalRow(f)),!1===this.instance.runHooks("beforeCreateRow",f,n,o)||null===s)return 0;for(var h=this.tableMeta.maxRows,d=this.instance.countCols(),p=[];c<n&&a+c<h;)!function(){var e=null;"array"===t.instance.dataType?t.tableMeta.dataSchema?e=(0,l.I8)(t.getSchema()):(e=[],(0,u.q4)(d-1,function(){return e.push(null)})):"function"===t.instance.dataType?e=t.tableMeta.dataSchema(f+c):(e={},(0,l.ZB)(e,t.getSchema())),p.push(e),c+=1}();this.instance.rowIndexMapper.insertIndexes(f,c),"below"===(void 0===i?"above":i)&&(s=Math.min(s+1,a)),this.spliceData(s,0,p);var y=this.instance.toVisualRow(s);return this.instance.runHooks("afterCreateRow",y,c,o),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:s}}},{key:"createCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.source,o=n.mode;if(!this.instance.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i=this.dataSource,a=this.tableMeta.maxCols,l=this.instance.countSourceCols(),s=e;if(("number"!=typeof s||s>=l)&&(s=l),!1===this.instance.runHooks("beforeCreateCol",s,t,r))return 0;var u=l;s<this.instance.countCols()&&(u=this.instance.toPhysicalColumn(s));var c=this.instance.countSourceRows(),f=this.instance.countCols(),h=0,d=u;"end"===(void 0===o?"start":o)&&(d=Math.min(d+1,l));for(var p=d;h<t&&f<a;){if("number"!=typeof s||s>=f){if(c>0)for(var y=0;y<c;y+=1)void 0===i[y]&&(i[y]=[]),i[y].push(null);else i.push([null])}else for(var g=0;g<c;g++)i[g].splice(d,0,null);h+=1,d+=1,f+=1}this.instance.columnIndexMapper.insertIndexes(s,h);var m=this.instance.toVisualColumn(p);return this.instance.runHooks("afterCreateCol",m,h,r),this.instance.forceFullRender=!0,{delta:h,startPhysicalIndex:p}}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-t,o=this.visualRowsToPhysical(r,t),i=this.instance.countSourceRows();if(r=(i+r)%i,!1===this.instance.runHooks("beforeRemoveRow",r,o.length,o,n))return!1;var a=o.length;if(this.filterData(r,a,o),r<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(o);var l=(0,c.$K)(this.tableMeta.columns)||(0,c.$K)(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===l&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",r,a,o,n),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw Error("cannot remove column with object data source or columns option specified");var r="number"!=typeof e?-t:e;r=(this.instance.countCols()+r)%this.instance.countCols();var o=this.visualColumnsToPhysical(r,t),i=o.slice(0).sort(function(e,t){return t-e});if(!1===this.instance.runHooks("beforeRemoveCol",r,t,o,n))return!1;for(var a=!0,l=i.length,s=this.dataSource,u=0;u<l;u++)a&&o[0]!==o[u]-u&&(a=!1);if(a)for(var c=0,f=this.instance.countSourceRows();c<f;c++)s[c].splice(o[0],t);else for(var h=0,d=this.instance.countSourceRows();h<d;h++)for(var p=0;p<l;p++)s[h].splice(i[p],1);return r<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",r,t,o,n),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(e,t,n){for(var r=this.instance.getDataAtCol(e),o=r.slice(t,t+n),i=r.slice(t+n),a=arguments.length,l=Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];(0,s.g9)(l,i);for(var c=0;c<n;)l.push(null),c+=1;return(0,s.PI)(l),this.instance.populateFromArray(t,e,l,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(e,t,n){for(var r=this.instance.getSourceDataAtRow(e),o=r.slice(t,t+n),i=r.slice(t+n),a=arguments.length,l=Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];(0,s.g9)(l,i);for(var c=0;c<n;)l.push(null),c+=1;return this.instance.populateFromArray(e,t,[l],null,null,"spliceRow"),o}},{key:"spliceData",value:function(e,t,n){var r=this;if(!1!==this.instance.runHooks("beforeDataSplice",e,t,n)){var o=[].concat(f(this.dataSource.slice(0,e)),f(n),f(this.dataSource.slice(e)));this.dataSource.length=0,o.forEach(function(e){return r.dataSource.push(e)})}}},{key:"filterData",value:function(e,t,n){var r=this.instance.runHooks("filterData",e,t,n);!1===Array.isArray(r)&&(r=this.dataSource.filter(function(e,t){return -1===n.indexOf(t)})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}},{key:"get",value:function(e,t){var n=this.instance.toPhysicalRow(e),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n);r=isNaN(o)?o:r;var i=null;if(r&&r.hasOwnProperty&&(0,l.nr)(r,t))i=r[t];else if("string"==typeof t&&t.indexOf(".")>-1){var a=t.split("."),s=r;if(!s)return null;for(var u=0,c=a.length;u<c;u++)if(void 0===(s=s[a[u]]))return null;i=s}else"function"==typeof t&&(i=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var f=(0,l.sm)(i);this.instance.runHooks("modifyData",n,this.propToCol(t),f,"get"),f.isTouched()&&(i=f.value)}return i}},{key:"getCopyable",value:function(e,t){return y.call(this.instance,e,this.propToCol(t))?this.get(e,t):""}},{key:"set",value:function(e,t,n){var r=this.instance.toPhysicalRow(e),o=n,i=this.dataSource[r],a=this.instance.runHooks("modifyRowData",r);if(i=isNaN(a)?a:i,this.instance.hasHook("modifyData")){var s=(0,l.sm)(o);this.instance.runHooks("modifyData",r,this.propToCol(t),s,"set"),s.isTouched()&&(o=s.value)}if(i&&i.hasOwnProperty&&(0,l.nr)(i,t))i[t]=o;else if("string"==typeof t&&t.indexOf(".")>-1){var u,c=t.split("."),f=i,h=0;for(h=0,u=c.length-1;h<u;h++)void 0===f[c[h]]&&(f[c[h]]={}),f=f[c[h]];f[c[h]]=o}else"function"==typeof t?t(this.dataSource.slice(r,r+1)[0],o):i[t]=o}},{key:"visualRowsToPhysical",value:function(e,t){for(var n=this.instance.countSourceRows(),r=[],o=(n+e)%n,i=t;o<n&&i;)r.push(this.instance.toPhysicalRow(o)),i-=1,o+=1;return r}},{key:"visualColumnsToPhysical",value:function(e,t){for(var n=this.instance.countCols(),r=[],o=(n+e)%n,i=t;o<n&&i;){var a=this.instance.toPhysicalColumn(o);r.push(a),i-=1,o+=1}return r}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}},{key:"getLength",value:function(){var e=this.tableMeta.maxRows;return Math.min(this.instance.rowIndexMapper.getNotTrimmedIndexesLength(),e<0||0===e?0:e||1/0)}},{key:"getAll",value:function(){var e={row:0,col:0},t={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row!=0||this.instance.countSourceRows()?this.getRange(e,t,n.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(e,t,r){var o,i,a,l=[],s=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(0===s||0===u)return[];var c=r===n.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(s-1,0),Math.max(e.row,t.row)),h=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(o=Math.min(e.row,t.row);o<=f;o++){a=[];var d=o>=0?this.instance.toPhysicalRow(o):o;for(i=Math.min(e.col,t.col);i<=h&&null!==d;i++)a.push(c.call(this,o,this.colToProp(i)));null!==d&&l.push(a)}return l}},{key:"getText",value:function(e,t){return(0,i.P)(this.getRange(e,t,n.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(e,t){return(0,i.P)(this.getRange(e,t,n.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],p(n.prototype,e),t&&p(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t,n,i){var a=i.hotInstance,s=i.dataMap,u=i.dataSource,c=i.internalSource,f=i.source,h=i.firstRun,d=(0,r.ct)(c),p=a.getSettings();Array.isArray(p.dataSchema)?a.dataType="array":(0,o.mf)(p.dataSchema)?a.dataType="function":a.dataType="object",s&&s.destroy(),e=a.runHooks("before".concat(d),e,h,f);var y=new g(a,e,p);if(t(y),"object"===m(e)&&null!==e)e.push&&e.splice||(e=[e]);else if(null===e){var b,w=y.getSchema();e=[];var S=0,C=0;for(S=0,C=p.startRows;S<C;S++)if(("object"===a.dataType||"function"===a.dataType)&&p.dataSchema)b=(0,l.I8)(w),e.push(b);else if("array"===a.dataType)b=(0,l.I8)(w[0]),e.push(b);else{b=[];for(var O=0,R=p.startCols;O<R;O++)b.push(null);e.push(b)}}else throw Error("".concat(c," only accepts array of objects or array of arrays (").concat(m(e)," given)"));Array.isArray(e[0])&&(a.dataType="array"),p.data=e,y.dataSource=e,u.data=e,u.dataType=a.dataType,u.colToProp=y.colToProp.bind(y),u.propToCol=y.propToCol.bind(y),u.countCachedColumns=y.countCachedColumns.bind(y),n(y),a.runHooks("after".concat(d),e,h,f),h||(a.runHooks("afterChange",null,c),a.render())}},4020:function(e,t,n){"use strict";n.d(t,{HJ:function(){return c},PP:function(){return f}}),n(6699),n(2023),n(6992),n(1539),n(8783),n(4129),n(3948),n(2526),n(1817),n(2165),n(7042),n(8309),n(1038),n(4916);var r=n(1975),o=n(8539),i=n(6187),a=n(6487),l=n(1799);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c="editorManager.navigation",f="editorManager.handlingEditor",h=function(){var e,t;function n(e,t,r){var o=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.instance=e,this.tableMeta=t,this.selection=r,this.eventManager=new a.Z(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(e){return o.onAfterDocumentKeyDown(e)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(e){!o.destroyed&&o.instance.isListening()&&o.openEditor("",e)}),this.instance.view._wt.update("onCellDblClick",function(e,t,n){return o.onCellDblClick(e,t,n)})}return e=[{key:"registerShortcuts",value:function(){var e=this,t=this.instance.getShortcutManager(),n=t.getContext("grid"),r=t.getContext("editor"),i={group:f};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(n,r){e.closeEditorAndSaveChanges(t.isCtrlPressed()),e.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){e.closeEditorAndRestoreOriginalValue(t.isCtrlPressed()),e.activeEditor.focus()}}],i),n.addShortcuts([{keys:[["F2"]],callback:function(t){e.openEditor(null,t,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){e.instance.emptySelectedCells(),e.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(t,n){e.instance.getSettings().enterBeginsEditing?e.cellProperties.readOnly?e.moveSelectionAfterEnter():e.openEditor(null,t,!0):e.moveSelectionAfterEnter(n.includes("shift")),(0,o.mM)(t)}}],i)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(t){t&&e.prepareEditor()});return}var t=this.instance.getSelectedRangeLast().highlight,n=t.row,r=t.col,o=this.instance.runHooks("modifyGetCellCoords",n,r),a=n,l=r;if(Array.isArray(o)){var u=function(e){if(Array.isArray(e))return e}(o)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(o,2)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}}(o,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();a=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(a,l);var c=this.instance.rootDocument.activeElement;if(c&&c.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var f=this.instance.getCell(n,r,!0);if(f){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(l),p=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(a),l);this.activeEditor=(0,i.Jq)(h,this.instance),this.activeEditor.prepare(n,r,d,f,p,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var r=this.instance.getSelectedRangeLast().highlight,o=r.row,i=r.col,a=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),l=this.instance.columnIndexMapper.getRenderableFromVisualIndex(i);this.instance.view.scrollViewport(this.instance._createCellCoords(a,l)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}},{key:"closeEditor",value:function(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var e=this.instance.getCellEditor(this.cellProperties),t=this.instance.getSelectedRangeLast().highlight,n=t.row,r=t.col,o=this.instance,i=o.rowIndexMapper,a=o.columnIndexMapper,l=i.isHidden(this.instance.toPhysicalRow(n))||a.isHidden(this.instance.toPhysicalColumn(r));return!this.cellProperties.readOnly&&!!e&&!l}},{key:"moveSelectionAfterEnter",value:function(e){var t="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(e){var t=this;if(this.instance.isListening()){var n=e.keyCode;if(this.selection.isSelected()){var o=(e.ctrlKey||e.metaKey)&&!e.altKey;this.activeEditor&&(!this.activeEditor||this.activeEditor.isWaiting())||(0,r.DC)(n)||(0,r.T2)(n)||o||this.isEditorOpened()||(this.instance.getShortcutManager().getContext("editor").addShortcuts([{keys:[["ArrowUp"]],callback:function(){t.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){t.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){t.instance.selection.transformStart(0,-1*t.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){t.instance.selection.transformStart(0,t.instance.getDirectionFactor())}}],{runOnlyIf:function(){return(0,l.$K)(t.instance.getSelected())},group:c}),this.openEditor("",e))}}}},{key:"onCellDblClick",value:function(e,t,n){"TD"===n.nodeName&&this.openEditor(null,e,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}],u(n.prototype,e),t&&u(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}(),d=new WeakMap;h.getInstance=function(e,t,n){var r=d.get(e);return r||(r=new h(e,t,n),d.set(e,r)),r},t.ZP=h},7746:function(e,t,n){"use strict";n.d(t,{Hf:function(){return b},ed:function(){return g},PP:function(){return m}}),n(3371),n(4564),n(8309),n(6699),n(8304),n(489),n(1539),n(2419),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(7042),n(1038),n(4916);var r=n(1799),o=n(7772),i=n(4020),a=n(613),l={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;(0,a.Bk)(this._hooksStorage[e]||[],function(n){t.hot.removeHook(e,n)})},clearHooks:function(){var e=this;(0,o._l)(this._hooksStorage,function(t,n){return e.removeHooksByKey(n)}),this._hooksStorage={}}};(0,o.jW)(l,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var s=n(766);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var g=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),m="baseEditor",b=function(){function e(t){d(this,e),this.hot=t,this.instance=t,this.state=g.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return y(e,[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,t,n,r,o,i){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=o,this.cellProperties=i,this.state=g.VIRGIN}},{key:"extend",value:function(){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(r,e);var t,n=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=h(r);if(t){var o=h(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function r(){return d(this,r),n.apply(this,arguments)}return y(r)}(this.constructor)}},{key:"saveValue",value:function(e,t){var n,o,i,a,l=this;if(t){var s=this.hot.getSelectedLast();n=Math.max(Math.min(s[0],s[2]),0),o=Math.max(Math.min(s[1],s[3]),0),i=Math.max(s[0],s[2]),a=Math.max(s[1],s[3])}else{var u=[this.row,this.col,null,null];n=u[0],o=u[1],i=u[2],a=u[3]}var f=this.hot.runHooks("modifyGetCellCoords",n,o);if(Array.isArray(f)){var h=function(e){if(Array.isArray(e))return e}(f)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(f,2)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(f,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();n=h[0],o=h[1]}var d=this.hot.getShortcutManager().getContext("editor");this.isInFullEditMode()&&d.addShortcuts([{keys:[["ArrowUp"]],callback:function(){l.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){l.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){l.hot.selection.transformStart(0,-1*l.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){l.hot.selection.transformStart(0,l.hot.getDirectionFactor())}}],{runOnlyIf:function(){return(0,r.$K)(l.hot.getSelected())},group:m}),this.hot.populateFromArray(n,o,e,i,a,"edit")}},{key:"beginEditing",value:function(e,t){if(this.state===g.VIRGIN){var n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,i)),this.state=g.EDITING,this.isInFullEditMode()){var a="string"==typeof e?e:(0,r.Pz)(this.originalValue);this.setValue(a)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,t,n){var r,o=this;if(n){var a=this._closeCallback;this._closeCallback=function(e){a&&a(e),n(e),o.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager().getContext("editor");if(l.removeShortcutsByGroup(m),l.removeShortcutsByGroup(i.HJ),this.state===g.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===g.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}var s=this.getValue();r=this.cellProperties.trimWhitespace?[["string"==typeof s?String.prototype.trim.call(s||""):s]]:[[s]],this.state=g.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(e){o.state=g.FINISHED,o.discardEditor(e)}):(this.state=g.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=g.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){this.state===g.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=g.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=g.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===g.WAITING}},{key:"getEditedCellRect",value:function(){var e,t=this.getEditedCell();if(t){var n=this.hot.view._wt,r=n.wtOverlays,o=n.wtViewport,i=this.hot.rootWindow,a=(0,s.cv)(t),l=(0,s.iO)(t),u=(0,s.cv)(this.hot.rootElement),c=(0,s.iO)(this.hot.rootElement),f=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=f!==i?f.scrollTop:0,p=h!==i?h.scrollLeft:0,y=i.innerWidth-u.left-c,g=(null!==(e=r.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt).wtTable,m=g.name,b=["master","inline_start"].includes(m)?d:0,w=["master","top","bottom"].includes(m)?p:0,S=a.top===u.top?0:1,C=a.top-u.top-S-b,O=0;O=this.hot.isRtl()?i.innerWidth-a.left-l-y-1+w:a.left-u.left-1-w,["top","top_inline_start_corner"].includes(m)&&(C+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(O+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));var R=this.hot.hasColHeaders(),T=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),k=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(R&&T<=0||T===E)&&(C+=1),k<=0&&(O+=1);var x=o.rowsRenderCalculator.startPosition,A=o.columnsRenderCalculator.startPosition,P=Math.abs(r.inlineStartOverlay.getScrollPosition()),H=r.topOverlay.getScrollPosition(),M=(0,s.np)(this.hot.rootDocument),j=t.offsetTop+x-H,I=0;if(this.hot.isRtl()){var N=t.offsetLeft;I=N>=0?g.getWidth()-t.offsetLeft:Math.abs(N),I+=A-P-l}else I=t.offsetLeft+A-P;var _=(0,s.Dx)(this.TD,this.hot.rootWindow),D=parseInt(_[this.hot.isRtl()?"borderRightWidth":"borderLeftWidth"],10)>0?0:1,V=parseInt(_.borderTopWidth,10)>0?0:1,L=(0,s.iO)(t)+D,B=(0,s.Pb)(t)+V,W=(0,s.do)(f)?M:0,F=(0,s.vw)(h)?M:0,z=this.hot.view.maximumVisibleElementWidth(I)-W+D;return{top:C,start:O,height:B,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(j)-F+V,23),width:L,maxWidth:z}}}},{key:"getEditedCellsLayerClass",value:function(){var e=this.checkEditorSection();switch(e){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}],[{key:"EDITOR_TYPE",get:function(){return"base"}}]),e}();(0,o.jB)(b,l)},6187:function(e,t,n){"use strict";n.d(t,{Jq:function(){return f},Wu:function(){return u},qm:function(){return h}}),n(6992),n(1539),n(8783),n(4129),n(3948);var r=n(3909),o=n(4388),i=new WeakMap,a=(0,o.Z)("editors"),l=a.register,s=a.getItem,u=a.hasItem;function c(e){var t={};this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new e(n)),t[n.guid]},r.Z.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function f(e,t){var n;if("function"==typeof e)i.get(e)||h(null,e),n=i.get(e);else if("string"==typeof e)n=s(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error('No editor registered under name "'.concat(e,'"'));return n.getInstance(t)}function h(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);var n=new c(t);"string"==typeof e&&l(e,n),i.set(t,n)}a.getNames,a.getValues},631:function(e,t,n){"use strict";n.d(t,{H:function(){return O}}),n(2772),n(8304),n(489),n(1539),n(2419),n(4819),n(5003),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(7042),n(8309),n(1038),n(4916);var r=n(7746),o=n(6487),i=n(9931),a=n(766),l=n(2226),s=n(1975);n(2564);var u=n(1799),c=n(4020);function f(e,t){for(var n=(0,a.qK)(t),r=t.value.split("\n"),o=n,i=0,l=0;l<r.length;l++){var s=r[l];0!==l&&(i+=r[l-1].length+1);var u=i+s.length;if("home"===e?o=i:"end"===e&&(o=u),n<=u)break}(0,a.Mq)(t,o)}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S="ht_editor_hidden",C="textEditor",O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(R,e);var t,n,p,O=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=w(R);if(t){var r=w(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return b(e)}(this,e)});function R(e){var t;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,R),(t=O.call(this,e)).eventManager=new o.Z(b(t)),t.autoResize=function(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,r=document.createTextNode(""),o=document.createElement("SPAN"),i=function(e,t,n){e.addEventListener(t,n,!1)},a=function(e,t,n){e.removeEventListener(t,n,!1)},l=function(i){var a,l;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==r.textContent?r.textContent=e.value+i:r.data=e.value+i,o.style.position="absolute",o.style.fontSize=f(e).fontSize,o.style.fontFamily=f(e).fontFamily,o.style.whiteSpace="pre",n.appendChild(o),a=o.clientWidth+2,n.removeChild(o),e.style.height=t.minHeight+"px",t.minWidth>a?e.style.width=t.minWidth+"px":a>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=a+"px",l=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>l?e.style.height=t.minHeight+"px":t.maxHeight<l?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=l+"px"},s=function(){window.setTimeout(l,0)},u=function(n){if(n&&n.minHeight){if("inherit"==n.minHeight)t.minHeight=e.clientHeight;else{var i=parseInt(n.minHeight);isNaN(i)||(t.minHeight=i)}}if(n&&n.maxHeight){if("inherit"==n.maxHeight)t.maxHeight=e.clientHeight;else{var a=parseInt(n.maxHeight);isNaN(a)||(t.maxHeight=a)}}if(n&&n.minWidth){if("inherit"==n.minWidth)t.minWidth=e.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(t.minWidth=l)}}if(n&&n.maxWidth){if("inherit"==n.maxWidth)t.maxWidth=e.clientWidth;else{var s=parseInt(n.maxWidth);isNaN(s)||(t.maxWidth=s)}}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))},c=function(n,r,o){e=n,u(r),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),o&&(i(e,"change",l),i(e,"cut",s),i(e,"paste",s),i(e,"drop",s),i(e,"keydown",s),i(e,"focus",l),i(e,"compositionstart",s),i(e,"compositionupdate",s),i(e,"compositionend",s)),l()};function f(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}return{init:function(e,t,n){c(e,t,n)},unObserve:function(){a(e,"change",l),a(e,"cut",s),a(e,"paste",s),a(e,"drop",s),a(e,"keydown",s),a(e,"focus",l),a(e,"compositionstart",s),a(e,"compositionupdate",s),a(e,"compositionend",s)},resize:l}}(),t.TEXTAREA=void 0,t.textareaStyle=void 0,t.TEXTAREA_PARENT=void 0,t.textareaParentStyle=void 0,t.layerClass=void 0,t.createElements(),t.bindEvents(),t.hot.addHookOnce("afterDestroy",function(){return t.destroy()}),t}return p=[{key:"EDITOR_TYPE",get:function(){return"text"}}],n=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(e){this.TEXTAREA.value=e}},{key:"open",value:function(){var e=this;this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(t){return e.onAfterDocumentKeyDown(t)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(e,t,n,o,a,l){var s=this.state;if(g(w(R.prototype),"prepare",this).call(this,e,t,n,o,a,l),!l.readOnly){this.refreshDimensions(!0);var u=l.allowInvalid,c=l.fragmentSelection;u&&(this.TEXTAREA.value=""),s!==r.ed.FINISHED&&this.hideEditableElement(),c||(0,i.K1)()||this.focus()}}},{key:"beginEditing",value:function(e,t){this.state===r.ed.VIRGIN&&(this.TEXTAREA.value="",g(w(R.prototype),"beginEditing",this).call(this,e,t))}},{key:"focus",value:function(){this.TEXTAREA.select(),(0,a.Mq)(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var e=this.hot.rootDocument;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,(0,a.cn)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),(0,a.cn)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,a.pv)(this.TEXTAREA_PARENT,this.layerClass)&&(0,a.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,a.cn)(this.TEXTAREA_PARENT,S),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){((0,i.w1)()||(0,i.un)())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,a.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,a.cn)(this.TEXTAREA_PARENT,S)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var e=this.TEXTAREA_PARENT.childNodes,t=!1;(0,l.q4)(e.length-1,function(n){var r=e[n];if((0,a.pv)(r,"handsontableEditor"))return t=!0,!1}),(0,a.pv)(this.TEXTAREA_PARENT,S)&&(0,a.IV)(this.TEXTAREA_PARENT,S),t?(this.layerClass="ht_editor_visible",(0,a.cn)(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),(0,a.cn)(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===r.ed.EDITING||e){if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}var t=this.getEditedCellRect(),n=t.top,o=t.start,i=t.width,l=t.maxWidth,s=t.height,u=t.maxHeight;this.textareaParentStyle.top="".concat(n,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(o,"px"),this.showEditableElement();var c=(0,a.Dx)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=c.fontSize,this.TEXTAREA.style.fontFamily=c.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var f=(0,a.Dx)(this.TEXTAREA),h=parseInt(f.paddingLeft,10)+parseInt(f.paddingRight,10),d=parseInt(f.paddingTop,10)+parseInt(f.paddingBottom,10),p=l-h,y=u-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i-h,p),minHeight:Math.min(s-d,y),maxWidth:p,maxHeight:y},!0)}}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(e){return e.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(e){return e.stopPropagation()}),(0,i.gn)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return e.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return e.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return e.refreshDimensions()}),this.addHook("afterColumnResize",function(){e.refreshDimensions(),e.focus()}),this.addHook("afterRowResize",function(){e.refreshDimensions(),e.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager().getContext("editor"),n=function(){e.hot.rootDocument.execCommand("insertText",!1,"\n")};t.addShortcuts([{keys:[["Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"==typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(r.row,r.col,!0)}},{keys:[["Shift","Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"==typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(-r.row,-r.col)}},{keys:[["Control","Enter"]],callback:function(){return n(),!1},runOnlyIf:function(t){return!e.hot.selection.isMultiple()&&!t.altKey},relativeToGroup:c.PP,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return n(),!1},runOnlyIf:function(){return!e.hot.selection.isMultiple()},relativeToGroup:c.PP,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return n(),!1},relativeToGroup:c.PP,position:"before"},{keys:[["PageUp"]],callback:function(){e.hot.selection.transformStart(-e.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){e.hot.selection.transformStart(e.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(t,n){f(d(n,1)[0],e.TEXTAREA)}},{keys:[["End"]],callback:function(t,n){f(d(n,1)[0],e.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout(function(){e.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout(function(){e.autoResize.resize()},10)}}],{runOnlyIf:function(){return(0,u.$K)(e.hot.getSelected())},group:C})}},{key:"unregisterShortcuts",value:function(){var e=this.hot.getShortcutManager().getContext("editor");e.removeShortcutsByGroup(c.HJ),e.removeShortcutsByGroup(C),e.removeShortcutsByGroup(r.PP)}},{key:"onAfterDocumentKeyDown",value:function(e){-1===[s.nx.ARROW_UP,s.nx.ARROW_RIGHT,s.nx.ARROW_DOWN,s.nx.ARROW_LEFT].indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}],y(R.prototype,n),p&&y(R,p),Object.defineProperty(R,"prototype",{writable:!1}),R}(r.Hf)},6487:function(e,t,n){"use strict";n(561);var r=n(5965),o=n(8539);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=0,l=function(){var e,t;function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}return e=[{key:"addEventListener",value:function(e,t,n){var i=this,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function s(e){var t,r;n.call(this,(r=(t=e).stopImmediatePropagation,t.stopImmediatePropagation=function(){r.apply(this),(0,o.mM)(this)},t))}return"boolean"==typeof l||(0,r.by)()||(l=!1),this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:s,options:l,eventManager:this}),e.addEventListener(t,s,l),a+=1,function(){i.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){for(var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;i;)if(i-=1,(r=this.context.eventListeners[i]).event===t&&r.element===e){if(n&&n!==r.callback||o&&r.eventManager!==this)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),a-=1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),a-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(e,t){var n,r=e.document,o=e;r||(o=(r=e.ownerDocument?e.ownerDocument:e).defaultView);var i={bubbles:!0,cancelable:"mousemove"!==t,view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};r.createEvent?(n=r.createEvent("MouseEvents")).initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||r.body.parentNode):n=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent("on".concat(t),n)}}],i(n.prototype,e),t&&i(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();t.Z=l},9931:function(e,t,n){"use strict";n.d(t,{D8:function(){return p},E6:function(){return s},G6:function(){return f},K1:function(){return y},L:function(){return m},eE:function(){return w},gn:function(){return g},i7:function(){return l},iF:function(){return c},uM:function(){return b},un:function(){return h},vU:function(){return u},w1:function(){return d}}),n(4916);var r=n(7772),o=function(e){var t={value:!1};return t.test=function(n,r){t.value=e(n,r)},t},i={chrome:o(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:o(function(e){return/CriOS/.test(e)}),edge:o(function(e){return/Edge/.test(e)}),edgeWebKit:o(function(e){return/EdgiOS/.test(e)}),firefox:o(function(e){return/Firefox/.test(e)}),firefoxWebKit:o(function(e){return/FxiOS/.test(e)}),ie:o(function(e){return/Trident/.test(e)}),ie9:o(function(){return!!document.documentMode}),mobile:o(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:o(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},a={mac:o(function(e){return/^Mac/.test(e)}),win:o(function(e){return/^Win/.test(e)}),linux:o(function(e){return/^Linux/.test(e)}),ios:o(function(e){return/iPhone|iPad|iPod/i.test(e)})};function l(){return i.chrome.value}function s(){return i.chromeWebKit.value}function u(){return i.firefox.value}function c(){return i.firefoxWebKit.value}function f(){return i.safari.value}function h(){return i.edge.value}function d(){return i.ie.value}function p(){return i.ie9.value}function y(){return i.mobile.value}function g(){return a.ios.value}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.maxTouchPoints>2&&a.mac.value}function b(){return a.win.value}function w(){return a.mac.value}!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=void 0===t?navigator.userAgent:t,o=e.vendor,a=void 0===o?navigator.vendor:o;(0,r._l)(i,function(e){(0,e.test)(n,a)})}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,n=void 0===t?navigator.platform:t;(0,r._l)(a,function(e){(0,e.test)(n)})}()},3817:function(e,t,n){"use strict";n.d(t,{$2:function(){return l},Eb:function(){return u},Jr:function(){return c},Pj:function(){return f},Yl:function(){return a},ec:function(){return s}}),n(489),n(1539),n(4747),n(7941),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948);var r=n(6475),o=n(7772);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){for(var t,n=e+1,r="";n>0;)r=String.fromCharCode(65+(t=(n-1)%26))+r,n=parseInt((n-t)/26,10);return r}function l(e,t){var n=void 0===t||t;return function(t,i){return function t(i){if(i){if((0,o.nr)(i,e)&&void 0!==i[e])return i[e];if((0,o.nr)(i,"type")&&i.type){if("string"!=typeof i.type)throw Error('Cell "type" must be a string');var a=(0,r.DA)(i.type);if((0,o.nr)(a,e))return a[e];if(n)return}return t(Object.getPrototypeOf(i))}}("number"==typeof t?this.getCellMeta(t,i):t)}}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e,r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach(function(e,n){Array.isArray(e)?e.forEach(function(e,o){r.push([n+t,o,e])}):Object.keys(e).forEach(function(o){r.push([n+t,o,e[o]])})}),r}function u(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&(0,o.Kn)(e[0])&&(t=(0,o.Q8)(e[0]))),t}function c(e){return!!(Array.isArray(e)&&e.length&&e.every(function(e){return Array.isArray(e)}))}function f(e){return!!(Array.isArray(e)&&e.length&&e.every(function(e){return"object"===i(e)&&!Array.isArray(e)&&null!==e}))}},766:function(e,t,n){"use strict";n.d(t,{$g:function(){return _},AQ:function(){return H},C2:function(){return D},DZ:function(){return M},Dx:function(){return V},G_:function(){return h},I2:function(){return Z},IV:function(){return T},Kz:function(){return m},MO:function(){return g},Mq:function(){return q},Pb:function(){return B},W6:function(){return y},WH:function(){return J},WS:function(){return W},Wu:function(){return function e(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var n=t.childNodes,r=n.length-1;r>=0;r--)e(n[r])}},a7:function(){return K},cS:function(){return k},cn:function(){return R},cv:function(){return P},cx:function(){return j},dD:function(){return N},do:function(){return X},f5:function(){return d},hd:function(){return et},iO:function(){return L},kg:function(){return U},mK:function(){return b},mR:function(){return G},np:function(){return $},oq:function(){return p},pV:function(){return ee},pn:function(){return function e(t){for(var n=t.ownerDocument.documentElement,r=t;r!==n;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(!r.host)return!1;if(r.host.impl)return e(r.host.impl);if(r.host)return e(r.host);throw Error("Lost in Web Components world")}if(r.style&&"none"===r.style.display)return!1;r=r.parentNode}return!0}},pv:function(){return O},qK:function(){return z},tT:function(){return A},u7:function(){return Q},uS:function(){return x},vj:function(){return I},vw:function(){return Y},x9:function(){return F},z4:function(){return en}}),n(489),n(6699),n(2023),n(7042),n(2772),n(7327),n(1539),n(4603),n(4916),n(9714),n(9600),n(4564),n(5306),n(2222),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948),n(1038),n(8309);var r,o,i,a,l=n(5965),s=n(9931),u=n(9272);function c(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function h(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,o=e;null!==o;){if(n===t){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return r}function d(e){return Object.getPrototypeOf(e.parent)&&e.frameElement&&e.parent}function p(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=Node,o=r.ELEMENT_NODE,i=r.DOCUMENT_FRAGMENT_NODE,a=e;null!=a&&a!==n;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var c=a.host;a=c&&s===i?c:a.parentNode}return null}function y(e,t,n){for(var r=[],o=e;o&&(o=p(o,t,n))&&(!n||n.contains(o));)r.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode;var i=r.length;return i?r[i-1]:null}function g(e,t){var n=e.parentNode,r=[];for("string"==typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function m(e){var t=0,n=e;if(n.previousSibling)for(;n=n.previousSibling;)t+=1;return t}function b(e,t,n){var r=n.parentElement.querySelector(".ht_clone_".concat(e));return r?r.contains(t):null}function w(e){return e&&e.length?e.filter(function(e){return!!e}):[]}if((0,l.mp)()){var S=function(e){var t=e.createElement("div");return t.classList.add("test","test2"),t.classList.contains("test2")};r=function(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)},o=function(e,t){var n,r=e.ownerDocument,o=t;if("string"==typeof o&&(o=o.split(" ")),(o=w(o)).length>0){if(S(r))(n=e.classList).add.apply(n,c(o));else for(var i=0;o[i];)e.classList.add(o[i]),i+=1}},i=function(e,t){var n,r=e.ownerDocument,o=t;if("string"==typeof o&&(o=o.split(" ")),(o=w(o)).length>0){if(S(r))(n=e.classList).remove.apply(n,c(o));else for(var i=0;o[i];)e.classList.remove(o[i]),i+=1}}}else{var C=function(e){return RegExp("(\\s|^)".concat(e,"(\\s|$)"))};r=function(e,t){return void 0!==e.className&&C(t).test(e.className)},o=function(e,t){var n=e.className,r=t;if("string"==typeof r&&(r=r.split(" ")),r=w(r),""===n)n=r.join(" ");else for(var o=0;o<r.length;o++)r[o]&&!C(r[o]).test(n)&&(n+=" ".concat(r[o]));e.className=n},i=function(e,t){var n=0,r=e.className,o=t;for("string"==typeof o&&(o=o.split(" ")),o=w(o);o[n];)r=r.replace(C(o[n])," ").trim(),n+=1;e.className!==r&&(e.className=r)}}function O(e,t){return r(e,t)}function R(e,t){o(e,t)}function T(e,t){i(e,t)}function k(e){for(var t;t=e.lastChild;)e.removeChild(t)}var E=/(<(.*)>|&(.*);)/;function x(e,t){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];E.test(t)?e.innerHTML=n?(0,u.Nw)(t):t:A(e,t)}function A(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?l.tt?n.textContent=t:n.data=t:(k(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function P(e){var t,n,r,o,i=e.ownerDocument,a=i.defaultView,s=i.documentElement,u=e;if((0,l.ZF)()&&u.firstChild&&"CAPTION"===u.firstChild.nodeName)return{top:(o=u.getBoundingClientRect()).top+(a.pageYOffset||s.scrollTop)-(s.clientTop||0),left:o.left+(a.pageXOffset||s.scrollLeft)-(s.clientLeft||0)};for(t=u.offsetLeft,n=u.offsetTop,r=u;(u=u.offsetParent)&&u!==i.body;)t+=u.offsetLeft,n+=u.offsetTop,r=u;return r&&"fixed"===r.style.position&&(t+=a.pageXOffset||s.scrollLeft,n+=a.pageYOffset||s.scrollTop),{left:t,top:n}}function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollY;return void 0===t&&(t=e.document.documentElement.scrollTop),t}function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollX;return void 0===t&&(t=e.document.documentElement.scrollLeft),t}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?H(t):e.scrollTop}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?M(t):e.scrollLeft}function N(e){var t=e.ownerDocument,n=t?t.defaultView:void 0;t||(n=(t=e.document?e.document:e).defaultView);for(var r=["auto","scroll"],o=(0,l.mI)(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,s=a.overflow,u=a.overflowX,c=a.overflowY;if([s,u,c].includes("scroll"))return i;if(o){var f=n.getComputedStyle(i);if(s=f.overflow,u=f.overflowX,c=f.overflowY,r.includes(s)||r.includes(u)||r.includes(c))return i}if(i.clientHeight<=i.scrollHeight+1&&(r.includes(c)||r.includes(s))||i.clientWidth<=i.scrollWidth+1&&(r.includes(u)||r.includes(s)))return i;i=i.parentNode}return n}function _(e){for(var t=e.ownerDocument,n=t.defaultView,r=e.parentNode;r&&r.style&&t.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var o=V(r,n),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return r;r=r.parentNode}return n}function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(e){if(e===n)return"width"===t?"".concat(n.innerWidth,"px"):"height"===t?"".concat(n.innerHeight,"px"):void 0;var r=e.style[t];if(""!==r&&void 0!==r)return r;var o=V(e,n);if(""!==o[t]&&void 0!==o[t])return o[t]}}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function L(e){return e.offsetWidth}function B(e){return(0,l.ZF)()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function W(e){return e.clientHeight||e.innerHeight}function F(e){return e.clientWidth||e.innerWidth}function z(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var n=t.selection.createRange();if(null===n)return 0;var r=e.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function U(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var n=t.selection.createRange();return null===n?0:e.createTextRange().text.indexOf(n.text)+n.text.length}return 0}function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,n="";return e.getSelection?n=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(n=t.selection.createRange().text),n}function K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function q(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(i){var r=e.parentNode,o=r.style.display;r.style.display="block",e.setSelectionRange(t,n),r.style.display=o}}}function $(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===a&&(a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);var r=t.offsetWidth;n.style.overflow="scroll";var o=t.offsetWidth;return r===o&&(o=n.clientWidth),(e.body||e.documentElement).removeChild(n),r-o}(e)),a}function X(e){return e.offsetWidth!==e.clientWidth}function Y(e){return e.offsetHeight!==e.clientHeight}function Z(e,t,n){(0,s.D8)()?(e.style.top=n,e.style.left=t):(0,s.G6)()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(n,",0)"):e.style.transform="translate3d(".concat(t,",").concat(n,",0)")}function J(e){e.style.transform&&""!==e.style.transform?e.style.transform="":e.style["-webkit-transform"]&&""!==e.style["-webkit-transform"]&&(e.style["-webkit-transform"]="")}function Q(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function ee(e){return Q(e)&&!1===e.hasAttribute("data-hot-input")}function et(e){ee(e.ownerDocument.activeElement)||e.select()}function en(e){return!e.parentNode}},8539:function(e,t,n){"use strict";function r(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function o(e){return!1===e.isImmediatePropagationEnabled}function i(e){return 2===e.button}function a(e){return 0===e.button}n.d(t,{Ty:function(){return o},dO:function(){return i},mM:function(){return r},pW:function(){return a}})},5965:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,{JS:function(){return m},U7:function(){return h},Wx:function(){return g},ZF:function(){return b},by:function(){return S},mI:function(){return y},mp:function(){return d},sx:function(){return w},tt:function(){return p}}),n(2564),n(2526),n(1817),n(1539),n(2165),n(6992),n(8783),n(3948);for(var o,i,a,l=0,s=["ms","moz","webkit","o"],u=window.requestAnimationFrame,c=window.cancelAnimationFrame,f=0;f<s.length&&!u;++f)u=window["".concat(s[f],"RequestAnimationFrame")],c=window["".concat(s[f],"CancelAnimationFrame")]||window["".concat(s[f],"CancelRequestAnimationFrame")];function h(e){return u.call(window,e)}function d(){return!!document.documentElement.classList}function p(){return!!document.createTextNode("test").textContent}function y(){return!!window.getComputedStyle}function g(e){c.call(window,e)}function m(){return"ontouchstart"in window}function b(){if(void 0===o){var e,t,n;(e=document.createElement("TABLE")).style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0",t=document.createElement("TBODY"),e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>",(n=document.createElement("CAPTION")).innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",e.insertBefore(n,t),document.body.appendChild(e),o=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}return o}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i||(i=("undefined"==typeof Intl?"undefined":r(Intl))==="object"?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?function(e,t){return"".concat(e).localeCompare(t)}:function(e,t){return e===t?0:e>t?-1:1})}function S(){if(void 0!==a)return a;try{var e={get passive(){a=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(t){a=!1}return a}u||(u=function(e){var t=new Date().getTime(),n=Math.max(0,16-(t-l)),r=window.setTimeout(function(){e(t+n)},n);return l=t+n,r}),c||(c=function(e){clearTimeout(e)})},7161:function(e,t,n){"use strict";n.d(t,{$Z:function(){return s},Ds:function(){return i},WA:function(){return l},mf:function(){return o},r$:function(){return a}}),n(2564),n(7042),n(2222),n(5069);var r=n(1799);function o(e){return"function"==typeof e}function i(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var o=this,i=arguments.length,a=Array(i),l=0;l<i;l++)a[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){t=e.apply(o,a)},n),t}}function a(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(this,n.concat(r))}}function l(e){var t=e.length;return function n(r){return function(){for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=r.concat(i);return l.length>=t?e.apply(this,l):n(l)}}([])}function s(e,t,n,o,i,a,l,s){return(0,r.$K)(s)?e.call(t,n,o,i,a,l,s):(0,r.$K)(l)?e.call(t,n,o,i,a,l):(0,r.$K)(a)?e.call(t,n,o,i,a):(0,r.$K)(i)?e.call(t,n,o,i):(0,r.$K)(o)?e.call(t,n,o):(0,r.$K)(n)?e.call(t,n):e.call(t)}},2226:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=o(e);if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);var i=Array.from(new Set(["."].concat(function(e){if(Array.isArray(e))return r(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))).map(function(e){return"\\".concat(e)}).join("|");return RegExp("^[+-]?\\s*(((".concat(i,")?\\d+((").concat(i,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}return"object"===n&&!!e&&"number"==typeof e.valueOf()&&!(e instanceof Date)}function a(e){return i(e,[","])}function l(e,t,n){var r=-1;for("function"==typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function s(e,t,n){var r=e+1;for("function"==typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}function u(e,t){return t=isNaN(t=parseInt(t.toString().replace("%",""),10))?0:t,parseInt(e*t/100,10)}n.d(t,{N1:function(){return u},TR:function(){return a},kE:function(){return i},q4:function(){return l},yh:function(){return s}}),n(4916),n(9600),n(1249),n(1038),n(8783),n(6992),n(1539),n(189),n(3948),n(2222),n(4603),n(9714),n(4564),n(5306),n(2526),n(1817),n(2165),n(7042),n(8309)},9272:function(e,t,n){"use strict";n.d(t,{Nw:function(){return u},O1:function(){return i},ct:function(){return o},ng:function(){return l},oN:function(){return s},wK:function(){return a}}),n(2772),n(1539),n(9714),n(4916),n(5306);var r=n(7856);function o(e){return e[0].toUpperCase()+e.substr(1)}function i(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function a(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]})}function s(e){return u("".concat(e),{ALLOWED_TAGS:[]})}function u(e,t){return r.sanitize(e,t)}},1975:function(e,t,n){"use strict";n.d(t,{DC:function(){return s},EA:function(){return l},T2:function(){return u},nx:function(){return i},ot:function(){return c}}),n(6699),n(2023);var r=n(613),o=n(9931),i={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,o.vU)()?182:174,AUDIO_MUTE:(0,o.vU)()?181:173,AUDIO_UP:(0,o.vU)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},a=[i.ALT,i.ARROW_DOWN,i.ARROW_LEFT,i.ARROW_RIGHT,i.ARROW_UP,i.AUDIO_DOWN,i.AUDIO_MUTE,i.AUDIO_UP,i.BACKSPACE,i.CAPS_LOCK,i.DELETE,i.END,i.ENTER,i.ESCAPE,i.F1,i.F2,i.F3,i.F4,i.F5,i.F6,i.F7,i.F8,i.F9,i.F10,i.F11,i.F12,i.F13,i.F14,i.F15,i.F16,i.F17,i.F18,i.F19,i.HOME,i.INSERT,i.MEDIA_NEXT,i.MEDIA_PLAY_PAUSE,i.MEDIA_PREV,i.MEDIA_STOP,i.NULL,i.NUM_LOCK,i.PAGE_DOWN,i.PAGE_UP,i.PAUSE,i.SCROLL_LOCK,i.SHIFT,i.TAB];function l(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function s(e){return a.includes(e)}function u(e){return[i.CONTROL,i.COMMAND_LEFT,i.COMMAND_RIGHT,i.COMMAND_FIREFOX].includes(e)}function c(e,t){var n=t.split("|"),o=!1;return(0,r.Bk)(n,function(t){if(e===i[t])return o=!0,!1}),o}},5981:function(e,t,n){"use strict";var r=n(7772),o=n(7161),i={_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e,t,n,r,i,a,l){if(this._localHooks[e])for(var s=this._localHooks[e].length,u=0;u<s;u++)(0,o.$Z)(this._localHooks[e][u],this,t,n,r,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};(0,r.jW)(i,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),t.Z=i},3909:function(e,t,n){"use strict";n(7042),n(3371),n(6992),n(1532),n(1539),n(8783),n(3948),n(2772),n(561);var r,o=n(613),i=n(7772),a=n(9272),l=n(3895),s=n(8336),u=n(7161);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],h=(0,s.e)(r||(r=Object.freeze(Object.defineProperties(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],{raw:{value:Object.freeze(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.'])}})))),d=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),p=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),y=function(){var e,t;function n(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.globalBucket=this.createEmptyBucket()}return e=[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return(0,o.Bk)(f,function(t){return e[t]=[]}),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))(0,o.Bk)(t,function(t){return n.add(e,t,r)});else{d.has(e)&&(0,l.ZK)((0,a.ng)(h,{hookName:e,removedInVersion:d.get(e)})),p.has(e)&&(0,l.ZK)(p.get(e));var i=this.getBucket(r);if(void 0===i[e]&&(this.register(e),i[e]=[]),t.skip=!1,-1===i[e].indexOf(t)){var s=!1;t.initialHook&&(0,o.Bk)(i[e],function(n,r){if(n.initialHook)return i[e][r]=t,s=!0,!1}),s||i[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?(0,o.Bk)(t,function(t){return n.once(e,t,r)}):(t.runOnce=!0,this.add(e,t,r))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return!!(void 0!==r[e]&&r[e].indexOf(t)>=0)&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!!(void 0!==n[e]&&n[e].length)}},{key:"run",value:function(e,t,n,r,o,i,a,l){var s=this.globalBucket[t],c=s?s.length:0,f=0;if(c)for(;f<c;){if(!s[f]||s[f].skip){f+=1;continue}var h=(0,u.$Z)(s[f],e,n,r,o,i,a,l);void 0!==h&&(n=h),s[f]&&s[f].runOnce&&this.remove(t,s[f]),f+=1}var d=this.getBucket(e)[t],p=d?d.length:0,y=0;if(p)for(;y<p;){if(!d[y]||d[y].skip){y+=1;continue}var g=(0,u.$Z)(d[y],e,n,r,o,i,a,l);void 0!==g&&(n=g),d[y]&&d[y].runOnce&&this.remove(t,d[y],e),y+=1}return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,i._l)(this.getBucket(e),function(e,t,n){return n[t].length=0})}},{key:"register",value:function(e){this.isRegistered(e)||f.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&f.splice(f.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return p.has(e)||d.has(e)}},{key:"isRegistered",value:function(e){return f.indexOf(e)>=0}},{key:"getRegistered",value:function(){return f}}],t=[{key:"getSingleton",value:function(){return g}}],e&&c(n.prototype,e),t&&c(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}(),g=new y;t.Z=y},8298:function(e,t,n){"use strict";n.d(t,{s3:function(){return O},a9:function(){return C},_j:function(){return R},fo:function(){return T}}),n(2222),n(2526),n(1817),n(1539),n(2165),n(6992),n(8783),n(3948),n(1038),n(7042),n(8309),n(4916);var r=n(9272);n(1532),n(1249),n(2707);var o=n(2226),i=n(7161);function a(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var s=new Map([["asc",[-1,1]],["desc",[1,-1]]]),u=function(e){return"The priority '".concat(e,"' is already declared in a map.")},c=function(e){return"The priority '".concat(e,"' is not a number.")},f=n(8722);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n(189);var d=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function p(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){return'There is already registered "'.concat(e,'" plugin.')},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorPriorityExists,n=e.errorPriorityNaN,r=new Map;return t=(0,i.mf)(t)?t:u,n=(0,i.mf)(n)?n:c,{addItem:function(e,i){if(!(0,o.kE)(e))throw Error(n(e));if(r.has(e))throw Error(t(e));r.set(e,i)},getItems:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",n=function(e){if(Array.isArray(e))return e}(e=s.get(t)||s.get("asc"))||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(e,2)||a(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=n[0],i=n[1];return((function(e){if(Array.isArray(e))return l(e)})(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||a(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(e,t){return e[0]<t[0]?o:i}).map(function(e){return e[1]})}}}({errorPriorityExists:function(e){return'There is already registered plugin on priority "'.concat(e,'".')},errorPriorityNaN:function(e){return'The priority "'.concat(e,'" is not a number.')}}),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorItemExists,n=new Set;return t=(0,i.mf)(t)?t:d,{addItem:function(e){if(n.has(e))throw Error(t(e));n.add(e)},clear:function(){n.clear()},getItems:function(){return function(e){if(Array.isArray(e))return h(e)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}}(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}({errorItemExists:m}),S=(0,f.I)({errorIdExists:m});function C(){return[].concat(p(b.getItems()),p(w.getItems()))}function O(e){var t=(0,r.ct)(e);return S.getItem(t)}function R(e){return!!O(e)}function T(e,t,n){var o,i,a,l,s=function(e){if(Array.isArray(e))return e}((o=e,i=t,a=n,"function"==typeof o&&(o=(i=o).PLUGIN_KEY,a=i.PLUGIN_PRIORITY),l=[o,i,a]))||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(l,3)||y(l,3)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();e=s[0],t=s[1],n=s[2],void 0===O(e)&&function(e,t,n){var o=(0,r.ct)(e);if(S.hasItem(o))throw Error(m(o));void 0===n?w.addItem(o):b.addItem(n,o),S.addItem(o,t)}(e,t,n)}},6285:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(766);function o(e,t,n,o,i,a,l){var s=[],u=[];l.className&&(0,r.cn)(t,l.className),l.readOnly&&s.push(l.readOnlyCellClassName),!1===l.valid&&l.invalidCellClassName?s.push(l.invalidCellClassName):u.push(l.invalidCellClassName),!1===l.wordWrap&&l.noWordWrapClassName&&s.push(l.noWordWrapClassName),!a&&l.placeholder&&s.push(l.placeholderCellClassName),(0,r.IV)(t,u),(0,r.cn)(t,s)}o.RENDERER_TYPE="base"},9847:function(e,t,n){"use strict";n.d(t,{Bp:function(){return l},Y3:function(){return a},zn:function(){return s}});var r=(0,n(4388).Z)("renderers"),o=r.register,i=r.getItem,a=r.hasItem;function l(e){if("function"==typeof e)return e;if(!a(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return i(e)}function s(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),o(e,t)}r.getNames,r.getValues},337:function(e,t,n){"use strict";n.d(t,{V:function(){return a}}),n(4564);var r=n(6285),o=n(766),i=n(1799);function a(e,t,n,a,l,s,u){r.Z.apply(this,[e,t,n,a,l,s,u]);var c=s;if(!c&&u.placeholder&&(c=u.placeholder),c=(0,i.Pz)(c),u.trimWhitespace&&(c=c.trim()),u.rendererTemplate){(0,o.cS)(t);var f=e.rootDocument.createElement("TEMPLATE");f.setAttribute("bind","{{}}"),f.innerHTML=u.rendererTemplate,HTMLTemplateElement.decorate(f),f.model=e.getSourceDataAtRow(n),t.appendChild(f)}else(0,o.tT)(t,c)}a.RENDERER_TYPE="text"},2600:function(e,t,n){"use strict";n.d(t,{$7:function(){return s},AI:function(){return o},CD:function(){return r},Nc:function(){return l},P$:function(){return a},d7:function(){return i}});var r="active-header",o="area",i="cell",a="fill",l="header",s="custom-selection"},3431:function(e,t,n){"use strict";n.d(t,{Z:function(){return em}}),n(7042),n(3371),n(2526),n(1817),n(2165),n(8309),n(4916),n(6992),n(1539),n(189),n(8783),n(3948),n(2222),n(1038),n(6699),n(2023),n(3161),n(9653),n(4747),n(3290),n(1532),n(7941),n(7327),n(5003),n(9337);var r,o=n(4388),i=n(2600);n(2772),n(8304),n(489),n(2419),n(4819),n(2479);var a=n(766);n(9600);var l=n(8539),s=n(7772),u=n(9931);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){var e,t;function n(e,t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}return e=[{key:"registerListeners",value:function(){var e=this,t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",function(){return e.onMouseDown()}),this.eventManager.addEventListener(t,"mouseup",function(){return e.onMouseUp()});for(var n=function(t,n){var r=e.main.childNodes[t];e.eventManager.addEventListener(r,"mouseenter",function(n){return e.onMouseEnter(n,e.main.childNodes[t])})},r=0,o=this.main.childNodes.length;r<o;r++)n(r,o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),(0,l.mM)(e);var n=this,r=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",function e(i){(function(e){if(e.clientY<Math.floor(o.top)||e.clientY>Math.ceil(o.top+o.height)||e.clientX<Math.floor(o.left)||e.clientX>Math.ceil(o.left+o.width))return!0})(i)&&(n.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")})}}},{key:"createBorders",value:function(e){var t=this.wot.rootDocument;this.main=t.createElement("div");var n=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(var o=0;o<5;o++){var i=n[o],a=t.createElement("div");a.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(a.className+=" hidden"),(r=a.style).backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:e.border.color,r.height=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(e.border.width,"px"),r.width=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(a)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,u.K1)()&&this.createMultipleSelectorHandles(),this.disappear();var l=this.wot.wtTable,s=l.bordersHolder;s||((s=t.createElement("div")).className="htBorders",l.bordersHolder=s,l.spreader.appendChild(s)),s.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,t=this.wot.rootDocument;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var n={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};(0,s._l)(n,function(t,n){e.selectionHandles.styles.bottomHitArea[n]=t,e.selectionHandles.styles.topHitArea[n]=t});var r={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};(0,s._l)(r,function(t,n){e.selectionHandles.styles.bottom[n]=t,e.selectionHandles.styles.top[n]=t}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(e,t){var n=this.wot.selections.createOrGetArea();return!!n.cellRange&&(e!==n.cellRange.to.row||t!==n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,t,n,r,o,i){var a=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",l=this.selectionHandles.styles,s=l.top,u=l.topHitArea,c=l.bottom,f=l.bottomHitArea,h=parseInt(s.borderWidth,10),d=parseInt(s.width,10),p=parseInt(u.width,10),y=this.wot.wtTable.getWidth(),g=this.wot.wtTable.getHeight();s.top="".concat(parseInt(n-d-1,10),"px"),s[a]="".concat(parseInt(r-d-1,10),"px"),u.top="".concat(parseInt(n-p/4*3,10),"px"),u[a]="".concat(parseInt(r-p/4*3,10),"px");var m=Math.min(parseInt(r+o,10),y-d-2*h),b=Math.min(parseInt(r+o-p/4,10),y-p-2*h);c[a]="".concat(m,"px"),f[a]="".concat(b,"px");var w=Math.min(parseInt(n+i,10),g-d-2*h),S=Math.min(parseInt(n+i-p/4,10),g-p-2*h);c.top="".concat(w,"px"),f.top="".concat(S,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(s.display="block",u.display="block",this.isPartRange(e,t)?(c.display="none",f.display="none"):(c.display="block",f.display="block")):(s.display="none",c.display="none",u.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(s.zIndex="9999",u.zIndex="9999"):(s.zIndex="",u.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var t,n,r,o,i,l,s=this.wot,f=s.wtTable,h=s.rootDocument,d=s.rootWindow,p=f.getRenderedRowsCount(),y=0;y<p;y+=1){var g=f.rowFilter.renderedToSource(y);if(g>=e[0]&&g<=e[2]){t=g,i=e[0];break}}for(var m=p-1;m>=0;m-=1){var b=f.rowFilter.renderedToSource(m);if(b>=e[0]&&b<=e[2]){n=b;break}}for(var w=f.getRenderedColumnsCount(),S=0;S<w;S+=1){var C=f.columnFilter.renderedToSource(S);if(C>=e[1]&&C<=e[3]){r=C,l=e[1];break}}for(var O=w-1;O>=0;O-=1){var R=f.columnFilter.renderedToSource(O);if(R>=e[1]&&R<=e[3]){o=R;break}}if(void 0===t||void 0===r){this.disappear();return}var T=f.getCell(this.wot.createCellCoords(t,r)),k=t!==n||r!==o,E=k?f.getCell(this.wot.createCellCoords(n,o)):T,x=(0,a.cv)(T),A=k?(0,a.cv)(E):x,P=(0,a.cv)(f.TABLE),H=(0,a.iO)(f.TABLE),M=x.top,j=x.left,I=this.wot.wtSettings.getSetting("rtlMode"),N=0,_=0;if(I){var D=(0,a.iO)(T),V=d.innerWidth-P.left-H;_=j+D-A.left,N=d.innerWidth-j-D-V-1}else _=A.left+(0,a.iO)(E)-j,N=j-P.left-1;if(this.isEntireColumnSelected(t,n)){var L=this.getDimensionsFromHeader("columns",r,o,i,P),B=null;if(L){var W=c(L,3);B=W[0],N=W[1],_=W[2]}B&&(T=B)}var F=M-P.top-1,z=A.top+(0,a.Pb)(E)-M;if(this.isEntireRowSelected(r,o)){var U=this.getDimensionsFromHeader("rows",t,n,l,P),G=null;if(U){var K=c(U,3);G=K[0],F=K[1],z=K[2]}G&&(T=G)}var q=(0,a.Dx)(T,d);parseInt(q.borderTopWidth,10)>0&&(F+=1,z=z>0?z-1:0),parseInt(q[I?"borderRightWidth":"borderLeftWidth"],10)>0&&(N+=1,_=_>0?_-1:0);var $=I?"right":"left";this.topStyle.top="".concat(F,"px"),this.topStyle[$]="".concat(N,"px"),this.topStyle.width="".concat(_,"px"),this.topStyle.display="block",this.startStyle.top="".concat(F,"px"),this.startStyle[$]="".concat(N,"px"),this.startStyle.height="".concat(z,"px"),this.startStyle.display="block";var X=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(F+z-X,"px"),this.bottomStyle[$]="".concat(N,"px"),this.bottomStyle.width="".concat(_,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(F,"px"),this.endStyle[$]="".concat(N+_-X,"px"),this.endStyle.height="".concat(z+1,"px"),this.endStyle.display="block";var Y=this.settings.border.cornerVisible;Y="function"==typeof Y?Y(this.settings.layerLevel):Y;var Z=this.wot.getSetting("onModifyGetCellCoords",n,o),J=n,Q=o;if(Z&&Array.isArray(Z)){var ee=c(Z,4);J=ee[2],Q=ee[3]}if((0,u.K1)()||!Y||this.isPartRange(J,Q))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(F+z+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[$]="".concat(N+_+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var et=(0,a.$g)(f.TABLE),en=et===d;en&&(et=h.documentElement);var er=parseInt(this.cornerDefaultStyle.width,10)/2,eo=parseInt(this.cornerDefaultStyle.height,10)/2;if(o===this.wot.getSetting("totalColumns")-1){var ei=en?E.getBoundingClientRect().left:E.offsetLeft;(I?ei-parseInt(this.cornerDefaultStyle.width,10)/2<0:ei+(0,a.iO)(E)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,a.x9)(et))&&(this.cornerStyle[$]="".concat(Math.floor(N+_+this.cornerCenterPointOffset-er),"px"),this.cornerStyle[I?"borderLeftWidth":"borderRightWidth"]=0)}n===this.wot.getSetting("totalRows")-1&&(en?E.getBoundingClientRect().top:E.offsetTop)+(0,a.Pb)(E)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,a.WS)(et)&&(this.cornerStyle.top="".concat(Math.floor(F+z+this.cornerCenterPointOffset-eo),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}(0,u.K1)()&&this.updateMultipleSelectionHandlesPosition(n,o,F,N,_,z)}}},{key:"isEntireColumnSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,t,n,r,o){var i=this.wot.wtTable,l=i.wtRootElement.parentNode,s=null,u=null,c=null,f=null,h=null,d=null,p=null,y=null;switch(e){case"rows":s=function(){return i.getRowHeader.apply(i,arguments)},u=function(){return a.Pb.apply(void 0,arguments)},c="ht__selection--rows",d="top";break;case"columns":s=function(){return i.getColumnHeader.apply(i,arguments)},u=function(){return a.iO.apply(void 0,arguments)},c="ht__selection--columns",d="left"}if(l.classList.contains(c)){var g=this.wot.getSetting("columnHeaders").length;if(p=s(t,g-r),y=s(n,g-r),!p||!y)return!1;var m=(0,a.cv)(p),b=(0,a.cv)(y);return p&&y&&(f=m[d]-o[d]-1,h=b[d]+u(y)-m[d]),[p,f,h]}return!1}},{key:"changeBorderStyle",value:function(e,t){var n=this[e].style,r=t[e];!r||r.hide?(0,a.cn)(this[e],"hidden"):((0,a.pv)(this[e],"hidden")&&(0,a.IV)(this[e],"hidden"),n.backgroundColor=r.color,("top"===e||"bottom"===e)&&(n.height="".concat(r.width,"px")),("start"===e||"end"===e)&&(n.width="".concat(r.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var t={width:1,color:"#000"},n=this[e].style;n.backgroundColor=t.color,n.width="".concat(t.width,"px"),n.height="".concat(t.width,"px")}},{key:"toggleHiddenClass",value:function(e,t){this.changeBorderToDefaultStyle(e),t?(0,a.cn)(this[e],"hidden"):(0,a.IV)(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,u.K1)()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}],h(n.prototype,e),t&&h(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function C(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(i,e);var t,n,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=O(i);if(t){var r=O(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return C(e)}(this,e)});function i(e,t){var n,r,a;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),(a="visualCellRange")in(r=C(n=o.call(this,e,null)))?Object.defineProperty(r,a,{value:null,enumerable:!0,configurable:!0,writable:!0}):r[a]=null,n.visualCellRange=t||null,n.commit(),n}return n=[{key:"add",value:function(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}},{key:"clear",value:function(){return this.visualCellRange=null,w(O(i.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(e){var t=e.from,n=e.to,r=this.getNearestNotHiddenCoords(t,1),o=this.getNearestNotHiddenCoords(n,-1);if(null===r||null===o)return null;if(r.row>o.row||r.col>o.col){if(!("header"===this.settings.type||"active-header"===this.settings.type))return null;r=t,o=n}return this.settings.createCellRange(r,r,o)}},{key:"getNearestNotHiddenCoords",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(null===r)return null;var o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,n);return null===o?null:this.settings.createCellCoords(r,o)}},{key:"getNearestNotHiddenIndex",value:function(e,t,n){if(t<0)return t;var r=e.getNearestNotHiddenIndex(t,n);return("header"===this.settings.type||"active-header"===this.settings.type)&&null===r?-1:r}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return null===e?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}},{key:"syncWith",value:function(e){var t="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,r=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,n);if(null!==r&&e.overlaps(r)){if(null===this.cellRange){var o=this.settings.visualToRenderableCoords(r);this.cellRange=this.settings.createCellRange(o)}return e.setHighlight(r),this}return e.setHighlight(e.from),this}},{key:"getCorners",value:function(){var e=this.cellRange,t=e.from,n=e.to,r=null===t.row||null===n.row,o=null===t.col||null===n.col,i=this.settings.createCellCoords(r?null:Math.min(t.row,n.row),o?null:Math.min(t.col,n.col)),a=this.settings.createCellCoords(r?null:Math.max(t.row,n.row),o?null:Math.max(t.col,n.col));return[i.row,i.col,a.row,a.col]}},{key:"getVisualCorners",value:function(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}},{key:"createRenderableCellRange",value:function(e,t){var n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(n,n,r)}}],b(i.prototype,n),r&&b(i,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(function(){var e,t;function n(e,t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.settings=e,this.cellRange=t||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return e=[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new d(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=e.wtTable.getCell(this.settings.createCellCoords(t,n));if("object"===y(i)){var l=r;o&&(l=this.classNameGenerator(i),this.classNames.includes(l)||this.classNames.push(l)),(0,a.cn)(i,l)}return this}},{key:"linearClassNameGenerator",value:function(e,t){return function n(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===o)return e;var i=o>=0?o:t,l=e,s=0==(i-=1)?e:"".concat(e,"-").concat(i);if((0,a.pv)(r,s)){var u=i+1;l="".concat(e,"-").concat(u)}else l=n(r,i);return l}}},{key:"draw",value:function(e){if(this.isEmpty()){this.settings.border&&this.getBorder(e).disappear();return}var t=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),r=this.getCorners(),o=function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(r,4)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}}(r,4)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],l=o[1],s=o[2],u=o[3],c=this.settings,f=c.highlightHeaderClassName,h=c.highlightColumnClassName,d=c.highlightRowClassName,y=c.highlightOnlyClosestHeader,g=c.selectionType,m=void 0===g||["active-header","header"].includes(g);if(m&&null!==l&&null!==u)for(var b=0,w=0;w<n;w+=1){var S=e.wtTable.columnFilter.renderedToSource(w);if(S>=l&&S<=u){var C=e.wtTable.getColumnHeaders(S),O=C.length-1;y&&C.length>1&&(C=[C[O]]);for(var R=0;R<C.length;R+=1){var T=[],k=C[R];f&&T.push(f),h&&T.push(h),R=y?O:R;var E=e.getSetting("onBeforeHighlightingColumnHeader",S,R,{selectionType:g,columnCursor:b,selectionWidth:u-l+1,classNames:T});E!==S&&(k=e.wtTable.getColumnHeader(E,R)),(0,a.cn)(k,T)}b+=1}}if(null!==i&&null!==s)for(var x=0,A=0;A<t;A+=1){var P=e.wtTable.rowFilter.renderedToSource(A);if(m&&P>=i&&P<=s){var H=e.wtTable.getRowHeaders(P),M=H.length-1;y&&H.length>1&&(H=[H[M]]);for(var j=0;j<H.length;j+=1){var I=[],N=H[j];f&&I.push(f),d&&I.push(d),j=y?M:j;var _=e.getSetting("onBeforeHighlightingRowHeader",P,j,{selectionType:g,rowCursor:x,selectionHeight:s-i+1,classNames:I});_!==P&&(N=e.wtTable.getRowHeader(_,j)),(0,a.cn)(N,I)}x+=1}if(null!==l&&null!==u)for(var D=0;D<n;D+=1){var V=e.wtTable.columnFilter.renderedToSource(D);P>=i&&P<=s&&V>=l&&V<=u?this.settings.className&&this.addClassAtCoords(e,P,V,this.settings.className,this.settings.markIntersections):P>=i&&P<=s?d&&this.addClassAtCoords(e,P,V,d):V>=l&&V<=u&&h&&this.addClassAtCoords(e,P,V,h);var L=e.getSetting("onAfterDrawSelection",P,V,this.settings.layerLevel);"string"==typeof L&&this.addClassAtCoords(e,P,V,L)}}e.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border&&this.getBorder(e).appear(r)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(e){return e.destroy()})}}],g(n.prototype,e),t&&g(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}()),T=["activeHeaderClassName"];function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach(function(t){var r,o;r=e,o=n[t],t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var x=function(e){var t=e.activeHeaderClassName,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,T);return new R(E(E({highlightHeaderClassName:t},n),{},{selectionType:i.CD}))},A=["layerLevel","areaCornerVisible"];function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach(function(t){var r,o;r=e,o=n[t],t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var M=function(e){var t=e.layerLevel,n=e.areaCornerVisible,r=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,A);return new R(H(H({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:i.AI}))},j=["cellCornerVisible"];function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach(function(t){var r,o;r=e,o=n[t],t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _=function(e){var t=e.cellCornerVisible,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,j);return new R(N(N({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},n),{},{selectionType:i.d7}))},D=["border","visualCellRange"];function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach(function(t){var r,o;r=e,o=n[t],t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var B=function(e){var t=e.border,n=e.visualCellRange,r=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,D);return new R(L(L(L({},t),r),{},{selectionType:i.$7}),n)};function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach(function(t){var r,o;r=e,o=n[t],t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n(9601);var z=function(e){var t=Object.assign({},(function(e){if(null==e)throw TypeError("Cannot destructure "+e)}(e),e));return new R(F(F({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:i.P$}))},U=["headerClassName","rowClassName","columnClassName"];function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach(function(t){var r,o;r=e,o=n[t],t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var q=function(e){var t=e.headerClassName,n=e.rowClassName,r=e.columnClassName,o=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,U);return new R(K(K({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:n,highlightColumnClassName:r},o),{},{highlightOnlyClosestHeader:!0,selectionType:i.Nc}))};function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var X=(0,o.Z)("highlight/types"),Y=X.register,Z=X.getItem;function J(e,t){return Z(e)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach(function(t){var r,o;r=e,o=n[t],t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:e},t))}Y(i.CD,x),Y(i.AI,M),Y(i.d7,_),Y(i.$7,B),Y(i.P$,z),Y(i.Nc,q);var Q=n(613);function ee(e){return function(e){if(Array.isArray(e))return et(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return et(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function en(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?en(Object(n),!0).forEach(function(t){var r,o;r=e,o=n[t],t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):en(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ei=function(e){var t,n;function r(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,r),this.options=e,this.layerLevel=0,this.cell=J(i.d7,e),this.fill=J(i.P$,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return t=[{key:"isEnabledFor",value:function(e,t){var n=e;e===i.d7&&(n="current");var r=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var e,t=this.layerLevel;return this.areas.has(t)?e=this.areas.get(t):(e=J(i.AI,er({layerLevel:t},this.options)),this.areas.set(t,e)),e}},{key:"getAreas",value:function(){return ee(this.areas.values())}},{key:"createOrGetHeader",value:function(){var e,t=this.layerLevel;return this.headers.has(t)?e=this.headers.get(t):(e=J(i.Nc,er({},this.options)),this.headers.set(t,e)),e}},{key:"getHeaders",value:function(){return ee(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var e,t=this.layerLevel;return this.activeHeaders.has(t)?e=this.activeHeaders.get(t):(e=J(i.CD,er({},this.options)),this.activeHeaders.set(t,e)),e}},{key:"getActiveHeaders",value:function(){return ee(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return ee(this.customSelections.values())}},{key:"addCustomSelection",value:function(e){this.customSelections.push(J(i.$7,er(er({},this.options),e)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),(0,Q.Bk)(this.areas.values(),function(e){e.clear()}),(0,Q.Bk)(this.headers.values(),function(e){e.clear()}),(0,Q.Bk)(this.activeHeaders.values(),function(e){e.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(ee(this.areas.values()),ee(this.headers.values()),ee(this.activeHeaders.values()),ee(this.customSelections))[Symbol.iterator]()}}],eo(r.prototype,t),n&&eo(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}(Symbol.iterator);function ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var el=function(e){var t,n;function r(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,r),this.ranges=[],this.createCellRange=e}return t=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}},{key:"add",value:function(e){return this.ranges.push(this.createCellRange(e)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some(function(t){return t.includes(e)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+t-1;return n>=0&&(e=this.ranges[n]),e}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}],ea(r.prototype,t),n&&ea(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}(Symbol.iterator),es=n(1799),eu=n(5981);function ec(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ef=function(){var e,t;function n(e,t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.range=e,this.options=t}return e=[{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(e,t),o=this.range.current().highlight,i=this.options.visualToRenderableCoords(o),a=i.row,l=i.col,s=o,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",r),null!==a&&null!==l){var f=this.options.countRows(),h=this.options.countCols(),d=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),y=this.options.minSpareCols(),g=this.options.autoWrapRow(),m=this.options.autoWrapCol();a+e>f-1?n&&p>0&&!(d&&a>=f-d-1)?(this.runLocalHooks("insertRowRequire",f),f=this.options.countRows()):m&&(r.row=1-f,r.col=l+r.col===h-1?1-h:1):m&&a+r.row<0&&l+r.col>=0&&(r.row=f-1,r.col=l+r.col===0?h-1:-1),l+r.col>h-1?n&&y>0?(this.runLocalHooks("insertColRequire",h),h=this.options.countCols()):g&&(r.row=a+r.row===f-1?1-f:1,r.col=1-h):g&&l+r.col<0&&a+r.row>=0&&(r.row=a+r.row===0?f-1:-1,r.col=h-1);var b=this.options.createCellCoords(a+r.row,l+r.col);u=0,c=0,b.row<0?(u=-1,b.row=0):b.row>0&&b.row>=f&&(u=1,b.row=f-1),b.col<0?(c=-1,b.col=0):b.col>0&&b.col>=h&&(c=1,b.col=h-1),s=this.options.renderableToVisualCoords(b)}return this.runLocalHooks("afterTransformStart",s,u,c),s}},{key:"transformEnd",value:function(e,t){var n=this.options.createCellCoords(e,t),r=this.range.current(),o=r.to,i=0,a=0;this.runLocalHooks("beforeTransformEnd",n);var l=this.options.visualToRenderableCoords(r.highlight),s=l.row,u=l.col;if(null!==s&&null!==u){var c=this.options.countRows(),f=this.options.countCols(),h=this.options.visualToRenderableCoords(r.to),d=h.row,p=h.col,y=this.options.createCellCoords(d+n.row,p+n.col);i=0,a=0,y.row<0?(i=-1,y.row=0):y.row>0&&y.row>=c&&(i=1,y.row=c-1),y.col<0?(a=-1,y.col=0):y.col>0&&y.col>=f&&(a=1,y.col=f-1),o=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformEnd",o,i,a),o}}],ec(n.prototype,e),t&&ec(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();(0,s.jB)(ef,eu.Z);var eh=n(1199),ed=n(8336);function ep(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ey(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ey(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ey(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ev(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var eg=function(){var e,t;function n(e,t){var r=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.settings=e,this.tableProps=t,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new el(function(e,t,n){return r.tableProps.createCellRange(e,t,n)}),this.highlight=new ei({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:function(e,t){return r.tableProps.isDisabledCellSelection(e,t)},cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},createCellRange:function(e,t,n){return r.tableProps.createCellRange(e,t,n)},rowIndexMapper:function(){return r.tableProps.rowIndexMapper()},columnIndexMapper:function(){return r.tableProps.columnIndexMapper()}}),this.transformation=new ef(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(t))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(t))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(t))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(t))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(t))}),this.transformation.addLocalHook("insertColRequire",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(t))})}return e=[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=(0,es.o8)(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,i=e.row<0,a=e.col<0,l=i&&a,s=e.clone();this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),s),(!r||r&&!o&&(0,es.o8)(t))&&this.selectedRange.clear(),this.selectedRange.add(s),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,t){this.setRangeStart(e,t,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){var t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(i.d7,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var r=this.getLayerLevel();r<this.highlight.layerLevel&&((0,Q.Bk)(this.highlight.getAreas(),function(e){e.clear()}),(0,Q.Bk)(this.highlight.getHeaders(),function(e){e.clear()}),(0,Q.Bk)(this.highlight.getActiveHeaders(),function(e){e.clear()})),this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(o.clear(),a.clear(),l.clear(),this.highlight.isEnabledFor(i.AI,n.highlight)&&(this.isMultiple()||r>=1)&&(o.add(n.from).add(n.to).commit(),1===r)){var s=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(s.from).commit().syncWith(s),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(i.Nc,n.highlight)){var u=0===this.tableProps.countRowsTranslated(),c=0===this.tableProps.countColsTranslated(),f=n;(u||c)&&(f=n.clone()),u&&(f.from.row=-1),c&&(f.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&f.from.normalize(),a.add(f.from).commit()):a.add(f.from).add(f.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===n.getWidth()&&l.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===n.getHeight()&&l.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=(0,s.sm)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(e,t,n))}},{key:"transformEnd",value:function(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return -1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return -1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(e||t||0!==n&&0!==r){var o=this.tableProps.createCellCoords(t?-1:0,e?-1:0);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(this.tableProps.createCellCoords(n-1,r-1)),this.finish()}}},{key:"selectCells",value:function(e){var t=this,n=(0,eh.AV)(e);if(n===eh.gk)return!1;if(n===eh.Kk)throw Error((0,ed.e)(r||(r=Object.freeze(Object.defineProperties(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],{raw:{value:Object.freeze(["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."])}})))));var o=(0,eh.S5)(n,{propToCol:function(e){return t.tableProps.propToCol(e)},keepDirection:!0}),i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=!e.some(function(e){var t=ep(o(e),4),n=t[0],r=t[1],l=t[2],s=t[3];return!((0,eh.AO)(n,i)&&(0,eh.AO)(r,a)&&(0,eh.AO)(l,i)&&(0,eh.AO)(s,a))});return l&&(this.clear(),(0,Q.Bk)(e,function(e){var n=ep(o(e),4),r=n[0],i=n[1],a=n[2],l=n[3];t.setRangeStartOnly(t.tableProps.createCellCoords(r,i),!1),t.setRangeEnd(t.tableProps.createCellCoords(a,l)),t.finish()})),l}},{key:"selectColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"==typeof e?this.tableProps.propToCol(e):e,o="string"==typeof t?this.tableProps.propToCol(t):t,i=this.tableProps.countCols(),a=this.tableProps.countRows(),l=(0,eh.AO)(r,i)&&(0,eh.AO)(o,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,r)),this.setRangeEnd(this.tableProps.createCellCoords(a-1,o)),this.finish()),l}},{key:"selectRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),o=this.tableProps.countCols(),i=(0,eh.AO)(e,r)&&(0,eh.AO)(t,r);return i&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(t,o-1)),this.finish()),i}},{key:"refresh",value:function(){if(this.highlight.getCustomSelections().forEach(function(e){e.commit()}),this.isSelected()){var e=this.highlight.getCell(),t=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(var n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),i=this.highlight.createOrGetActiveHeader();r.commit(),o.commit(),i.commit()}this.highlight.useLayerLevel(t)}}}],ev(n.prototype,e),t&&ev(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();(0,s.jB)(eg,eu.Z);var em=eg},1199:function(e,t,n){"use strict";n.d(t,{AO:function(){return w},AV:function(){return y},I8:function(){return b},Kk:function(){return u},S5:function(){return g},X8:function(){return m},gk:function(){return c}}),n(2526),n(1817),n(1539),n(6699),n(2023),n(6992),n(189),n(8783),n(3948),n(1038),n(2707),n(2165),n(7042),n(8309),n(4916);var r=n(1640),o=n(613),i=n(1799);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=0,c=1,f=[3,2],h=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],d=Symbol("root"),p=Symbol("child");function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;if(t!==d&&t!==p)throw Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(e),o=t===d,i=u;if(n){var a=e[0];0===e.length?i=c:o&&a instanceof r.Z?i=3:o&&Array.isArray(a)?i=y(a,p):e.length>=2&&e.length<=4&&!e.some(function(e,t){return!h[t].includes(s(e))})&&(i=2)}return i}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.keepDirection,r=void 0!==n&&n,o=t.propToCol;if(!f.includes(e))throw Error("Unsupported selection ranges schema type was provided.");return function(t){var n=3===e,a=n?t.from.row:t[0],l=n?t.from.col:t[1],s=n?t.to.row:t[2],u=n?t.to.col:t[3];if("function"==typeof o&&("string"==typeof l&&(l=o(l)),"string"==typeof u&&(u=o(u))),(0,i.o8)(s)&&(s=a),(0,i.o8)(u)&&(u=l),!r){var c=a,f=l,h=s,d=u;a=Math.min(c,h),l=Math.min(f,d),s=Math.max(c,h),u=Math.max(f,d)}return[a,l,s,u]}}function m(e){var t=y(e);if(t===u||t===c)return[];var n=g(t),r=new Set;(0,o.Bk)(e,function(e){var t=a(n(e),4),i=t[1],l=t[3],s=Math.max(i,0);(0,o.Bk)(Array.from(Array(l-s+1),function(e,t){return s+t}),function(e){r.has(e)||r.add(e)})});var i=Array.from(r).sort(function(e,t){return e-t});return(0,o.k$)(i,function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e},[])}function b(e){var t=y(e);if(t===u||t===c)return[];var n=g(t),r=new Set;(0,o.Bk)(e,function(e){var t=a(n(e),3),i=t[0],l=t[2],s=Math.max(i,0);(0,o.Bk)(Array.from(Array(l-s+1),function(e,t){return s+t}),function(e){r.has(e)||r.add(e)})});var i=Array.from(r).sort(function(e,t){return e-t});return(0,o.k$)(i,function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e},[])}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof e&&e>=0&&e<t}},8524:function(e,t,n){"use strict";n.d(t,{U:function(){return C}});var r,o,i=n(8722);n(3371),n(2526),n(1817),n(2165),n(8783),n(8309),n(1038),n(4916),n(2222),n(6992),n(1539),n(3948),n(4747),n(4553),n(561),n(7327),n(7042),n(1532),n(9600),n(2707),n(1249);var a=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),l=function(e){return e.map(function(e){var t=e.toLowerCase();return a.has(t)?a.get(t):t}).sort().join("+")},s=function(e){return e.toLowerCase()},u=n(1799),c=n(7161),f=n(7772),h=n(8336);function d(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e){var t=(0,i.I)({errorIdExists:function(t){return'The "'.concat(t,'" shortcut is already registered in the "').concat(e,'" context.')}}),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.keys,r=e.callback,i=e.group,a=e.runOnlyIf,s=e.captureCtrl,f=e.preventDefault,d=e.stopPropagation,p=e.relativeToGroup,y=e.position;if((0,u.o8)(i))throw Error("You need to define the shortcut's group.");if(!1===(0,c.mf)(r))throw Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(n))throw Error((0,h.e)(o||(o=Object.freeze(Object.defineProperties(["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],{raw:{value:Object.freeze(["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."])}})))));var g={callback:r,group:i,runOnlyIf:void 0===a?function(){return!0}:a,captureCtrl:void 0!==s&&s,preventDefault:void 0===f||f,stopPropagation:void 0!==d&&d};if((0,u.$K)(p)){var m=[p,y];g.relativeToGroup=m[0],g.position=m[1]}n.forEach(function(e){var n=l(e);if(t.hasItem(n)){var r=t.getItem(n),o=r.findIndex(function(e){return e.group===p});-1!==o?"before"===y?o-=1:o+=1:o=r.length,r.splice(o,0,g)}else t.addItem(n,[g])})},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach(function(e){(0,f._l)(t,function(n,r){!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])}),n(e)})},a=function(e){var n=l(e);t.removeItem(n)},s=function(e){t.getItems().forEach(function(t){var n=function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(t,2)||d(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r=n[0],o=n[1],i=o.filter(function(t){return t.group!==e});0===i.length?a(r.split("+")):(o.length=0,o.push.apply(o,function(e){if(Array.isArray(e))return p(e)}(i)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||d(i)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))})};return{addShortcut:n,addShortcuts:r,getShortcuts:function(e){var n=l(e),r=t.getItem(n);return(0,u.$K)(r)?r.slice():[]},hasShortcut:function(e){var n=l(e);return t.hasItem(n)},removeShortcutsByKeys:a,removeShortcutsByGroup:s}};n(6699),n(2023),n(189);var g=n(8539),m=n(766),b=n(9931),w=["meta","alt","shift","control"],S=(r=new Set,{press:function(e){r.add(e)},release:function(e){r.delete(e)},releaseAll:function(){r.clear()},isPressed:function(e){return r.has(e)}}),C=function(e){var t,n,r,o,a,l,u=e.ownerWindow,c=e.handleEvent,f=e.beforeKeyDown,h=e.afterKeyDown,d=(0,i.I)({errorIdExists:function(e){return'The "'.concat(e,'" context name is already registered.')}}),p="grid",C=function(e){var t=y(e);return d.addItem(e,t),t},O=function(){return p},R=function(e){return d.getItem(e)},T=function(e){p=e},k=!1,E=(t=function(e,t){var n=R(O()),r=!1;if(!n.hasShortcut(t))return r;for(var o=n.getShortcuts(t),i=0;i<o.length;i++){var a=o[i],l=a.callback,s=a.runOnlyIf,u=a.preventDefault,c=a.stopPropagation,f=a.captureCtrl;if(!1!==s(e)&&(k=f,r=!1===l(e,t),k=!1,u&&e.preventDefault(),c&&e.stopPropagation(),r))break}return r},n=function(e){return w.includes(e)},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},o=function(e){if(!1!==c(e)){var o=f(e);if(!(229===e.keyCode||!1===o||(0,g.Ty)(e))){var i=s(e.key),a=[];n(i)?S.press(i):a=r(e);var l=[i].concat(a);!t(e,l)&&((0,b.eE)()&&a.includes("meta")||!(0,b.eE)()&&a.includes("control"))&&t(e,[i].concat(r(e,!0))),h(e)}}},a=function(e){if(!1!==c(e)){var t=s(e.key);!1!==n(t)&&S.release(t)}},l=function(){S.releaseAll()},{mount:function(){for(var e=u;e;)e.document.documentElement.addEventListener("keydown",o),e.document.documentElement.addEventListener("keyup",a),e.document.documentElement.addEventListener("blur",l),e=(0,m.f5)(e)},unmount:function(){for(var e=u;e;)e.document.documentElement.removeEventListener("keydown",o),e.document.documentElement.removeEventListener("keyup",a),e.document.documentElement.removeEventListener("blur",l),e=(0,m.f5)(e)},isPressed:function(e){return S.isPressed(e)}});return E.mount(),{addContext:C,getActiveContextName:O,getContext:R,setActiveContextName:T,isCtrlPressed:function(){return!k&&(E.isPressed("control")||E.isPressed("meta"))},destroy:function(){return E.unmount()}}}},6284:function(e,t,n){"use strict";n.d(t,{Z:function(){return nT}}),n(6992),n(1539),n(8783),n(4129),n(3948),n(3161),n(9653),n(2526),n(1817),n(2165),n(1038),n(7042),n(8309),n(4916);var r,o=n(766),i=n(6487),a=n(8539);n(8304),n(489),n(2419),n(2564),n(6699);var l=n(7161),s=n(5965),u=n(9931),c=n(1799);function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=new WeakMap,d=function(){var e,t;function n(e,t,r,o,i,a){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.wtSettings=r,this.domBindings=t,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=e,h.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return e=[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(t){return e.onContextMenu(t)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(t){return e.onMouseOut(t)});var t=function(){e.eventManager.addEventListener(e.wtTable.holder,"touchstart",function(t){return e.onTouchStart(t)}),e.eventManager.addEventListener(e.wtTable.holder,"touchend",function(t){return e.onTouchEnd(t)}),e.momentumScrolling||(e.momentumScrolling={}),e.eventManager.addEventListener(e.wtTable.holder,"scroll",function(){clearTimeout(e.momentumScrolling._timeout),e.momentumScrolling.ongoing||e.wtSettings.getSetting("onBeforeTouchScroll"),e.momentumScrolling.ongoing=!0,e.momentumScrolling._timeout=setTimeout(function(){e.touchApplied||(e.momentumScrolling.ongoing=!1,e.wtSettings.getSetting("onAfterMomentumScroll"))},200)})};(0,u.K1)()?t():((0,s.JS)()&&t(),e.eventManager.addEventListener(e.wtTable.holder,"mouseup",function(t){return e.onMouseUp(t)}),e.eventManager.addEventListener(e.wtTable.holder,"mousedown",function(t){return e.onMouseDown(t)}))}},{key:"selectedCellWasTouched",value:function(e){var t=h.get(this),n=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&n){var r=[n.row,t.selectedCellBeforeTouchEnd.from.row],o=r[0],i=r[1],a=[n.col,t.selectedCellBeforeTouchEnd.from.col],l=a[0],s=a[1];return o===i&&l===s}return!1}},{key:"parentCell",value:function(e){var t={},n=this.wtTable.TABLE,r=(0,o.W6)(e,["TD","TH"],n);return r?(t.coords=this.wtTable.getCoords(r),t.TD=r):(0,o.pv)(e,"wtBorder")&&(0,o.pv)(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):(0,o.pv)(e,"wtBorder")&&(0,o.pv)(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}},{key:"onMouseDown",value:function(e){var t=h.get(this),n=this.domBindings.rootDocument.activeElement,r=(0,l.r$)(o.G_,e.target),i=e.target;if(i!==n&&r(0)!==n&&r(1)!==n){var a=this.parentCell(i);(0,o.pv)(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,i):a.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,a.coords,a.TD),(0===e.button||this.touchApplied)&&a.TD&&(t.dblClickOrigin[0]=a.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(function(){t.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(e){if(this.wtSettings.has("onCellContextMenu")){var t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}},{key:"onMouseOver",value:function(e){if(this.wtSettings.has("onCellMouseOver")){var t=this.wtTable.TABLE,n=(0,o.W6)(e.target,["TD","TH"],t),r=this.parent||this;n&&n!==r.lastMouseOver&&(0,o.MO)(n,t)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(n),n))}}},{key:"onMouseOut",value:function(e){if(this.wtSettings.has("onCellMouseOut")){var t=this.wtTable.TABLE,n=(0,o.W6)(e.target,["TD","TH"],t),r=(0,o.W6)(e.relatedTarget,["TD","TH"],t);n&&n!==r&&(0,o.MO)(n,t)&&this.callListener("onCellMouseOut",e,this.wtTable.getCoords(n),n)}}},{key:"onMouseUp",value:function(e){var t=h.get(this),n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),(0===e.button||this.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?((0,o.pv)(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(function(){t.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(e){h.get(this).selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var t,n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,o=(0,c.$K)(r)&&r.row>=0&&r.col>=0;e.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance")&&((0,u.gn)()&&((0,u.E6)()||(0,u.iF)())&&this.selectedCellWasTouched(n)&&!["A","BUTTON","INPUT"].includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()),this.onMouseUp(e),this.touchApplied=!1}},{key:"callListener",value:function(e,t,n,r){var o=this.wtSettings.getSettingPure(e);o&&o(t,n,r,this.facadeGetter())}},{key:"destroy",value:function(){var e=h.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}],f(n.prototype,e),t&&f(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();n(2222),n(4747);var p=n(613),y=n(1975);function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=function(){var e;function t(e,n,r){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.offset=e,this.total=n,this.countTH=r}return g(t.prototype,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e&&g(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){var e;function t(e,n,r){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.offset=e,this.total=n,this.countTH=r}return b(t.prototype,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e&&b(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){var e;function t(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return S(t.prototype,[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}]),e&&S(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var R=function(){var e,t;function n(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.size=new C,this.workingSpace=0,this.sharedSize=null}return e=[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof C}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}],O(n.prototype,e),t&&O(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k=function(){var e,t;function n(e,t,r){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.rootNode=e,this.nodesPool=t,this.sizeSet=new R,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return e=[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,t=this.sizeSet,n=0;if(this.isSharedViewSet())for(var r=e.firstElementChild;r;){if(r.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(1))break;r=r.nextElementSibling}else n=e.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,t=this.sizeSet,n=this.isSharedViewSet(),r=t.getViewSize().nextSize,o=this.getRenderedChildCount();o<r;){var i=this.nodesPool();!n||n&&t.isPlaceOn(2)?e.appendChild(i):e.insertBefore(i,e.firstChild),o+=1}for(var a=n&&t.isPlaceOn(1);o>r;)e.removeChild(a?e.firstChild:e.lastChild),o-=1}},{key:"render",value:function(){var e=this.rootNode,t=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(n+=t.sharedSize.nextSize);var r=e.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();e.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}],T(n.prototype,e),t&&T(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t){return(A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var H=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(o,e);var t,n,r=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=P(o);if(t){var r=P(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function o(){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return x(o.prototype,[{key:"prependView",value:function(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}]),n&&x(o,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(k);function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){var e;function t(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.nodeType=e.toUpperCase()}return M(t.prototype,[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e&&M(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var N=function(){var e;function t(e,n){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.nodesPool="string"==typeof e?new j(e):null,this.nodeType=e,this.rootNode=n,this.table=null,this.renderedNodes=0}return I(t.prototype,[{key:"setTable",value:function(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e&&I(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t){return(V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(i,e);var t,n,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=L(i);if(t){var r=L(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(){var e;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"TH")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new H(e,function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)},this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.rowHeaderFunctions,r=e.rowHeadersCount,o=e.rows,i=e.cells,a=0;a<t;a++){var l=this.table.renderedRowToSource(a),s=o.getRenderedNode(a);this.sourceRowIndex=l;var u=this.obtainOrderView(s),c=i.obtainOrderView(s);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<r;f++){u.render();var h=u.getCurrentNode();h.className="",h.removeAttribute("style"),n[f](l,h,f)}u.end()}}}],D(i.prototype,n),r&&D(i,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(N);function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e,t){return(z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(a,e);var t,n,r,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=U(a);if(t){var r=U(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===W(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),i.call(this,null,e)}return n=[{key:"adjust",value:function(){var e=this.table,t=e.columnHeadersCount,n=e.rowHeadersCount,r=this.rootNode.firstChild;if(t){for(var i=this.table.columnsToRender+n,a=0;a<t;a++){for((r=this.rootNode.childNodes[a])||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<i;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)r.removeChild(r.lastChild),this.renderedNodes-=1}var l=this.rootNode.childNodes.length;if(l>t)for(var s=t;s<l;s++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&(0,o.cS)(r)}},{key:"render",value:function(){for(var e=this.table.columnHeadersCount,t=0;t<e;t+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,i=n.rowHeadersCount,a=this.rootNode.childNodes[t],l=-1*i;l<o;l+=1){var s=this.table.renderedColumnToSource(l),u=a.childNodes[l+i];u.className="",u.removeAttribute("style"),r[t](s,u,t)}}}],F(a.prototype,n),r&&F(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(N);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t){return($=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(a,e);var t,n,r,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=X(a);if(t){var r=X(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===K(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),i.call(this,null,e)}return n=[{key:"adjust",value:function(){for(var e=this.table,t=e.columnsToRender+e.rowHeadersCount;this.renderedNodes<t;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>t;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,r=0;r<n;r++){var i=this.table.renderedColumnToSource(r),a=this.table.columnUtils.getHeaderWidth(i);this.rootNode.childNodes[r].style.width="".concat(a,"px")}for(var l=0;l<t;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[l+n].style.width="".concat(u,"px")}var c=this.rootNode.firstChild;c&&(0,o.cn)(c,"rowHeader")}}],q(a.prototype,n),r&&q(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(N);n(3371);var Z=n(3895),J=n(8336);function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function et(e,t){return(et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function en(e){return(en=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var er=!1,eo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&et(e,t)}(a,e);var t,n,o,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=en(a);if(t){var r=en(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,"TR",e)).orderView=new k(e,function(e){return t.nodesPool.obtain(e)},t.nodeType),t}return n=[{key:"getRenderedNode",value:function(e){return this.orderView.getNode(e)}},{key:"render",value:function(){var e=this.table.rowsToRender;!er&&e>1e3&&(er=!0,(0,Z.ZK)((0,J.e)(r||(r=Object.freeze(Object.defineProperties(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],{raw:{value:Object.freeze(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'])}})))))),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(var t=0;t<e;t++)this.orderView.render();this.orderView.end()}}],ee(a.prototype,n),o&&ee(a,o),Object.defineProperty(a,"prototype",{writable:!1}),a}(N);function ei(e){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function el(e,t){return(el=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function es(e){return(es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&el(e,t)}(a,e);var t,n,r,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=es(a);if(t){var r=es(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===ei(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){var e;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"TD")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new H(e,function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)},this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.columnsToRender,r=e.rows,i=e.rowHeaders,a=0;a<t;a++){var l=this.table.renderedRowToSource(a),s=r.getRenderedNode(a);this.sourceRowIndex=l;var u=this.obtainOrderView(s),c=i.obtainOrderView(s);u.prependView(c).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<n;f++){u.render();var h=u.getCurrentNode(),d=this.table.renderedColumnToSource(f);(0,o.pv)(h,"hide")||(h.className=""),h.removeAttribute("style"),h.removeAttribute("dir"),this.table.cellRenderer(l,d,h)}u.end()}}}],ea(a.prototype,n),r&&ea(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(N);function ec(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ef=function(){var e,t;function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.cellRenderer;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}return e=[{key:"setAxisUtils",value:function(e,t){this.rowUtils=e,this.columnUtils=t}},{key:"setViewportSize",value:function(e,t){this.rowsToRender=e,this.columnsToRender=t}},{key:"setFilters",value:function(e,t){this.rowFilter=e,this.columnFilter=t}},{key:"setHeaderContentRenderers",value:function(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowHeaders,n=e.columnHeaders,r=e.colGroup,o=e.rows,i=e.cells;t.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=i}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,t=this.rows,n=0;n<e;n++){var r=t.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),i=this.rowUtils.getHeight(o);i?r.firstChild.style.height="".concat(i-1,"px"):r.firstChild.style.height=""}}}}],ec(n.prototype,e),t&&ec(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function eh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ed=function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.TABLE,r=e.THEAD,o=e.COLGROUP,i=e.TBODY,a=e.rowUtils,l=e.columnUtils,s=e.cellRenderer;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.renderer=new ef(n,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new B,columnHeaders:new G(r),colGroup:new Y(o),rows:new eo(i),cells:new eu}),this.renderer.setAxisUtils(a,l)}return eh(t.prototype,[{key:"setFilters",value:function(e,t){return this.renderer.setFilters(e,t),this}},{key:"setViewportSize",value:function(e,t){return this.renderer.setViewportSize(e,t),this}},{key:"setHeaderContentRenderers",value:function(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e&&eh(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function ep(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(1532);var ey=function(){var e,t;function n(e,t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.dataAccessObject=e,this.wtSettings=t,this.headerWidths=new Map}return e=[{key:"getWidth",value:function(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(e){var t=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(e);if(t){var r=t.getStretchedColumnWidth(e,n);r&&(n=r)}return n}},{key:"getHeaderHeight",value:function(e){var t=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wtSettings,t=this.dataAccessObject,n=t.wtTable,r=t.wtViewport,i=t.cloneSource,a=i?i.wtTable.holder:n.holder,l=a.offsetHeight<a.scrollHeight?(0,o.np)():0,s=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-l),null!=(s=e.getSetting("onModifyRowHeaderWidth",s)))for(var u=e.getSetting("rowHeaders").length,c=e.getSetting("defaultColumnWidth"),f=0;f<u;f++){var h=Array.isArray(s)?s[f]:s;h=null==h?c:h,this.headerWidths.set(f,h)}}}],ep(n.prototype,e),t&&ep(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function ev(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var eg=function(){var e,t;function n(e,t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.dataAccessObject=e,this.wtSettings=t}return e=[{key:"getHeight",value:function(e){var t=this.wtSettings.getSetting("rowHeight",e),n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}}],ev(n.prototype,e),t&&ev(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}(),em="bottom",eb="inline_start",ew="top_inline_start_corner",eS="bottom_inline_start_corner",eC=["top",em,eb,ew,eS],eO=new Map([["top","ht_clone_".concat("top")],[em,"ht_clone_".concat(em)],[eb,"ht_clone_".concat(eb," ht_clone_left")],[ew,"ht_clone_".concat(ew," ht_clone_top_left_corner")],[eS,"ht_clone_".concat(eS," ht_clone_bottom_left_corner")]]);function eR(e,t){if(e){if("string"==typeof e)return eT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eT(e,t)}}function eT(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ek(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ex=function(){var e,t;function n(e,t,r,i,a){var l=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),eE(this,"wtSettings",null),eE(this,"domBindings",void 0),eE(this,"TBODY",null),eE(this,"THEAD",null),eE(this,"COLGROUP",null),eE(this,"hasTableHeight",!0),eE(this,"hasTableWidth",!0),eE(this,"isTableVisible",!1),eE(this,"tableOffset",0),eE(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===a,this.name=a,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,(0,o.Wu)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return l._modifyRowHeaderWidth(s)}),this.rowUtils=new eg(this.dataAccessObject,this.wtSettings),this.columnUtils=new ey(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ed({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return e=[{key:"is",value:function(e){return this.name===e}},{key:"fixTableDomTree",value:function(){var e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&(0,o.pv)(n,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",n&&n.insertBefore(t,e),t.appendChild(e)),t.style.position="relative",t}},{key:"createHider",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&(0,o.pv)(n,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(t,e),t.appendChild(e)),t}},{key:"createHolder",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&(0,o.pv)(n,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).style.position="relative",t.className="wtHolder",n&&n.insertBefore(t,e),this.isMaster&&(t.parentNode.className+="ht_master handsontable",t.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),t.appendChild(e)),t}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wtSettings,n=this.dataAccessObject,r=n.wtOverlays,i=n.wtViewport,a=t.getSetting("totalRows"),l=t.getSetting("totalColumns"),s=t.getSetting("rowHeaders"),u=s.length,c=t.getSetting("columnHeaders"),f=c.length,h=!1,d=e;if(this.isMaster&&(this.holderOffset=(0,o.cv)(this.holder),d=i.createRenderCalculators(d),u&&!t.getSetting("fixedColumnsStart"))){var p=r.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=0!==p,y!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),d)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=(0,o.cv)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var g=a>0?this.getFirstRenderedRow():0,b=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new w(g,a,f),this.columnFilter=new m(b,l,u);var S=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var C={};this.wtSettings.getSetting("beforeDraw",!0,C),S=!0!==C.skipRender}if(S){if(this.tableRenderer.setHeaderContentRenderers(s,c),(this.is(em)||this.is(eS))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(O=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(em))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var O,R=(0,o.iO)(this.hider),T=(0,o.iO)(this.TABLE);0!==R&&T!==R&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),O!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(em)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var k=!1;return this.isMaster&&(k=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(k=r.bottomOverlay.resetFixedPosition()||k),k=r.inlineStartOverlay.resetFixedPosition()||k,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),k?(r.refreshAll(),r.adjustElementsSize()):this.refreshSelections(d),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(e){for(var t,n,r,i=this.columnFilter.renderedToSource(e),a=this.wtSettings.getSetting("columnHeaders").length,l=this.wtSettings.getSetting("defaultRowHeight"),s=this.wtSettings.getSetting("columnHeaderHeight")||[];a;)a-=1,t=this.getColumnHeaderHeight(a),(n=this.getColumnHeader(i,a))&&(r=(0,o.WS)(n),(!t&&l<r||t<r)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=r),Array.isArray(s)?null!==s[a]&&void 0!==s[a]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=s[a]):isNaN(s)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=s),this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]<(s[a]||s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[a]=s[a]||s))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wtSettings,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders"),o=0,i=r.length;o<i;o++)if(n[o]){if(!t[o]||0===t[o].childNodes.length)return;t[o].childNodes[0].style.height="".concat(n[o],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport;if((this.isMaster||this.is(em))&&!e.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),r=0;r<n;r++){var o=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[o]&&(t.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll(".".concat(e)),n=0,r=t.length;n<r;n++)(0,o.IV)(t[n],e)}},{key:"refreshSelections",value:function(e){var t=this.wtSettings,n=this.dataAccessObject.selections;if(n){var r=Array.from(n),o=r.length;if(e){for(var i=[],a=0;a<o;a++){for(var l=r[a].settings,s=l.highlightHeaderClassName,u=l.highlightRowClassName,c=l.highlightColumnClassName,f=r[a].classNames,h=f.length,d=0;d<h;d++)i.includes(f[d])||i.push(f[d]);s&&!i.includes(s)&&i.push(s),u&&!i.includes(u)&&i.push(u),c&&!i.includes(c)&&i.push(c)}var p=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(p))for(var y=0;y<p.length;y++)i.push(p[y]);for(var g=i.length,m=0;m<g;m++)this.removeClassFromCells(i[m])}for(var b=0;b<o;b++)r[b].draw(this.facadeGetter(),e)}}},{key:"getCell",value:function(e){var t,n=e.row,r=e.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(o&&Array.isArray(o)){var i=function(e){if(Array.isArray(e))return e}(o)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(o,2)||eR(o,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();n=i[0],r=i[1]}if(this.isRowBeforeRenderedRows(n))return -1;if(this.isRowAfterRenderedRows(n))return -2;if(this.isColumnBeforeRenderedColumns(r))return -3;if(this.isColumnAfterRenderedColumns(r))return -4;if(!(t=n<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)])&&n>=0)throw Error("TR was expected to be rendered but is not");var a=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!a&&r>=0)throw Error("TD or TH was expected to be rendered but is not");return a}},{key:"getColumnHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[t];return null==n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getColumnHeaders",value:function(e){var t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(function(e){var r=e.childNodes[n];r&&t.push(r)}),t}},{key:"getRowHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)&&!(t>=this.wtSettings.getSetting("rowHeaders").length)){var n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return null==n?void 0:n.childNodes[t]}}},{key:"getRowHeaders",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var t=[],n=this.wtSettings.getSetting("rowHeaders").length,r=0;r<n;r++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=null==o?void 0:o.childNodes[r];i&&t.push(i)}return t}},{key:"getCoords",value:function(e){var t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=(0,o.oq)(t,["TD","TH"])),null===t)return null;var n=t.parentNode,r=n.parentNode,i=(0,o.Kz)(n),a=t.cellIndex;return(0,o.mK)(ew,t,this.wtRootElement)||(0,o.mK)("top",t,this.wtRootElement)?"THEAD"===r.nodeName&&(i-=r.childNodes.length):i=(0,o.mK)(eS,t,this.wtRootElement)||(0,o.mK)(em,t,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-r.childNodes.length+i:r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i),a=(0,o.mK)(ew,t,this.wtRootElement)||(0,o.mK)(eb,t,this.wtRootElement)||(0,o.mK)(eS,t,this.wtRootElement)?this.columnFilter.offsettedTH(a):this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(i,a)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var e,t,n,r,i,a=this.TBODY.childNodes.length;if(a*this.wtSettings.getSetting("defaultRowHeight")!=(0,o.WS)(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;a;)a-=1,n=this.rowFilter.renderedToSource(a),e=this.getRowHeight(n),t=(i=(r=this.getTrForRow(n)).querySelector("th"))?(0,o.WS)(i):(0,o.WS)(r)-1,(!e&&this.wtSettings.getSetting("defaultRowHeight")<t||e<t)&&(t+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=t)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){return!(e>=0)&&Math.abs(e)<=this.wtSettings.getSetting("rowHeaders").length}},{key:"isRowHeaderRendered",value:function(e){return!(e>=0)&&Math.abs(e)<=this.wtSettings.getSetting("columnHeaders").length}},{key:"isRowBeforeRenderedRows",value:function(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&0>this.columnFilter.sourceToRendered(e)&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return(0,o.iO)(this.TABLE)}},{key:"getHeight",value:function(){return(0,o.Pb)(this.TABLE)}},{key:"getTotalWidth",value:function(){var e=(0,o.iO)(this.hider);return 0!==e?e:this.getWidth()}},{key:"getTotalHeight",value:function(){var e=(0,o.Pb)(this.hider);return 0!==e?e:this.getHeight()}},{key:"isVisible",value:function(){return(0,o.pn)(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var t,n=(0,l.mf)(e)?e():null;return Array.isArray(n)?(n=function(e){if(Array.isArray(e))return eT(e)}(t=n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||eR(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[n.length-1]=this._correctRowHeaderWidth(n[n.length-1]):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(e){var t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}],ek(n.prototype,e),t&&ek(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}(),eA=n(7772),eP={getFirstRenderedRow:function(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};(0,eA.jW)(eP,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var eH={getFirstRenderedColumn:function(){var e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn:function(){var e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getLastRenderedColumn:function(){var e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn:function(){var e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};function eM(e){return(eM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ej(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eI(e,t){return(eI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eN(e){return(eN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(0,eA.jW)(eH,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var e_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eI(e,t)}(i,e);var t,n,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=eN(i);if(t){var r=eN(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===eM(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(e,t,n,r){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),o.call(this,e,t,n,r,"top")}return n&&ej(i.prototype,n),r&&ej(i,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(ex);(0,eA.jB)(e_,eP),(0,eA.jB)(e_,eH),n(2772);var eD=n(9272);function eV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eB=function(){var e,t;function n(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),eL(this,"dataAccessObject",void 0),eL(this,"lastScrolledColumnPos",-1),eL(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}return e=[{key:"scrollViewport",value:function(e,t,n,r,o){var i=this.scrollViewportHorizontally(e.col,n,o),a=this.scrollViewportVertically(e.row,t,r);return i||a}},{key:"scrollViewportHorizontally",value:function(e,t,n){var r=this.dataAccessObject,o=r.drawn,i=r.totalColumns;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;var a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),s=void 0===t&&void 0===n,u=this.dataAccessObject,c=u.fixedColumnsStart,f=u.inlineStartOverlay;if(s&&e<c)return!1;var h=!1;return -1===a?h=f.scrollTo(e,s?e>this.lastScrolledColumnPos:t):(s&&(e<a||e>l)||!s)&&(h=f.scrollTo(e,s?e>l:t)),h&&(this.lastScrolledColumnPos=e),h}},{key:"scrollViewportVertically",value:function(e,t,n){var r=this.dataAccessObject,o=r.drawn,i=r.totalRows;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;var a=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),s=void 0===t&&void 0===n,u=this.dataAccessObject,c=u.fixedRowsBottom,f=u.fixedRowsTop,h=u.topOverlay;if(s&&(e<f||e>i-c-1))return!1;var d=!1;return -1===a?d=h.scrollTo(e,s?e>this.lastScrolledRowPos:n):(s&&(e<a||e>l)||!s)&&(d=h.scrollTo(e,s?e>l:n)),d&&(this.lastScrolledRowPos=e),d}},{key:"getFirstVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,r=e.wtViewport,i=e.totalRows,a=e.fixedRowsTop,l=e.rootWindow,s=n.getFirstVisibleRow();if(t.mainTableScrollableElement===l){var u=(0,o.cv)(n.wtRootElement),c=(0,o.WS)(n.hider),f=(0,o.WS)(l),h=(0,o.cx)(l,l);if(u.top+c-f<=h){var d=r.getColumnHeaderHeight();d+=t.sumCellSizes(0,a);for(var p=i;p>0;p--)if(d+=t.sumCellSizes(p-1,p),u.top+c-d<=h){s=p;break}}}return s}},{key:"getLastVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,r=e.wtViewport,i=e.totalRows,a=e.rootWindow,l=n.getLastVisibleRow();if(t.mainTableScrollableElement===a){var s=(0,o.cv)(n.wtRootElement),u=(0,o.cx)(a,a);if(s.top>u){for(var c=(0,o.WS)(a),f=r.getColumnHeaderHeight(),h=1;h<=i;h++)if(f+=t.sumCellSizes(h-1,h),s.top+f-u>=c){l=h-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,r=e.wtViewport,i=e.totalColumns,a=e.rootWindow,l=n.getFirstVisibleColumn();if(t.mainTableScrollableElement===a){var s=(0,o.cv)(n.wtRootElement),u=(0,o.x9)(n.hider),c=(0,o.x9)(a),f=Math.abs((0,o.vj)(a,a));if(s.left+u-c<=f){for(var h=r.getRowHeaderWidth(),d=i;d>0;d--)if(h+=t.sumCellSizes(d-1,d),s.left+u-h<=f){l=d;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,r=e.wtViewport,i=e.totalColumns,a=e.rootWindow,l=n.getLastVisibleColumn();if(t.mainTableScrollableElement===a){var s=(0,o.cv)(n.wtRootElement),u=Math.abs((0,o.vj)(a,a));if(s.left>u){for(var c=(0,o.x9)(a),f=r.getRowHeaderWidth(),h=1;h<=i;h++)if(f+=t.sumCellSizes(h-1,h),s.left+f-u>=c){l=h-2;break}}}return l}}],eV(n.prototype,e),t&&eV(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}(),eW=n(9368),eF=n(1640);function ez(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eU(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eG=function(){var e,t;function n(e,t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),eU(this,"wtTable",void 0),eU(this,"wtScroll",void 0),eU(this,"wtViewport",void 0),eU(this,"wtOverlays",void 0),eU(this,"selections",void 0),eU(this,"wtEvent",void 0),eU(this,"guid","wt_".concat((0,eD.O1)())),eU(this,"drawInterrupted",!1),eU(this,"drawn",!1),eU(this,"domBindings",void 0),eU(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new eB(this.createScrollDao())}return e=[{key:"eventManager",get:function(){return new i.Z(this)}},{key:"findOriginalHeaders",value:function(){var e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){(0,o.tT)(n,e[t])}])}}},{key:"createCellCoords",value:function(e,t){return new eW.Z(e,t,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(e,t,n){return new eF.Z(e,t,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);else if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e);return this.wtTable.getCell(e)}},{key:"scrollViewport",value:function(e,t,n,r,o){return!(e.col<0)&&!(e.row<0)&&this.wtScroll.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(v){e.drawn=v},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}],ez(n.prototype,e),t&&ez(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function eK(e){return(eK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e$(e,t){return(e$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eX(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eY(e){return(eY=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eZ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e$(e,t)}(i,e);var t,n,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=eY(i);if(t){var r=eY(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===eK(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return eX(e)}(this,e)});function i(e,t,n){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),eZ(eX(r=o.call(this,e,t)),"cloneSource",void 0),eZ(eX(r),"cloneOverlay",void 0);var r,a=r.wtSettings.getSetting("facade",eX(r));return r.cloneSource=n.source,r.cloneOverlay=n.overlay,r.wtTable=r.cloneOverlay.createTable(r.getTableDao(),a,r.domBindings,r.wtSettings),r.wtViewport=n.viewport,r.selections=n.selections,r.wtEvent=new d(a,r.domBindings,r.wtSettings,r.eventManager,r.wtTable,r.selections,n.event),r.findOriginalHeaders(),r}return n&&eq(i.prototype,n),r&&eq(i,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(eG);function eQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var e0=function(){var e,t;function n(e,t,r,i,a){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),l=this,(s="wtSettings")in l?Object.defineProperty(l,s,{value:null,enumerable:!0,configurable:!0,writable:!0}):l[s]=null,(0,eA.jW)(this,"wot",e,{writable:!1}),this.domBindings=a,this.facadeGetter=t,this.wtSettings=i;var l,s,u=this.wot.wtTable,c=u.TABLE,f=u.hider,h=u.spreader,d=u.holder,p=u.wtRootElement;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=c,this.hider=f,this.spreader=h,this.holder=d,this.wtRootElement=p,this.trimmingContainer=(0,o.$g)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return e=[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=(0,o.$g)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,o.dD)(e.TABLE)}},{key:"getRelativeCellPosition",value:function(e,t,n){if(!1===this.clone.wtTable.holder.contains(e)){(0,Z.ZK)("The provided element is not a child of the ".concat(this.type," overlay"));return}var r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),i=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,s={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};return r?this.getRelativeCellPositionWithinWindow(i,o,u,s):this.getRelativeCellPositionWithinHolder(i,a,o,u,s)}},{key:"getRelativeStartPosition",value:function(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(e,t,n,r){var i=this.wot.wtTable.wtRootElement.getBoundingClientRect(),a=0,l=0;if(t){var s=i.left;this.isRtl()&&(s=this.domBindings.rootWindow.innerWidth-(i.left+i.width+(0,o.np)())),a=s<=0?-1*s:0}else a=r.start;return l=e?this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:r.top,{start:n.start+a,top:n.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,t,n,r,o){var i={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},a=0,l=0;if(n||(a=i.horizontal-o.start),t){var s=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+s.top}else e||(l=i.vertical-o.top);return{start:r.start-a,top:r.top-l}}},{key:"makeClone",value:function(){if(-1===eC.indexOf(this.type))throw Error('Clone type "'.concat(this.type,'" is not supported.'));var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,i=n.createElement("DIV"),a=n.createElement("TABLE"),l=e.wtRootElement.parentNode;i.className="".concat(eO.get(this.type)," handsontable"),i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,a.className=e.TABLE.className,i.appendChild(a),l.appendChild(i);var s=this.wtSettings.getSetting("preventOverflow");return!0===s||"horizontal"===s&&"top"===this.type||"vertical"===s&&this.type===eb?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(l).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=(0,o.dD)(e.TABLE),new eJ(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,r=t.style,o=e.parentNode.style;(0,p.Bk)([n,r,o],function(e){e.width="",e.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}],eQ(n.prototype,e),t&&eQ(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function e1(e){return(e1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e2(e,t,n){return(e2=e8()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&e3(o,n.prototype),o}).apply(null,arguments)}function e9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e3(e,t){return(e3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function e6(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function e8(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function e7(e){return(e7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e4=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e3(e,t)}(a,e);var t,n,r,i=(t=e8(),function(){var e,n=e7(a);if(t){var r=e7(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===e1(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return e6(e)}(this,e)});function a(e,t,n,r){var o,l,s;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),(s="cachedFixedRowsTop")in(l=e6(o=i.call(this,e,t,"top",n,r)))?Object.defineProperty(l,s,{value:-1,enumerable:!0,configurable:!0,writable:!0}):l[s]=-1,o.cachedFixedRowsTop=o.wtSettings.getSetting("fixedRowsTop"),o}return n=[{key:"createTable",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return e2(e_,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode,t=this.domBindings.rootWindow,n=this.wtSettings.getSetting("preventOverflow"),r=0,i=!1;this.trimmingContainer!==t||n&&"vertical"===n?(r=this.getScrollPosition(),(0,o.WH)(e)):(i=Math.ceil(this.wot.wtTable.hider.getBoundingClientRect().bottom)===e.offsetHeight,r=this.getOverlayOffset(),(0,o.I2)(e,"0px","".concat(r,"px")));var a=this.adjustHeaderBordersPosition(r,i);return this.adjustElementsSize(),a}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo((0,o.DZ)(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wtSettings.getSetting("defaultRowHeight"),r=e,o=0;r<t;){var i=this.wot.wtTable.getRowHeight(r);o+=void 0===i?n:i,r+=1}return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,i=(0,o.np)(n),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===l){var s=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=i),s=Math.min(s,e.wtRootElement.scrollWidth),a.width="".concat(s,"px")}else a.width="";this.clone.wtTable.holder.style.width=a.width;var u=(0,o.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height="".concat(parseInt(t.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(0===e)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.wot,r=this.wtSettings,i=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=this.getTableParentOffset(),l=0;if(t&&this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1),t&&i.offsetHeight!==i.clientHeight&&(l=(0,o.np)(this.domBindings.rootDocument)),t){var s=r.getSetting("fixedRowsBottom"),u=r.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=n.wtViewport.getViewportHeight()-this.sumCellSizes(u-s,u),a+=1}else a+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,o.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight();(n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>r-o&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?(0,o.IV)(n,"emptyColumns"):(0,o.cn)(n,"emptyColumns");var r=!1;if(!t){var i=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==i,l=this.wtSettings.getSetting("columnHeaders");if((a||0===i)&&l.length>0){var s=(0,o.pv)(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||0===this.wtSettings.getSetting("totalRows")?((0,o.cn)(n,"innerBorderTop"),r=!s):((0,o.IV)(n,"innerBorderTop"),r=s)}}return r}}],e9(a.prototype,n),r&&e9(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(e0),e5={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tn(e,t){return(tn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function tr(e){return(tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(0,eA.jW)(e5,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var to=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tn(e,t)}(i,e);var t,n,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=tr(i);if(t){var r=tr(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===te(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(e,t,n,r){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),o.call(this,e,t,n,r,em)}return n&&tt(i.prototype,n),r&&tt(i,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(ex);function ti(e){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ta(e,t,n){return(ta=tc()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&ts(o,n.prototype),o}).apply(null,arguments)}function tl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ts(e,t){return(ts=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function tu(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tc(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function tf(e){return(tf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(0,eA.jB)(to,e5),(0,eA.jB)(to,eH);var th=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ts(e,t)}(a,e);var t,n,r,i=(t=tc(),function(){var e,n=tf(a);if(t){var r=tf(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===ti(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return tu(e)}(this,e)});function a(e,t,n,r){var o,l,s;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),(s="cachedFixedRowsBottom")in(l=tu(o=i.call(this,e,t,em,n,r)))?Object.defineProperty(l,s,{value:-1,enumerable:!0,configurable:!0,writable:!0}):l[s]=-1,o.cachedFixedRowsBottom=o.wtSettings.getSetting("fixedRowsBottom"),o}return n=[{key:"createTable",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return ta(to,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.domBindings.rootWindow,t=this.clone.wtTable.holder.parentNode;t.style.top="";var n=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom="".concat(n,"px"));var o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=this.domBindings.rootDocument,i=this.clone.wtTable.holder.parentNode,a=0;n.hasVerticalScroll()||(a+=n.getWorkspaceHeight()-t.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(a+=(0,o.np)(r)),i.style.bottom="".concat(a,"px")}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t?(t.scrollTo((0,o.DZ)(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wot,r=n.wtTable,o=n.wtSettings.getSetting("defaultRowHeight"),i=e,a=0;i<t;){var l=r.getRowHeight(i);a+=void 0===l?o:l,i+=1}return a}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=this.domBindings,i=r.rootDocument,a=r.rootWindow,l=(0,o.np)(i),s=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||"horizontal"===u){var c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=l),c=Math.min(c,t.wtRootElement.scrollWidth),s.width="".concat(c,"px")}else s.width="";this.clone.wtTable.holder.style.width=s.width;var f=(0,o.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(f=0),s.height="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var e=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(0===e)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,i=0;t&&r.offsetHeight!==r.clientHeight&&(i=(0,o.np)(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,o.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=this.domBindings.rootDocument.documentElement.clientHeight;(n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-i+r,0))>r-o&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders"),i=!1;if((n||0===t)&&r.length>0){var a=this.wot.wtTable.holder.parentNode,l=(0,o.pv)(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?((0,o.cn)(a,"innerBorderBottom"),i=!l):((0,o.IV)(a,"innerBorderBottom"),i=l)}return i}}],tl(a.prototype,n),r&&tl(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(e0),td={getFirstRenderedRow:function(){var e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow:function(){var e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getLastRenderedRow:function(){var e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow:function(){var e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};(0,eA.jW)(td,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var tp={getFirstRenderedColumn:function(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};function ty(e){return(ty="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tg(e,t){return(tg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function tm(e){return(tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(0,eA.jW)(tp,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});var tb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tg(e,t)}(i,e);var t,n,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=tm(i);if(t){var r=tm(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===ty(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(e,t,n,r){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),o.call(this,e,t,n,r,eb)}return n&&tv(i.prototype,n),r&&tv(i,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(ex);function tw(e){return(tw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tS(e,t,n){return(tS=tR()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&tO(o,n.prototype),o}).apply(null,arguments)}function tC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tO(e,t){return(tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function tR(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function tT(e){return(tT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(0,eA.jB)(tb,td),(0,eA.jB)(tb,tp);var tk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tO(e,t)}(a,e);var t,n,r,i=(t=tR(),function(){var e,n=tT(a);if(t){var r=tT(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===tw(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t,n,r){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),i.call(this,e,t,eb,n,r)}return n=[{key:"createTable",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return tS(tb,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot.wtTable;if(!this.needFullRender||!e.holder.parentNode)return!1;var t=this.domBindings.rootWindow,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow"),i=0;this.trimmingContainer!==t||r&&"horizontal"===r?(i=this.getScrollPosition(),(0,o.WH)(n)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,o.I2)(n,"".concat(i,"px"),"0px"));var a=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),a}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,(0,o.AQ)(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wtSettings.getSetting("defaultColumnWidth"),r=e,o=0;r<t;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,i=(0,o.np)(n),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===l){var s=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(s-=i),s=Math.min(s,e.wtRootElement.scrollHeight),a.height="".concat(s,"px")}else a.height="";this.clone.wtTable.holder.style.height=a.height;var u=(0,o.iO)(this.clone.wtTable.TABLE);a.width="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width="".concat(parseInt(t.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(0===e)this.spreader.style[t]="0";else throw Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,i=0;return t&&this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1),t&&r.offsetWidth!==r.clientWidth&&(i=(0,o.np)(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var e=this.wtSettings.getSetting("preventOverflow"),t=0;return e||this.trimmingContainer!==this.domBindings.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return Math.abs((0,o.vj)(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;return this.trimmingContainer===e&&(!t||"horizontal"!==t)&&(n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0),n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),r=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?(0,o.IV)(t,"emptyRows"):(0,o.cn)(t,"emptyRows");var i=!1;if(r&&!n.length)(0,o.cn)(t,"innerBorderLeft innerBorderInlineStart");else if(!r&&n.length){var a=(0,o.pv)(t,"innerBorderInlineStart");e?((0,o.cn)(t,"innerBorderLeft innerBorderInlineStart"),i=!a):((0,o.IV)(t,"innerBorderLeft innerBorderInlineStart"),i=a)}return i}}],tC(a.prototype,n),r&&tC(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(e0);function tE(e){return(tE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tA(e,t){return(tA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function tP(e){return(tP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tA(e,t)}(i,e);var t,n,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=tP(i);if(t){var r=tP(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===tE(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(e,t,n,r){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),o.call(this,e,t,n,r,ew)}return n&&tx(i.prototype,n),r&&tx(i,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(ex);function tM(e){return(tM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tj(e,t,n){return(tj=tD()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&tN(o,n.prototype),o}).apply(null,arguments)}function tI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tN(e,t){return(tN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function t_(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tD(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function tV(e){return(tV=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,eA.jB)(tH,eP),(0,eA.jB)(tH,tp);var tB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tN(e,t)}(a,e);var t,n,r,i=(t=tD(),function(){var e,n=tV(a);if(t){var r=tV(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===tM(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return t_(e)}(this,e)});function a(e,t,n,r,o,l){var s;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),tL(t_(s=i.call(this,e,t,ew,n,r)),"topOverlay",void 0),tL(t_(s),"inlineStartOverlay",void 0),s.topOverlay=o,s.inlineStartOverlay=l,s}return n=[{key:"createTable",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return tj(tH,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var t=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();(0,o.I2)(e,"".concat(t,"px"),"".concat(n,"px"))}else(0,o.WH)(e);var r=(0,o.Pb)(this.clone.wtTable.TABLE),i=(0,o.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height="".concat(r,"px"),e.style.width="".concat(i,"px"),!1}}],tI(a.prototype,n),r&&tI(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(e0);function tW(e){return(tW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tz(e,t){return(tz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function tU(e){return(tU=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tG=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tz(e,t)}(i,e);var t,n,r,o=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=tU(i);if(t){var r=tU(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===tW(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(e,t,n,r){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),o.call(this,e,t,n,r,eS)}return n&&tF(i.prototype,n),r&&tF(i,r),Object.defineProperty(i,"prototype",{writable:!1}),i}(ex);function tK(e){return(tK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tq(e,t,n){return(tq=tY()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&tX(o,n.prototype),o}).apply(null,arguments)}function t$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tX(e,t){return(tX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function tY(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function tZ(e){return(tZ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(0,eA.jB)(tG,e5),(0,eA.jB)(tG,tp);var tJ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tX(e,t)}(a,e);var t,n,r,i=(t=tY(),function(){var e,n=tZ(a);if(t){var r=tZ(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===tK(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t,n,r,o,l){var s;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),(s=i.call(this,e,t,eS,n,r)).bottomOverlay=o,s.inlineStartOverlay=l,s}return n=[{key:"createTable",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return tq(tG,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var n=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]="".concat(n,"px"),t.style.bottom="".concat(r,"px")}else(0,o.WH)(t),this.repositionOverlay();var i=(0,o.Pb)(this.clone.wtTable.TABLE),a=(0,o.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),t.style.height="".concat(i,"px"),t.style.width="".concat(a,"px"),!1}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=this.domBindings.rootDocument,i=this.clone.wtTable.holder.parentNode,a=0;n.hasVerticalScroll()||(a+=n.getWorkspaceHeight()-t.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(a+=(0,o.np)(r)),i.style.bottom="".concat(a,"px")}}],t$(a.prototype,n),r&&t$(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(e0);function tQ(e,t,n){return(tQ=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&t0(o,n.prototype),o}:Reflect.construct.bind()).apply(null,arguments)}function t0(e,t){return(t0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function t1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t2(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var t9=function(){var e,t;function n(e,t,r,i,a,l){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),t2(this,"wot",null),t2(this,"topOverlay",null),t2(this,"bottomOverlay",null),t2(this,"inlineStartOverlay",null),t2(this,"topInlineStartCornerOverlay",null),t2(this,"bottomInlineStartCornerOverlay",null),t2(this,"browserLineHeight",void 0),t2(this,"wtSettings",null),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=t,this.wtTable=l;var s=this.domBindings,u=s.rootDocument,c=s.rootWindow;this.instance=this.wot,this.eventManager=a,this.scrollbarSize=(0,o.np)(u);var f="hidden"===c.getComputedStyle(l.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=f?l.holder:(0,o.dD)(l.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return e=[{key:"initBrowserLineHeight",value:function(){var e=this.domBindings,t=e.rootWindow,n=e.rootDocument,r=t.getComputedStyle(n.body),o=parseInt(r.lineHeight,10),i=1.2*parseInt(r.fontSize,10);this.browserLineHeight=o||i}},{key:"initOverlays",value:function(){var e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=tQ(e4,e),this.bottomOverlay=tQ(th,e),this.inlineStartOverlay=tQ(tk,e),this.topInlineStartCornerOverlay=tQ(tB,e.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=tQ(tJ,e.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var e,t=this,n=this.domBindings,r=n.rootDocument,o=n.rootWindow,i=this.topOverlay.mainTableScrollableElement,a=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(r.documentElement,"keydown",function(e){return t.onKeyDown(e)}),this.eventManager.addEventListener(r.documentElement,"keyup",function(){return t.onKeyUp()}),this.eventManager.addEventListener(r,"visibilitychange",function(){return t.onKeyUp()}),this.eventManager.addEventListener(i,"scroll",function(e){return t.onTableScroll(e)},{passive:!0}),i!==a&&this.eventManager.addEventListener(a,"scroll",function(e){return t.onTableScroll(e)},{passive:!0});var l=o.devicePixelRatio&&o.devicePixelRatio>1,s=this.scrollableElement===o,c=this.wtSettings.getSetting("preventWheel"),f={passive:s};(c||l||!(0,u.i7)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(e){return t.onCloneWheel(e,c)},f),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(function(e){if(e&&e.needFullRender){var n=e.clone.wtTable.holder;t.eventManager.addEventListener(n,"wheel",function(e){return t.onCloneWheel(e,c)},f)}}),this.eventManager.addEventListener(o,"resize",function(){clearTimeout(e),e=setTimeout(function(){t.wtSettings.getSetting("onWindowResize")},200)})}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;(!this.keyPressed||(r===t||o===t||e.target.contains(r))&&(n===t||o===t||e.target.contains(n)))&&this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,t){var n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target,a=o!==n&&i!==n&&!i.contains(o),l=r!==n&&i!==n&&!i.contains(r);if(!this.keyPressed||!a&&!l){var s=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&s)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=(0,y.ot)(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);var r=this.scrollVertically(t),o=this.scrollHorizontally(n);return r||o}},{key:"scrollVertically",value:function(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.domBindings.rootWindow,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],i=r[1];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;var a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=(0,o.dD)(e.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wtTable.spreader,n=t.clientWidth,r=t.clientHeight;(n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height)&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r,this.adjustElementsSize()),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot.wtViewport,n=this.wtTable,r=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),i=t.getRowHeaderWidth(),a=t.getColumnHeaderHeight(),l=n.hider.style;if(l.width="".concat(i+this.inlineStartOverlay.sumCellSizes(0,r),"px"),l.height="".concat(a+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var s=n.wtRootElement,u=s.scrollHeight,c=s.scrollWidth,f=n.holder,h=f.scrollHeight,d=f.scrollWidth;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(e){if(!e)return null;var t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],n=null;return(0,p.Bk)(t,function(t){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)}),n}},{key:"syncOverlayTableClassNames",value:function(){var e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,p.Bk)(t,function(t){t&&(t.clone.wtTable.TABLE.className=e.className)})}}],t1(n.prototype,e),t&&t1(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function t3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t6(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var t8=function(){var e,t;function n(e){var t=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),t6(this,"settings",{}),t6(this,"defaults",Object.freeze(this.getDefaults())),(0,eA._l)(this.defaults,function(n,r){if(void 0!==e[r])t.settings[r]=e[r];else if(void 0===n)throw Error('A required setting "'.concat(r,'" was not provided'));else t.settings[r]=n})}return e=[{key:"getDefaults",value:function(){var e=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return e.getSetting("fixedColumnsStart")>0||e.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return e.getSetting("fixedRowsTop")>0||e.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return e.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,n,r){var i=e.getSetting("data",t,n);(0,o.tT)(r,null==i?"":i)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(e){return e},onBeforeHighlightingColumnHeader:function(e){return e},onWindowResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(e,t){var n=this;return void 0===t?(0,eA._l)(e,function(e,t){n.settings[t]=e}):this.settings[e]=t,this}},{key:"getSetting",value:function(e,t,n,r,o){return"function"==typeof this.settings[e]?this.settings[e](t,n,r,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"getSettingPure",value:function(e){return this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}],t3(n.prototype,e),t&&t3(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function t7(e){return(t7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t5(e,t){return(t5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&t5(e,t)}(a,e);var t,n,r,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=ne(a);if(t){var r=ne(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===t7(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t,n,r){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),i.call(this,e,t,n,r,"master")}return n=[{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=(0,o.$g)(this.wtRootElement),t=this.domBindings.rootWindow;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var n=e.parentElement,r=(0,o.C2)(e,"height",t),i=(0,o.C2)(e,"overflow",t),a=this.holder.style,l=e.scrollWidth,s=e.scrollHeight,u=e.getBoundingClientRect(),c=u.width,f=u.height;if(n&&["auto","hidden","scroll"].includes(i)){var h=e.cloneNode(!1);h.style.overflow="auto",h.style.position="absolute",e.nextElementSibling?n.insertBefore(h,e.nextElementSibling):n.appendChild(h);var d=parseInt((0,o.Dx)(h,t).height,10);n.removeChild(h),0===d&&(f=0)}f=Math.min(f,s),a.height="auto"===r?"auto":"".concat(f,"px"),c=Math.min(c,l),a.width="".concat(c,"px"),a.overflow="",this.hasTableHeight="auto"===a.height||f>0,this.hasTableWidth=c>0}this.isTableVisible=(0,o.pn)(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport,n="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[n]){for(var o=e.getSetting("rowHeaders").length,i=this.getRenderedColumnsCount(),a=0;a<r;a++)for(var l=-1*o;l<i;l++)this.markIfOversizedColumnHeader(l);t.hasOversizedColumnHeadersMarked[n]=!0}}}],t4(a.prototype,n),r&&t4(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(ex);(0,eA.jB)(nt,td),(0,eA.jB)(nt,eH);var nn=n(6223),nr=n(1343),no=n(2792);function ni(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var na=function(){var e,t;function n(e,t,r,o,i){var a=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return e=[{key:"getWorkspaceHeight",value:function(){var e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;return t===this.domBindings.rootWindow?e.documentElement.clientHeight:(0,o.Pb)(t)>0&&t.clientHeight>0?t.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var e,t,n=this.wtSettings,r=this.domBindings,i=r.rootDocument,a=r.rootWindow,l=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,u=n.getSetting("totalColumns"),c=n.getSetting("preventOverflow"),f=n.getSetting("rtlMode"),h=this.wtTable.TABLE.getBoundingClientRect(),d=f?h.right-s:h.left,p=s-d;if(c)return(0,o.iO)(this.wtTable.wtRootElement);if(e=n.getSetting("freezeOverlays")?Math.min(p,s):Math.min(this.getContainerFillWidth(),p,s),l===a&&u>0&&this.sumColumnWidths(0,u-1)>e)return i.documentElement.clientWidth;if(l!==a&&("scroll"===(t=(0,o.C2)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",a))||"hidden"===t||"auto"===t))return Math.max(e,l.clientWidth);var y=n.getSetting("stretchH");return"none"!==y&&y?e:Math.max(e,(0,o.iO)(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){for(var n=0,r=e;r<t;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);var n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}},{key:"getWorkspaceOffset",value:function(){return(0,o.cv)(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,o.Pb)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}},{key:"getRowHeaderWidth",value:function(){var e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth)){if(t.length){var i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var a=0,l=t.length;a<l;a++)i?(this.rowHeaderWidth+=(0,o.iO)(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e}},{key:"createRowsCalculator",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nn.Ii,i=this.wtSettings,a=this.wtTable;this.rowHeaderWidth=NaN,e=i.getSetting("renderAllRows")&&r===nn.Ii?1/0:this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;l<0&&(l=0);var s=i.getSetting("fixedRowsTop"),u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");return s&&(l+=n=this.dataAccessObject.topOverlay.sumCellSizes(0,s),e-=n),u&&this.dataAccessObject.bottomOverlay.clone&&(e-=n=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c)),t=a.holder.clientHeight===a.holder.offsetHeight?0:(0,o.np)(this.domBindings.rootDocument),new nr.Z({viewportSize:e,scrollOffset:l,totalItems:i.getSetting("totalRows"),itemSizeFn:function(e){return a.getRowHeight(e)},overrideFn:i.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:t})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nn.Ii,t=this.wtSettings,n=this.wtTable,r=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,i<0&&(i=0);var a=t.getSetting("fixedColumnsStart");if(a){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);i+=l,r-=l}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=(0,o.np)(this.domBindings.rootDocument)),new no.Z({viewportSize:r,scrollOffset:Math.abs(i),totalItems:t.getSetting("totalColumns"),itemSizeFn:function(e){return n.getColumnWidth(e)},overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:function(e,n){return t.getSetting("onBeforeStretchingColumnWidth",e,n)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e;if(t){var n=this.createRowsCalculator(nn.vp),r=this.createColumnsCalculator(nn.vp);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(nn.Ii),this.columnsRenderCalculator=this.createColumnsCalculator(nn.Ii)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(nn.vp),this.columnsVisibleCalculator=this.createColumnsCalculator(nn.vp)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var t=e.startRow,n=e.endRow;if(null===t&&null===n)return!1;var r=this.rowsRenderCalculator,o=r.startRow,i=r.endRow;return!(t<o)&&(t!==o||!(t>0))&&!(n>i||n===i&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var t=e.startColumn,n=e.endColumn;if(null===t&&null===n)return!1;var r=this.columnsRenderCalculator,o=r.startColumn,i=r.endColumn;return!(t<o)&&(t!==o||!(t>0))&&!(n>i||n===i&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){(0,eA._l)(this.hasOversizedColumnHeadersMarked,function(e,t,n){n[t]=void 0})}}],ni(n.prototype,e),t&&ni(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function nl(e){return(nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ns(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nu(e,t){return(nu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function nc(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nf(e){return(nf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nu(e,t)}(i,e);var t,n,r=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=nf(i);if(t){var r=nf(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===nl(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return nc(e)}(this,e)});function i(e,t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i);var n,o=(n=r.call(this,e,new t8(t))).wtSettings.getSetting("facade",nc(n));return n.wtTable=new nt(n.getTableDao(),o,n.domBindings,n.wtSettings),n.wtViewport=new na(n.getViewportDao(),n.domBindings,n.wtSettings,n.eventManager,n.wtTable),n.selections=n.wtSettings.getSetting("selections"),n.wtEvent=new d(o,n.domBindings,n.wtSettings,n.eventManager,n.wtTable,n.selections),n.wtOverlays=new t9(nc(n),o,n.domBindings,n.wtSettings,n.eventManager,n.wtTable),n.exportSettingsAsClassNames(),n.findOriginalHeaders(),n}return ns(i.prototype,[{key:"exportSettingsAsClassNames",value:function(){var e=this,t=[],n=[];(0,eA._l)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},function(r,o){e.wtSettings.getSetting(o).length&&n.push(r),t.push(r)}),(0,o.IV)(this.wtTable.wtRootElement.parentNode,t),(0,o.cn)(this.wtTable.wtRootElement.parentNode,n)}},{key:"getViewportDao",value:function(){var e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}]),n&&ns(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(eG);function nd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var np=function(){var e,t;function n(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),e instanceof eG?this._wot=e:this._initFromSettings(e)}return e=[{key:"_initFromSettings",value:function(e){e.facade=function(e){var t=new n(e);return function(){return t}},this._wot=new nh(e.table,e)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(e){this._wot.drawn=e}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(e){this._wot.drawInterrupted=e}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(e){this._wot.lastMouseOver=e}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(e){this._wot.momentumScrolling=e}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(e){this._wot.touchApplied=e}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(e){this._wot.eventListeners=e}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(e,t){return this._wot.createCellCoords(e,t)}},{key:"createCellRange",value:function(e,t,n){return this._wot.createCellRange(e,t,n)}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}},{key:"scrollViewport",value:function(e,t,n,r,o){return this._wot.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(e,t){return this._wot.wtSettings.update(e,t),this}},{key:"getSetting",value:function(e,t,n,r,o){return this._wot.wtSettings.getSetting(e,t,n,r,o)}},{key:"hasSetting",value:function(e){return this._wot.wtSettings.hasSetting(e)}},{key:"destroy",value:function(){this._wot.destroy()}}],nd(n.prototype,e),t&&nd(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function ny(e){var t=e.isShiftKey,n=e.isLeftClick,r=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):c&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),h=n||r&&f;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}var nv=new Map([["mousedown",ny],["mouseover",function(e){var t=e.isLeftClick,n=e.coords,r=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),s=r.tableProps.countCols(),u=r.tableProps.countRows();l&&!o.column?r.setRangeEnd(i(u-1,n.col)):a&&!o.row?r.setRangeEnd(i(n.row,s-1)):o.cell||r.setRangeEnd(n)}}],["touchstart",ny]]);function ng(e,t){var n=t.coords,r=t.selection,o=t.controller,i=t.cellCoordsFactory;nv.get(e.type)({coords:n,selection:r,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:(0,a.pW)(e)||"touchstart"===e.type,isRightClick:(0,a.dO)(e)})}var nm=n(6728);function nb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(e,t)||nS(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nw(e){return function(e){if(Array.isArray(e))return nC(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||nS(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nS(e,t){if(e){if("string"==typeof e)return nC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nC(e,t)}}function nC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function nO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var nR=new WeakMap,nT=function(){var e,t;function n(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.instance=e,this.eventManager=new i.Z(e),this.settings=e.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this._wt=void 0,this.activeWt=void 0,this.postponedAdjustElementsSize=!1,nR.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return e=[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}},{key:"getCellAtCoords",value:function(e,t){var n=this._wt.getCell(e,t);return n<0?null:n}},{key:"scrollViewport",value:function(e,t,n,r,o){return this._wt.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}},{key:"createElements",value:function(){var e=nR.get(this),t=this.instance,n=t.rootElement,r=t.rootDocument,i=n.getAttribute("style");i&&n.setAttribute("data-originalstyle",i),(0,o.cn)(n,"handsontable"),e.table=r.createElement("TABLE"),(0,o.cn)(e.table,"htCore"),this.instance.getSettings().tableClassName&&(0,o.cn)(e.table,this.instance.getSettings().tableClassName),this.THEAD=r.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,t=nR.get(this),n=this.instance,r=n.rootElement,i=n.rootDocument,l=n.selection,s=i.documentElement;this.eventManager.addEventListener(r,"mousedown",function(n){if(t.selectionMouseDown=!0,!e.isTextSelectionAllowed(n.target)){var r=e.instance.rootWindow;(0,o.a7)(r),n.preventDefault(),r.focus()}}),this.eventManager.addEventListener(r,"mouseup",function(){t.selectionMouseDown=!1}),this.eventManager.addEventListener(r,"mousemove",function(n){t.selectionMouseDown&&!e.isTextSelectionAllowed(n.target)&&(e.settings.fragmentSelection&&(0,o.a7)(e.instance.rootWindow),n.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(e){l.isInProgress()&&!e.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(n){l.isInProgress()&&(0,a.pW)(n)&&l.finish(),t.mouseDown=!1,!(0,o.pV)(i.activeElement)&&(l.isSelected()||l.isSelectedByAnyHeader()||r.contains(n.target)||(0,a.dO)(n))||e.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(e){l.isInProgress()&&(0,a.dO)(e)&&(l.finish(),t.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),t.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(n){var a=n.target,l=n.x||n.clientX,u=n.y||n.clientY,c=n.target;if(!t.mouseDown&&r&&e.instance.view){var f=e.instance.view._wt.wtTable.holder;if(c===f){var h=(0,o.np)(i);if(i.elementFromPoint(l+h,u)!==f||i.elementFromPoint(l,u+h)!==f)return}else for(;c!==s;){if(null===c){if(n.isTargetWebComponent)break;return}if(c===r)return;c=c.parentNode}("function"==typeof e.settings.outsideClickDeselects?e.settings.outsideClickDeselects(a):e.settings.outsideClickDeselects)?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(t.table,"selectstart",function(t){e.settings.fragmentSelection||(0,o.u7)(t.target)||t.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(e){var t,n=e.row,r=e.col;return(t=this.instance)._createCellCoords.apply(t,nw(this.translateFromRenderableToVisualIndex(n,r)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,t){var n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}},{key:"countRenderableIndexes",value:function(e,t){var n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,t,n,r){if(isNaN(e)||e<0)return 0;var o=n.getNearestNotHiddenIndex(e,t),i=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;var a=0;return t<0?a=i+1:t>0&&(a=r-i),a}},{key:"countNotHiddenFixedColumnsStart",value:function(){var e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var e=Math.max(this.instance.countRows()-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}},{key:"initializeWalkontable",value:function(){var e=this,t=nR.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,isDataViewInstance:function(){return(0,nm._v)(e.instance)},preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(t,n){var r;return(r=e.instance).getDataAtCell.apply(r,nw(e.translateFromRenderableToVisualIndex(t,n)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsStart:function(){return e.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return e.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return e.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return e.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var t=[];return e.instance.hasRowHeaders()&&t.push(function(t,n){var r=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;e.appendRowHeader(r,n)}),e.instance.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.instance.hasColHeaders()&&t.push(function(t,n){var r=t>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;e.appendColHeader(r,n)}),e.instance.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:function(t){var n=e.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getColWidth(null===n?t:n)},rowHeight:function(t){var n=e.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getRowHeight(null===n?t:n)},cellRenderer:function(t,n,r){var o=nb(e.translateFromRenderableToVisualIndex(t,n),2),i=o[0],a=o[1],l=e.instance.runHooks("modifyGetCellCoords",i,a),s=i,u=a;if(Array.isArray(l)){var c=nb(l,2);s=c[0],u=c[1]}var f=e.instance.getCellMeta(s,u),h=e.instance.colToProp(u),d=e.instance.getDataAtRowProp(s,h);e.instance.hasHook("beforeValueRender")&&(d=e.instance.runHooks("beforeValueRender",d,f)),e.instance.runHooks("beforeRenderer",r,i,a,h,d,f),e.instance.getCellRenderer(f)(e.instance,r,i,a,h,d,f),e.instance.runHooks("afterRenderer",r,i,a,h,d,f)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,i){var l=e.translateFromRenderableToVisualCoords(r),s={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=i,t.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",n,l,o,s),(0,a.Ty)(n)||(ng(n,{coords:l,selection:e.instance.selection,controller:s,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseDown",n,l,o),e.activeWt=e._wt)},onCellContextMenu:function(n,r,o,i){var l=e.translateFromRenderableToVisualCoords(r);e.activeWt=i,t.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",n,l,o),(0,a.Ty)(n)||(e.instance.runHooks("afterOnCellContextMenu",n,l,o),e.activeWt=e._wt)},onCellMouseOut:function(t,n,r,o){var i=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseOut",t,i,r),(0,a.Ty)(t)||(e.instance.runHooks("afterOnCellMouseOut",t,i,r),e.activeWt=e._wt)},onCellMouseOver:function(n,r,o,i){var l=e.translateFromRenderableToVisualCoords(r),s={row:!1,column:!1,cell:!1};e.activeWt=i,e.instance.runHooks("beforeOnCellMouseOver",n,l,o,s),(0,a.Ty)(n)||(t.mouseDown&&ng(n,{coords:l,selection:e.instance.selection,controller:s,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseOver",n,l,o),e.activeWt=e._wt)},onCellMouseUp:function(t,n,r,o){var i=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseUp",t,i,r),(0,a.Ty)(t)||e.instance.isDestroyed||(e.instance.runHooks("afterOnCellMouseUp",t,i,r),e.activeWt=e._wt)},onCellCornerMouseDown:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,n){return e.beforeRender(t,n)},onDraw:function(t){return e.afterRender(t)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(t,n,r){var o=e.instance.rowIndexMapper,i=o.getVisualFromRenderableIndex(t),a=e.instance.runHooks("beforeHighlightingRowHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onBeforeHighlightingColumnHeader:function(t,n,r){var o=e.instance.columnIndexMapper,i=o.getVisualFromRenderableIndex(t),a=e.instance.runHooks("beforeHighlightingColumnHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onAfterDrawSelection:function(t,n,r){var o,i=nb(e.translateFromRenderableToVisualIndex(t,n),2),a=i[0],l=i[1],s=e.instance.selection.getSelectedRange(),u=s.size();if(u>0){var c=s.peekByIndex((null!=r?r:0)+1-u);o=[c.from.row,c.from.col,c.to.row,c.to.col]}return e.instance.runHooks("afterDrawSelection",a,l,o,r)},onBeforeDrawBorders:function(t,n){var r=nb(t,4),o=r[0],i=r[1],a=r[2],l=r[3],s=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(o),e.instance.columnIndexMapper.getVisualFromRenderableIndex(i),e.instance.rowIndexMapper.getVisualFromRenderableIndex(a),e.instance.columnIndexMapper.getVisualFromRenderableIndex(l)];return e.instance.runHooks("beforeDrawBorders",s,n)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){var r=e.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return e.instance.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:function(t){return e.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,n,r){var o=e.instance.rowIndexMapper,i=e.instance.columnIndexMapper,a=n>=0?i.getVisualFromRenderableIndex(n):n,l=t>=0?o.getVisualFromRenderableIndex(t):t,s=e.instance.runHooks("modifyGetCellCoords",l,a,r);if(Array.isArray(s)){var u=nb(s,4),c=u[0],f=u[1],h=u[2],d=u[3];return[c>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1)):c,f>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(f,1)):f,h>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1)):h,d>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(d,-1)):d]}},viewportRowCalculatorOverride:function(t){var n=e.settings.viewportRowRenderingOffset;if("auto"===n&&e.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=e.countRenderableRows(),o=t.startRow,i=t.endRow;if("number"==typeof n)t.startRow=Math.max(o-n,0),t.endRow=Math.min(i+n,r-1);else if("auto"===n){var a=Math.ceil(i/r*12);t.startRow=Math.max(o-a,0),t.endRow=Math.min(i+a,r-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var n=e.settings.viewportColumnRenderingOffset;if("auto"===n&&e.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){var r=e.countRenderableColumns(),o=t.startColumn,i=t.endColumn;if("number"==typeof n&&(t.startColumn=Math.max(o-n,0),t.endColumn=Math.min(i+n,r-1)),"auto"===n){var a=Math.ceil(i/r*6);t.startColumn=Math.max(o-a,0),t.endColumn=Math.min(i+a,r-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new np(n),this.activeWt=this._wt;var r=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),i=o.width,l=o.height;this.setLastSize(i,l),this.eventManager.addEventListener(r,"mousedown",function(e){e.target===r&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",function(e){e.target===r&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){e.settings.observeDOMVisibility&&e._wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())})}},{key:"isTextSelectionAllowed",value:function(e){if((0,o.u7)(e))return!0;var t=(0,o.MO)(e,this.instance.view._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&t||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return nR.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,t;return null!==(e=null===(t=this.instance.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&void 0!==e&&e}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}},{key:"afterRender",value:function(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;if(!(0,o.pv)(n,"relative")){(0,o.cS)(t),this.appendRowHeader(e,t);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var r=this.instance,i=r.rootDocument,a=r.getRowHeader,l=i.createElement("div"),s=i.createElement("span");l.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,a),l.appendChild(s),t.appendChild(l)}this.instance.runHooks("afterGetRowHeader",e,t)}},{key:"appendColHeader",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t.firstChild){var i=t.firstChild;(0,o.pv)(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),e,n):((0,o.cS)(t),this.appendColHeader(e,t,r))}else{var a=this.instance.rootDocument,l=a.createElement("div"),s=a.createElement("span");l.className="relative",s.className="colHeader",this.updateCellHeader(s,e,n),l.appendChild(s),t.appendChild(l)}this.instance.runHooks("afterGetColHeader",e,t,r)}},{key:"updateCellHeader",value:function(e,t,n){var r=t,i=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&((0,o.pv)(e,"colHeader")?r=i.wtTable.columnFilter.sourceToRendered(t):(0,o.pv)(e,"rowHeader")&&(r=i.wtTable.rowFilter.sourceToRendered(t))),r>-1?(0,o.uS)(e,n(t)):((0,o.tT)(e,String.fromCharCode(160)),(0,o.cn)(e,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}},{key:"maximumVisibleElementHeight",value:function(e){var t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}},{key:"setLastSize",value:function(e,t){var n=nR.get(this),r=[e,t];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var e=nR.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}],nO(n.prototype,e),t&&nO(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}()},350:function(e,t,n){"use strict";n.d(t,{d:function(){return q}}),n(7042),n(3371),n(2526),n(1817),n(2165),n(8309),n(4916),n(6992),n(1539),n(189),n(8783),n(3948),n(1532),n(1038),n(4553),n(5069),n(1249),n(7327),n(2772),n(6699),n(2023),n(3290);var r,o=n(613),i=n(8336),a=n(3895),l=n(1923),s=n(331),u=n(1496),c=n(7099),f=n(4165),h=n(7469),d=new Map([["hiding",s.o],["index",u.n],["linkedPhysicalIndexToValue",c.A],["physicalIndexToValue",f.L],["trimming",h.n]]),p=n(1023);n(8304),n(489),n(2419),n(4747);var y=n(1799),g=n(7772),m=n(5981);function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=0,S=function(){var e,t;function n(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.collection=new Map}return e=[{key:"register",value:function(e,t){var n=this;!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",function(){return n.runLocalHooks("change",t)}),w+=1)}},{key:"unregister",value:function(e){var t=this.collection.get(e);(0,y.$K)(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),w-=1)}},{key:"unregisterAll",value:function(){var e=this;this.collection.forEach(function(t,n){return e.unregister(n)}),this.collection.clear()}},{key:"get",value:function(e){return(0,y.o8)(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach(function(t){t.remove(e)})}},{key:"insertToEvery",value:function(e,t){this.collection.forEach(function(n){n.insert(e,t)})}},{key:"initEvery",value:function(e){this.collection.forEach(function(t){t.init(e)})}}],b(n.prototype,e),t&&b(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(0,g.jB)(S,m.Z);var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(a,e);var t,n,r,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=T(a);if(t){var r=T(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t){var n;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this)).mergedValuesCache=[],n.aggregationFunction=e,n.fallbackValue=t,n}return n=[{key:"getMergedValues",value:function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===e)return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=(0,o.Sc)(this.get(),function(e){return e.getValues()}),n=[],r=(0,y.$K)(t[0])&&t[0].length||0,i=0;i<r;i+=1){for(var a=[],l=0;l<this.getLength();l+=1)a.push(t[l][i]);n.push(a)}return(0,o.Sc)(n,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(e,t){var n=this.getMergedValues(t)[e];return(0,y.$K)(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}],O(a.prototype,n),r&&O(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(S);function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}n(4129);var A=new WeakMap,P=function(){var e,t;function n(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,A),A.set(this,{writable:!0,value:[]})}return e=[{key:"subscribe",value:function(e){var t;return this.addLocalHook("change",e),this._write((t=x(this,A,"get")).get?t.get.call(this):t.value),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(e){return e.length>0&&this.runLocalHooks("change",e),this}},{key:"_writeInitialChanges",value:function(e){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}})(this,x(this,A,"set"),e)}}],E(n.prototype,e),t&&E(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function H(e,t){for(var n=[],r=0,o=0;r<e.length&&o<t.length;r++,o++)e[r]!==t[o]&&n.push({op:"replace",index:o,oldValue:e[r],newValue:t[o]});for(;r<t.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;o<e.length;o++)n.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return n}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t,n){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function I(e,t){var n=_(e,t,"get");return n.get?n.get.call(e):n.value}function N(e,t,n){var r=_(e,t,"set");return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(e,r,n),n}function _(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}(0,g.jB)(P,m.Z);var D=new WeakMap,V=new WeakMap,L=new WeakMap,B=new WeakMap,W=new WeakMap,F=function(){var e,t;function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.initialIndexValue;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),j(this,D,{writable:!0,value:new Set}),j(this,V,{writable:!0,value:[]}),j(this,L,{writable:!0,value:[]}),j(this,B,{writable:!0,value:!1}),j(this,W,{writable:!0,value:!1}),N(this,W,null!=t&&t)}return e=[{key:"createObserver",value:function(){var e=this,t=new P;return I(this,D).add(t),t.addLocalHook("unsubscribe",function(){I(e,D).delete(t)}),t._writeInitialChanges(H(I(this,V),I(this,L))),t}},{key:"emit",value:function(e){var t=I(this,L);I(this,B)&&I(this,V).length===e.length||(0===e.length?e=Array(t.length).fill(I(this,W)):N(this,V,Array(e.length).fill(I(this,W))),I(this,B)||(N(this,B,!0),t=I(this,V)));var n=H(t,e);I(this,D).forEach(function(e){return e._write(n)}),N(this,L,e)}}],M(n.prototype,e),t&&M(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();function z(e){return function(e){if(Array.isArray(e))return U(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var K=new Set(["getFirstNotHiddenIndex"]),q=function(){var e,t;function n(){var e=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.indexesSequence=new l.b,this.trimmingMapsCollection=new k(function(e){return e.some(function(e){return!0===e})},!1),this.hidingMapsCollection=new k(function(e){return e.some(function(e){return!0===e})},!1),this.variousMapsCollection=new S,this.hidingChangesObservable=new F({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){e.indexesSequenceChanged=!0,e.updateCache(),e.runLocalHooks("change",e.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(t){e.trimmedIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",t,e.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(t){e.hiddenIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",t,e.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(t){e.runLocalHooks("change",t,e.variousMapsCollection)})}return e=[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(e){if("hiding"!==e)throw Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(e,t,n){return this.registerMap(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!d.has(e))throw Error('The provided map type ("'.concat(e,'") does not exist.'));return new(d.get(e))(t)}(t,n))}},{key:"registerMap",value:function(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof h.n?this.trimmingMapsCollection.register(e,t):t instanceof s.o?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);var n=this.getNumberOfIndexes();return n>0&&t.init(n),t}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(e){var t=this.notTrimmedIndexesCache[e];return(0,y.$K)(t)?t:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var t=this.renderablePhysicalIndexesCache[e];return(0,y.$K)(t)?t:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var t=this.fromPhysicalToVisualIndexesCache.get(e);return(0,y.$K)(t)?t:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var t=this.fromVisualToRenderableIndexesCache.get(e);return(0,y.$K)(t)?t:null}},{key:"getFirstNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e-t;K.has("getFirstNotHiddenIndex")&&(K.delete("getFirstNotHiddenIndex"),(0,a.ZK)((0,i.e)(r||(r=Object.freeze(Object.defineProperties(['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next \n                        major release. Please use "getNearestNotHiddenIndex" instead.'],{raw:{value:Object.freeze(['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20\n                        major release. Please use "getNearestNotHiddenIndex" instead.'])}}))))));var l=this.getPhysicalFromVisualIndex(e);return null===l?!0===n&&o!==e-t?this.getFirstNotHiddenIndex(o,-t,!1,o):null:!1===this.isHidden(l)?e:this.getFirstNotHiddenIndex(e+t,t,n,o)}},{key:"getNearestNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;var r=Array.from(this.fromVisualToRenderableIndexesCache.keys()),o=-1;return -1===(o=t>0?r.findIndex(function(t){return t>e}):r.reverse().findIndex(function(t){return t<e}))?n?this.getNearestNotHiddenIndex(e,-t,!1):null:r[o]}},{key:"initToLength",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=z(Array(e).keys()),this.notHiddenIndexesCache=z(Array(e).keys()),this.suspendOperations(),this.indexesSequence.init(e),this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(e){var t=this.getNumberOfIndexes();if(e<t){var n=z(Array(this.getNumberOfIndexes()-e).keys()).map(function(t){return t+e});this.removeIndexes(n)}else this.insertIndexes(t,e-t)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesSequence.setValues(e)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===t?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(function(t){return!1===e.isTrimmed(t)})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===t?this.notHiddenIndexesCache:this.getIndexesSequence().filter(function(t){return!1===e.isHidden(t)})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this,t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===t?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(function(t){return!1===e.isHidden(t)})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,t){var n=this;"number"==typeof e&&(e=[e]);var r=(0,o.Sc)(e,function(e){return n.getPhysicalFromVisualIndex(e)}),i=this.getNotTrimmedIndexesLength(),a=e.length,l=(0,p.t)(this.getIndexesSequence(),r),s=i-a;if(t+a<i){var u=l.filter(function(e){return!1===n.isTrimmed(e)})[t];s=l.indexOf(u)}this.setIndexesSequence((0,p.S)(l,s,r))}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,t){var n=this.getNotTrimmedIndexes()[e],r=(0,y.$K)(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),a=(0,o.Sc)(Array(t).fill(r),function(e,t){return e+t});this.suspendOperations(),this.indexesSequence.insert(i,a),this.trimmingMapsCollection.insertToEvery(i,a),this.hidingMapsCollection.insertToEvery(i,a),this.variousMapsCollection.insertToEvery(i,a),this.resumeOperations()}},{key:"removeIndexes",value:function(e){this.suspendOperations(),this.indexesSequence.remove(e),this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}},{key:"updateCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,t)}}}],G(n.prototype,e),t&&G(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}();(0,g.jB)(q,m.Z)},331:function(e,t,n){"use strict";n.d(t,{o:function(){return u}}),n(8304),n(489),n(1539),n(2419),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948);var r=n(4165),o=n(613);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(u,e);var t,n,r=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=s(u);if(t){var r=s(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,u),r.call(this,e)}return a(u.prototype,[{key:"getHiddenIndexes",value:function(){return(0,o.k$)(this.getValues(),function(e,t,n){return t&&e.push(n),e},[])}}]),n&&a(u,n),Object.defineProperty(u,"prototype",{writable:!1}),u}(r.L)},1496:function(e,t,n){"use strict";n.d(t,{n:function(){return s}}),n(7042);var r=n(2226),o=n(7772),i=n(7161),a=n(5981);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.indexedValues=[],this.initValueOrFn=e}return l(t.prototype,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var t=this.indexedValues;if(e<t.length)return t[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,i.mf)(this.initValueOrFn)?(0,r.q4)(t-1,function(t){return e.indexedValues.push(e.initValueOrFn(t))}):(0,r.q4)(t-1,function(){return e.indexedValues.push(e.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e&&l(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();(0,o.jB)(s,a.Z)},1923:function(e,t,n){"use strict";n.d(t,{b:function(){return f}}),n(8304),n(489),n(1539),n(2419),n(4819),n(5003),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948);var r=n(1496),o=n(1023),i=n(3166);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(h,e);var t,n,r,f=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=c(h);if(t){var r=c(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function h(){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,h),f.call(this,function(e){return e})}return n=[{key:"insert",value:function(e,t){var n=(0,i.X)(this.indexedValues,t);this.indexedValues=(0,o.S)(n,e,t),s(c(h.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=(0,o.t)(this.indexedValues,e);this.indexedValues=(0,i.i)(t,e),s(c(h.prototype),"remove",this).call(this,e)}}],l(h.prototype,n),r&&l(h,r),Object.defineProperty(h,"prototype",{writable:!1}),h}(r.n)},7099:function(e,t,n){"use strict";n.d(t,{A:function(){return y}}),n(2222),n(1249),n(6992),n(1539),n(3948),n(6699),n(2023),n(561),n(8304),n(489),n(2419),n(4819),n(5003),n(2526),n(1817),n(2165),n(8783),n(1038),n(7042),n(8309),n(4916);var r=n(1496),o=n(8863),i=n(1023),a=n(3166),l=n(7161);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(g,e);var t,n,r,y=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=p(g);if(t){var r=p(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return d(e)}(this,e)});function g(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,g);for(var e,t,n,r,o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return t=d(e=y.call.apply(y,[this].concat(i))),r=[],(n="orderOfIndexes")in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,e}return n=[{key:"getValues",value:function(){var e=this;return this.orderOfIndexes.map(function(t){return e.indexedValues[t]})}},{key:"setValues",value:function(e){var t;this.orderOfIndexes=function(e){if(Array.isArray(e))return u(e)}(t=Array(e.length).keys())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),f(p(g.prototype),"setValues",this).call(this,e)}},{key:"setValueAtIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(e){this.orderOfIndexes=(0,i.t)(this.orderOfIndexes,[e]),(0,l.mf)(this.initValueOrFn)?f(p(g.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn(e)):f(p(g.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,f(p(g.prototype),"setDefaultValues",this).call(this,e)}},{key:"insert",value:function(e,t){this.indexedValues=(0,o.S)(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=(0,a.X)(this.orderOfIndexes,t),f(p(g.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=(0,o.t)(this.indexedValues,e),this.orderOfIndexes=(0,i.t)(this.orderOfIndexes,e),this.orderOfIndexes=(0,a.i)(this.orderOfIndexes,e),f(p(g.prototype),"remove",this).call(this,e)}},{key:"getEntries",value:function(){var e=this;return this.orderOfIndexes.map(function(t){return[t,e.getValueAtIndex(t)]})}}],c(g.prototype,n),r&&c(g,r),Object.defineProperty(g,"prototype",{writable:!1}),g}(r.n)},4165:function(e,t,n){"use strict";n.d(t,{L:function(){return c}}),n(8304),n(489),n(1539),n(2419),n(4819),n(5003),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948);var r=n(1496),o=n(8863);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(f,e);var t,n,r,c=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=u(f);if(t){var r=u(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function f(){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,f),c.apply(this,arguments)}return n=[{key:"insert",value:function(e,t){this.indexedValues=(0,o.S)(this.indexedValues,e,t,this.initValueOrFn),l(u(f.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=(0,o.t)(this.indexedValues,e),l(u(f.prototype),"remove",this).call(this,e)}}],a(f.prototype,n),r&&a(f,r),Object.defineProperty(f,"prototype",{writable:!1}),f}(r.n)},7469:function(e,t,n){"use strict";n.d(t,{n:function(){return u}}),n(8304),n(489),n(1539),n(2419),n(2526),n(1817),n(2165),n(6992),n(8783),n(3948);var r=n(4165),o=n(613);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(u,e);var t,n,r=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=s(u);if(t){var r=s(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,u),r.call(this,e)}return a(u.prototype,[{key:"getTrimmedIndexes",value:function(){return(0,o.k$)(this.getValues(),function(e,t,n){return t&&e.push(n),e},[])}}]),n&&a(u,n),Object.defineProperty(u,"prototype",{writable:!1}),u}(r.L)},3166:function(e,t,n){"use strict";n.d(t,{X:function(){return i},i:function(){return o}}),n(7327),n(1539);var r=n(613);function o(e,t){return(0,r.Sc)(e,function(e){return e-t.filter(function(t){return t<e}).length})}function i(e,t){var n=t[0],o=t.length;return(0,r.Sc)(e,function(e){return e>=n?e+o:e})}},1023:function(e,t,n){"use strict";n.d(t,{S:function(){return a},t:function(){return l}}),n(2222),n(7042),n(6699),n(2023),n(2526),n(1817),n(1539),n(2165),n(6992),n(8783),n(3948),n(1038),n(8309),n(4916);var r=n(613);function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n){return[].concat(o(e.slice(0,t)),o(n),o(e.slice(t)))}function l(e,t){return(0,r.w7)(e,function(e){return!1===t.includes(e)})}},8863:function(e,t,n){"use strict";n.d(t,{S:function(){return l},t:function(){return s}}),n(2222),n(7042),n(1249),n(6699),n(2023),n(2526),n(1817),n(1539),n(2165),n(6992),n(8783),n(3948),n(1038),n(8309),n(4916);var r=n(7161),o=n(613);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n,o){var a=n.length?n[0]:void 0;return[].concat(i(e.slice(0,a)),i(n.map(function(e,t){return(0,r.mf)(o)?o(e,t):o})),i(void 0===a?[]:e.slice(a)))}function s(e,t){return(0,o.w7)(e,function(e,n){return!1===t.includes(n)})}},8722:function(e,t,n){"use strict";n.d(t,{I:function(){return s}}),n(6992),n(1532),n(1539),n(8783),n(3948),n(9826),n(2526),n(1817),n(2165),n(7042),n(8309),n(1038),n(4916);var r=n(7161);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(s){l=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(e,t)||i(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e){return"The id '".concat(e,"' is already declared in a map.")};function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorIdExists,n=new Map;function s(){return function(e){if(Array.isArray(e))return a(e)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||i(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return n.has(e)}return t=(0,r.mf)(t)?t:l,{addItem:function(e,r){if(u(e))throw Error(t(e));n.set(e,r)},clear:function(){n.clear()},getId:function(e){var t=s().find(function(t){var n=o(t,2),r=n[0];return e===n[1]&&r})||[null];return o(t,1)[0]},getItem:function(e){return n.get(e)},getItems:s,hasItem:u,removeItem:function(e){return n.delete(e)}}}},9906:function(e,t,n){"use strict";n.d(t,{BU:function(){return c},bt:function(){return u},vo:function(){return s}}),n(4603),n(4916),n(9714),n(9600),n(1249),n(7941),n(5306),n(1539),n(2222),n(561),n(4723),n(8670),n(5827),n(1038),n(8783),n(7327),n(4553),n(6699),n(2023),n(2526),n(1817),n(2165),n(6992),n(3948),n(7042),n(8309);var r=n(1799);function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var a={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},l=RegExp(Object.keys(a).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function s(e){for(var t=e.hasColHeaders(),n=e.hasRowHeaders(),o=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,o),a=i.length,l=a>0?i[0].length:0,s=["<table>","</table>"],u=t?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],f=n?1:0,h=t?1:0,d=0;d<a;d+=1){for(var p=t&&0===d,y=[],g=0;g<l;g+=1){var m=!p&&n&&0===g,b="";if(p)b="<th>".concat(e.getColHeader(g-f),"</th>");else if(m)b="<th>".concat(e.getRowHeader(d-h),"</th>");else{var w=i[d][g],S=e.getCellMeta(d-h,g-f),C=S.hidden,O=S.rowspan,R=S.colspan;if(!C){var T=[];if(O&&T.push('rowspan="'.concat(O,'"')),R&&T.push('colspan="'.concat(R,'"')),(0,r.xb)(w))b="<td ".concat(T.join(" "),"></td>");else{var k=w.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b="<td ".concat(T.join(" "),">").concat(k,"</td>")}}}y.push(b)}var E=["<tr>"].concat(y,["</tr>"]).join("");p?u.splice(1,0,E):c.splice(-1,0,E)}return s.splice(1,0,u.join(""),c.join("")),s.join("")}function u(e){for(var t=e.length,n=["<table>"],o=0;o<t;o+=1){var i=e[o],a=i.length,l=[];0===o&&n.push("<tbody>");for(var s=0;s<a;s+=1){var u=i[s],c=(0,r.xb)(u)?"":u.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l.push("<td>".concat(c,"</td>"))}n.push.apply(n,["<tr>"].concat(l,["</tr>"])),o+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function c(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r={},i=n.createDocumentFragment(),s=n.createElement("div");i.appendChild(s);var u=e;if("string"==typeof u){var c=u.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(e){var t=e.match(/<td\b[^>]*?>/g)[0],n=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(t).concat(n).concat("</td>")});s.insertAdjacentHTML("afterbegin","".concat(c)),u=s.querySelector("table")}if(u&&"TABLE"===((t=u)&&t.nodeName||"")){var f=s.querySelector('meta[name$="enerator"]'),h=null!==u.querySelector("tbody th"),d=u.querySelector("tr"),p=d?Array.from(d.cells).reduce(function(e,t){return e+t.colSpan},0)-(h?1:0):0,y=u.tFoot&&Array.from(u.tFoot.rows)||[],g=[],m=!1,b=0,w=0;if(u.tHead){var S=Array.from(u.tHead.rows).filter(function(e){var t=null!==e.querySelector("td");return t&&g.push(e),!t});m=(b=S.length)>0,b>1?r.nestedHeaders=Array.from(S).reduce(function(e,t){var n=Array.from(t.cells).reduce(function(e,t,n){if(h&&0===n)return e;var r=t.colSpan,o=t.innerHTML;return e.push(r>1?{label:o,colspan:r}:o),e},[]);return e.push(n),e},[]):m&&(r.colHeaders=Array.from(S[0].children).reduce(function(e,t,n){return h&&0===n||e.push(t.innerHTML),e},[]))}g.length&&(r.fixedRowsTop=g.length),y.length&&(r.fixedRowsBottom=y.length);for(var C=[].concat(g,o(Array.from(u.tBodies).reduce(function(e,t){return e.push.apply(e,o(Array.from(t.rows))),e},[])),o(y)),O=Array(w=C.length),R=0;R<w;R++)O[R]=Array(p);for(var T=[],k=[],E=0;E<w;E++)for(var x=Array.from(C[E].cells),A=x.length,P=0;P<A;P++){var H=x[P],M=H.nodeName,j=H.innerHTML,I=H.rowSpan,N=H.colSpan,_=O[E].findIndex(function(e){return void 0===e});if("TD"===M){if(I>1||N>1){for(var D=E;D<E+I;D++)if(D<w)for(var V=_;V<_+N;V++)O[D][V]=null;var L=H.getAttribute("style");L&&L.includes("mso-ignore:colspan")||T.push({col:_,row:E,rowspan:I,colspan:N})}var B="";B=f&&/excel/gi.test(f.content)?j.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):j.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),O[E][_]=B.replace(l,function(e){return a[e]})}else k.push(j)}return T.length&&(r.mergeCells=T),k.length&&(r.rowHeaders=k),O.length&&(r.data=O),r}}},6728:function(e,t,n){"use strict";n.d(t,{IU:function(){return i},_v:function(){return l},dU:function(){return a},mc:function(){return o}}),n(6992),n(1539),n(8783),n(4129),n(3948),n(2526),n(1817);var r=new WeakMap,o=Symbol("rootInstance");function i(e){r.set(e,!0)}function a(e){return e===o}function l(e){return r.has(e)}},8894:function(e,t,n){"use strict";n.d(t,{Ie:function(){return s},Te:function(){return l},oh:function(){return a}});var r=(0,n(4388).Z)("validators"),o=r.register,i=r.getItem,a=r.hasItem;function l(e){if("function"==typeof e)return e;if(!a(e))throw Error('No registered validator found under "'.concat(e,'" name'));return i(e)}function s(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),o(e,t)}r.getNames,r.getValues}}]);