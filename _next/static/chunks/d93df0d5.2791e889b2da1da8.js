"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{8194:function(e,t,o){o.d(t,{Z:function(){return Z}}),o(2526),o(1817),o(2165),o(8309),o(3371),o(6992),o(1539),o(189),o(8783),o(3948),o(6699),o(2707),o(561),o(3161),o(9653),o(7042),o(2222),o(3290),o(1249),o(4916),o(5306),o(1038),o(2772),o(5069),o(4747),o(2564),o(4633),o(1532);var r,n,l=o(766),a=o(7161),i=o(1799),s=o(9931),c=o(3895),u=o(8336),d=o(4020),h=o(6487),f=o(7772),g=o(613),m=o(9906),p=o(8298),w=o(9847),v=o(8894),C=o(9272),y=o(2226),R=o(6284),b=o(7002),S=o(3817),I=o(350),x=o(6728),M=o(2792),k=o(3909),_=o(183),A=o(8719),E=o(3431),H=o(2264),T=o(2654),D=o(7226),N=o(6068),V=o(8722),L=o(8524);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o,r,n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var l=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(l.push(o.value),!t||l.length!==t);a=!0);}catch(s){i=!0,r=s}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}return l}}(e,t)||j(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||j(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){if(e){if("string"==typeof e)return K(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if("Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return K(e,t)}}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=Array(t);o<t;o++)r[o]=e[o];return r}var U=null,Q=new Set;function Z(e,t){var o,j,K,Z,$,z=this,W=arguments.length>2&&void 0!==arguments[2]&&arguments[2],q=!1,Y=this,G=new h.Z(Y),J=!0;(0,x.dU)(W)&&(0,x.IU)(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var X=null!==($=null==t?void 0:t.layoutDirection)&&void 0!==$?$:"inherit",ee=["rtl","ltr"].includes(X)?X:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",ee),this.isRtl=function(){return"rtl"===ee},this.isLtr=function(){return!Y.isRtl()},this.getDirectionFactor=function(){return Y.isLtr()?1:-1},t.language=(0,_.gr)(t.language);var et=new H.Z(Y,t,[T.$,D._]),eo=et.getTableMeta(),er=et.getGlobalMeta(),en=(0,V.I)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),(0,x._v)(this)&&(0,i.ge)(t.licenseKey,e),this.guid="ht_".concat((0,C.O1)()),this.columnIndexMapper=new I.d,this.rowIndexMapper=new I.d,j=new b.Z(Y),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var el=function(e){var t=e.row,o=e.col;return Y._createCellCoords(t>=0?Y.rowIndexMapper.getRenderableFromVisualIndex(t):t,o>=0?Y.columnIndexMapper.getRenderableFromVisualIndex(o):o)},ea=function(e){var t=e.row,o=e.col;return Y._createCellCoords(t>=0?Y.rowIndexMapper.getVisualFromRenderableIndex(t):t,o>=0?Y.columnIndexMapper.getVisualFromRenderableIndex(o):o)},ei=new E.Z(eo,{rowIndexMapper:function(){return Y.rowIndexMapper},columnIndexMapper:function(){return Y.columnIndexMapper},countCols:function(){return Y.countCols()},countRows:function(){return Y.countRows()},propToCol:function(e){return o.propToCol(e)},isEditorOpened:function(){return!!Y.getActiveEditor()&&Y.getActiveEditor().isOpened()},countColsTranslated:function(){return z.view.countRenderableColumns()},countRowsTranslated:function(){return z.view.countRenderableRows()},getShortcutManager:function(){return Y.getShortcutManager()},createCellCoords:function(e,t){return Y._createCellCoords(e,t)},createCellRange:function(e,t,o){return Y._createCellRange(e,t,o)},visualToRenderableCoords:el,renderableToVisualCoords:ea,isDisabledCellSelection:function(e,t){return Y.getCellMeta(e,t).disableVisualSelection}});this.selection=ei;var es=function(e){e.hiddenIndexesChanged&&z.selection.refresh()};function ec(e,t){var o="className"===e?Y.rootElement:Y.table;if(J)(0,l.cn)(o,t);else{var r=[],n=[];er[e]&&(r=Array.isArray(er[e])?er[e]:(0,g.W7)(er[e])),t&&(n=Array.isArray(t)?t:(0,g.W7)(t));var a=(0,g.o0)(r,n),i=(0,g.o0)(n,r);a.length&&(0,l.IV)(o,a),i.length&&(0,l.cn)(o,i)}er[e]=t}function eu(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function ed(e,t,r){if(e.length){var n=Y.getActiveEditor(),a=Y.runHooks("beforeChange",e,t||"edit"),i=!0;if(!1===a){n&&n.cancelChanges();return}var s=new eu;s.onQueueEmpty=function(e){n&&i&&n.cancelChanges(),r(e)};for(var c=e.length-1;c>=0;c--)if(null===e[c])e.splice(c,1);else{var u=O(e[c],4),d=u[0],h=u[1],f=u[3],g=o.propToCol(h),m=Y.getCellMeta(d,g);"numeric"===m.type&&"string"==typeof f&&(0,y.TR)(f)&&(e[c][3]=function(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}(f)),Y.getCellValidator(m)&&(s.addValidatorToQueue(),Y.validateCell(e[c][3],m,function(t,o){return function(r){if("boolean"!=typeof r)throw Error("Validation error: result is not boolean");if(!1===r&&!1===o.allowInvalid){i=!1,e.splice(t,1),o.valid=!0;var n=Y.getCell(o.visualRow,o.visualCol);null!==n&&(0,l.IV)(n,eo.invalidCellClassName)}s.removeValidatorFormQueue()}}(c,m),t))}s.checkIfQueueIsEmpty()}}function eh(e,t){var r=e.length-1;if(!(r<0)){for(;r>=0;r--){var n=!1;if(null===e[r]){e.splice(r,1);continue}if(null!==e[r][2]&&void 0!==e[r][2]||null!==e[r][3]&&void 0!==e[r][3]){if(eo.allowInsertRow)for(;e[r][0]>Y.countRows()-1;){var l=o.createRow(void 0,void 0,{source:t}).delta;if(l>=1)et.createRow(null,l);else{n=!0;break}}if("array"===Y.dataType&&(!eo.columns||0===eo.columns.length)&&eo.allowInsertColumn)for(;o.propToCol(e[r][1])>Y.countCols()-1;){var a=o.createCol(void 0,void 0,{source:t}).delta;if(a>=1)et.createColumn(null,a);else{n=!0;break}}n||o.set(e[r][0],e[r][1],e[r][3])}}Y.forceFullRender=!0,K.adjustRowsAndCols(),Y.runHooks("beforeChangeRender",e,t),Z.lockEditor(),Y._refreshBorders(null),Z.unlockEditor(),Y.view.adjustElementsSize(),Y.runHooks("afterChange",e,t||"edit");var s=Y.getActiveEditor();s&&(0,i.$K)(s.refreshValue)&&s.refreshValue()}}function ef(e,t,o){return Array.isArray(e)?e:[[e,t,o]]}this.columnIndexMapper.addLocalHook("cacheUpdated",es),this.rowIndexMapper.addLocalHook("cacheUpdated",es),this.selection.addLocalHook("beforeSetRangeStart",function(e){z.runHooks("beforeSetRangeStart",e)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(e){z.runHooks("beforeSetRangeStartOnly",e)}),this.selection.addLocalHook("beforeSetRangeEnd",function(e){z.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=z.view._wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=z.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(e){var t=(0,f.sm)(!1),o=z.selection.getSelectedRange(),r=o.current(),n=r.from,a=r.to,i=o.size()-1;z.runHooks("afterSelection",n.row,n.col,a.row,a.col,t,i),z.runHooks("afterSelectionByProp",n.row,Y.colToProp(n.col),a.row,Y.colToProp(a.col),t,i);var s=z.selection.isSelectedByAnyHeader(),c=z.selection.selectedRange.current(),u=!0;q&&(u=!1),t.isTouched()&&(u=!t.value);var d=z.selection.isSelectedByRowHeader(),h=z.selection.isSelectedByColumnHeader();!1!==u&&(s?d?z.view.scrollViewportVertically(Y.rowIndexMapper.getRenderableFromVisualIndex(e.row)):h&&z.view.scrollViewportHorizontally(Y.columnIndexMapper.getRenderableFromVisualIndex(e.col)):c&&!z.selection.isMultiple()?z.view.scrollViewport(el(c.from)):z.view.scrollViewport(el(e))),d&&h?(0,l.cn)(z.rootElement,["ht__selection--rows","ht__selection--columns"]):d?((0,l.IV)(z.rootElement,"ht__selection--columns"),(0,l.cn)(z.rootElement,"ht__selection--rows")):h?((0,l.IV)(z.rootElement,"ht__selection--rows"),(0,l.cn)(z.rootElement,"ht__selection--columns")):(0,l.IV)(z.rootElement,["ht__selection--rows","ht__selection--columns"]),z._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(e){var t=e.length-1,o=e[t],r=o.from,n=o.to;z.runHooks("afterSelectionEnd",r.row,r.col,n.row,n.col,t),z.runHooks("afterSelectionEndByProp",r.row,Y.colToProp(r.col),n.row,Y.colToProp(n.col),t)}),this.selection.addLocalHook("afterIsMultipleSelection",function(e){var t=z.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)}),this.selection.addLocalHook("beforeModifyTransformStart",function(e){z.runHooks("modifyTransformStart",e)}),this.selection.addLocalHook("afterModifyTransformStart",function(e,t,o){z.runHooks("afterModifyTransformStart",e,t,o)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(e){z.runHooks("modifyTransformEnd",e)}),this.selection.addLocalHook("afterModifyTransformEnd",function(e,t,o){z.runHooks("afterModifyTransformEnd",e,t,o)}),this.selection.addLocalHook("afterDeselect",function(){Z.destroyEditor(),z._refreshBorders(),(0,l.IV)(z.rootElement,["ht__selection--rows","ht__selection--columns"]),z.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(e){z.alter("insert_row_above",e,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(e){z.alter("insert_col_start",e,1,"auto")}),K={alter:function(e,t){var l,a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0,f=function(e){if(0===e.length)return[];var t=B(e);return t.sort(function(e,t){var o=O(e,1)[0],r=O(t,1)[0];return o===r?0:o>r?1:-1}),(0,g.k$)(t,function(e,t){var o=O(t,2),r=o[0],n=o[1],l=e[e.length-1],a=O(l,2),i=a[0]+a[1];return r<=i?l[1]+=Math.max(n-(i-r),0):e.push([r,n]),e},[t[0]])};switch(e){case"insert_row":Q.has(e)||(Q.add(e),(0,c.ZK)((0,u.e)(r||(r=P(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),e)));case"insert_row_below":case"insert_row_above":var m=Y.countSourceRows();if(eo.maxRows===m)return;var p="insert_row_below"===e?"below":"above";t=null!==(l=t)&&void 0!==l?l:"insert_row"===e||"below"===p?m:0;var w=o.createRow(t,s,{source:d,mode:p}),v=w.delta,C=w.startPhysicalIndex;if(v){et.createRow(C,s);var y=ei.selectedRange.current(),R=null==y?void 0:y.from,b=null==R?void 0:R.row,S=Y.toVisualRow(C);if(ei.isSelectedByCorner())Y.selectAll();else if((0,i.$K)(b)&&b>=S){var I=y.to,x=I.row,M=I.col,k=R.col;ei.isSelectedByRowHeader()&&(k=-1),ei.getSelectedRange().pop(),ei.setRangeStartOnly(Y._createCellCoords(b+v,k),!0),ei.setRangeEnd(Y._createCellCoords(x+v,M))}else Y._refreshBorders()}break;case"insert_col":Q.has(e)||(Q.add(e),(0,c.ZK)((0,u.e)(n||(n=P(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),e)));case"insert_col_start":case"insert_col_end":var _="insert_col_end"===e?"end":"start";t=null!==(a=t)&&void 0!==a?a:"insert_col"===e||"end"===_?Y.countSourceCols():0;var A=o.createCol(t,s,{source:d,mode:_}),E=A.delta,H=A.startPhysicalIndex;if(E){if(et.createColumn(H,s),Array.isArray(eo.colHeaders)){var T=[Y.toVisualColumn(H),0];T.length+=E,Array.prototype.splice.apply(eo.colHeaders,T)}var D=ei.selectedRange.current(),N=null==D?void 0:D.from,V=null==N?void 0:N.col,L=Y.toVisualColumn(H);if(ei.isSelectedByCorner())Y.selectAll();else if((0,i.$K)(V)&&V>=L){var F=D.to,j=F.row,U=F.col,Z=N.row;ei.isSelectedByColumnHeader()&&(Z=-1),ei.getSelectedRange().pop(),ei.setRangeStartOnly(Y._createCellCoords(Z,V+E),!0),ei.setRangeEnd(Y._createCellCoords(j,U+E))}else Y._refreshBorders()}break;case"remove_row":var $=function(e){var t=0;(0,g.Bk)(e,function(e){var r=O(e,2),n=r[0],l=r[1],a=(0,i.xb)(n)?Y.countRows()-1:Math.max(n-t,0);if(Number.isInteger(n)&&(n=Math.max(n-t,0)),o.removeRow(n,l,d)){et.removeRow(Y.toPhysicalRow(a),l);var s=Y.countRows(),c=eo.fixedRowsTop;c>=a+1&&(eo.fixedRowsTop-=Math.min(l,c-a));var u=eo.fixedRowsBottom;u&&a>=s-u&&(eo.fixedRowsBottom-=Math.min(l,u)),t+=l}})};Array.isArray(t)?$(f(t)):$([[t,s]]),K.adjustRowsAndCols(),Y._refreshBorders();break;case"remove_col":var z=function(e){var t=0;(0,g.Bk)(e,function(e){var r=O(e,2),n=r[0],l=r[1],a=(0,i.xb)(n)?Y.countCols()-1:Math.max(n-t,0),s=Y.toPhysicalColumn(a);if(Number.isInteger(n)&&(n=Math.max(n-t,0)),o.removeCol(n,l,d)){et.removeColumn(s,l);var c=eo.fixedColumnsStart;c>=a+1&&(eo.fixedColumnsStart-=Math.min(l,c-a)),Array.isArray(eo.colHeaders)&&(void 0===s&&(s=-1),eo.colHeaders.splice(s,l)),t+=l}})};Array.isArray(t)?z(f(t)):z([[t,s]]),K.adjustRowsAndCols(),Y._refreshBorders();break;default:throw Error('There is no such action "'.concat(e,'"'))}h||K.adjustRowsAndCols()},adjustRowsAndCols:function(){var e=eo.minRows,t=eo.minSpareRows,r=eo.minCols,n=eo.minSpareCols;if(0===Y.countRows()&&0===Y.countCols()&&ei.deselect(),e){var l=Y.countRows();l<e&&o.createRow(l,e-l,{source:"auto"})}if(t){var a=Y.countEmptyRows(!0);if(a<t){var i=Math.min(t-a,eo.maxRows-Y.countSourceRows());o.createRow(Y.countRows(),i,{source:"auto"})}}(r||n)&&(s=Y.countEmptyCols(!0));var s,c=Y.countCols();if(r&&!eo.columns&&c<r){var u=r-c;s+=u,o.createCol(c,u,{source:"auto"})}if(n&&!eo.columns&&"array"===Y.dataType&&s<n){c=Y.countCols();var d=Math.min(n-s,eo.maxCols-c);o.createCol(c,d,{source:"auto"})}if(ei.isSelected()){var h=Y.countRows(),f=Y.countCols();(0,g.Bk)(ei.selectedRange,function(e){var t=!1,o=e.from.row,r=e.from.col,n=e.to.row,l=e.to.col;o>h-1?(t=!0,n>(o=h-1)&&(n=o)):n>h-1&&(t=!0,o>(n=h-1)&&(o=n)),r>f-1?(t=!0,l>(r=f-1)&&(l=r)):l>f-1&&(t=!0,r>(l=f-1)&&(r=l)),t&&Y.selectCell(o,r,n,l)})}Y.view&&Y.view.adjustElementsSize()},populateFromArray:function(e,t,o,r,n,l,a){var s=[],c={},u=[],d=e.row,h=e.col;if(0===(M=t.length))return!1;var m=0,p=0;switch((0,f.Kn)(o)&&(m=o.col-h+1,p=o.row-d+1),n){case"shift_down":var w=(0,g.jz)(t),v=w.length,C=Math.max(v,m),y=Y.getData().slice(d),R=(0,g.jz)(y).slice(h,h+C);for(k=0;k<C;k+=1)if(k<v){for(x=0,M=w[k].length;x<p-M;x+=1)w[k].push(w[k][x%M]);k<R.length?u.push(w[k].concat(R[k])):u.push(w[k].concat(Array(y.length).fill(null)))}else u.push(w[k%v].concat(R[k]));Y.populateFromArray(d,h,(0,g.jz)(u));break;case"shift_right":var b=t.length,S=Math.max(b,p),I=Y.getData().slice(d).map(function(e){return e.slice(h)});for(x=0;x<S;x+=1)if(x<b){for(k=0,_=t[x].length;k<m-_;k+=1)t[x].push(t[x][k%_]);if(x<I.length)for(var x,M,k,_,A,E=0;E<I[x].length;E+=1)t[x].push(I[x][E]);else(A=t[x]).push.apply(A,B(Array(I[0].length).fill(null)))}else t.push(t[x%M].slice(0,S).concat(I[x]));Y.populateFromArray(d,h,t);break;default:c.row=e.row,c.col=e.col;var H,T={row:o&&e?o.row-e.row+1:1,col:o&&e?o.col-e.col+1:1},D=0,N=0,V=!0,L=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==o?r[o%r.length]:r},P=t.length,O=o?o.row-e.row+1:0;for(x=0,M=o?O:Math.max(P,O);x<M&&!(o&&c.row>o.row&&O>P||!eo.allowInsertRow&&c.row>Y.countRows()-1)&&!(c.row>=eo.maxRows);x++){var j=x-D,K=L(j).length,U=o?o.col-e.col+1:0;if(_=o?U:Math.max(K,U),c.col=e.col,H=Y.getCellMeta(c.row,c.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&H.skipRowOnPaste){D+=1,c.row+=1,M+=1;continue}for(k=0,N=0;k<_&&!(o&&c.col>o.col&&U>K||!eo.allowInsertColumn&&c.col>Y.countCols()-1)&&!(c.col>=eo.maxCols);k++){if(H=Y.getCellMeta(c.row,c.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&H.skipColumnOnPaste){N+=1,c.col+=1,_+=1;continue}if(H.readOnly&&"UndoRedo.undo"!==r){c.col+=1;continue}var Q=k-N,Z=L(j,Q),$=Y.getDataAtCell(c.row,c.col),z={row:j,col:Q};if("Autofill.fill"===r){var W=Y.runHooks("beforeAutofillInsidePopulate",z,l,t,a,{},T);W&&(Z=(0,i.o8)(W.value)?Z:W.value)}if(null!==Z&&"object"===F(Z)){if(Array.isArray(Z)&&null===$&&($=[]),null===$||"object"!==F($))V=!1;else{var q=(0,f.ie)(Array.isArray($)?$:$[0]||$),G=(0,f.ie)(Array.isArray(Z)?Z:Z[0]||Z);(0,f.Z1)(q,G)?Z=(0,f.I8)(Z):V=!1}}else null!==$&&"object"===F($)&&(V=!1);V&&s.push([c.row,c.col,Z]),V=!0,c.col+=1}c.row+=1}Y.setDataAtCell(s,null,null,r||"populateFromArray")}}},this.init=function(){j.setData(eo.data),Y.runHooks("beforeInit"),((0,s.K1)()||(0,s.L)())&&(0,l.cn)(Y.rootElement,"mobile"),this.updateSettings(eo,!0),this.view=new R.Z(this),Z=d.ZP.getInstance(Y,eo,ei),Y.runHooks("init"),this.forceFullRender=!0,this.view.render(),"object"===F(J)&&(Y.runHooks("afterChange",J[0],J[1]),J=!1),Y.runHooks("afterInit")},this._createCellCoords=function(e,t){return Y.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,o){return Y.view._wt.createCellRange(e,t,o)},this.validateCell=function(e,t,o,r){var n,l=Y.getCellValidator(t);function s(e){var r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!r||!0===t.hidden){o(e);return}var n=t.visualCol,l=t.visualRow,a=Y.getCell(l,n,!0);if(a&&"TH"!==a.nodeName){var i=Y.rowIndexMapper.getRenderableFromVisualIndex(l),s=Y.columnIndexMapper.getRenderableFromVisualIndex(n);Y.view._wt.getSetting("cellRenderer",i,s,a)}o(e)}(0,i.Kj)(l)&&(n=l,l=function(e,t){t(n.test(e))}),(0,a.mf)(l)?(e=Y.runHooks("beforeValidate",e,t.visualRow,t.prop,r),Y._registerImmediate(function(){l.call(t,e,function(o){Y&&(o=Y.runHooks("afterValidate",o,e,t.visualRow,t.prop,r),t.valid=o,s(o),Y.runHooks("postAfterValidate",o,e,t.visualRow,t.prop,r))})})):Y._registerImmediate(function(){t.valid=!0,s(t.valid,!1)})},this.setDataAtCell=function(e,t,r,n){var l,a,i,s=ef(e,t,r),c=[],u=n;for(l=0,a=s.length;l<a;l++){if("object"!==F(s[l]))throw Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof s[l][1])throw Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");i=s[l][1]>=this.countCols()?s[l][1]:o.colToProp(s[l][1]),c.push([s[l][0],i,j.getAtCell(this.toPhysicalRow(s[l][0]),s[l][1]),s[l][2]])}u||"object"!==F(e)||(u=t),Y.runHooks("afterSetDataAtCell",c,u),ed(c,u,function(){eh(c,u)})},this.setDataAtRowProp=function(e,t,o,r){var n,l,a=ef(e,t,o),i=[],s=r;for(n=0,l=a.length;n<l;n++)i.push([a[n][0],a[n][1],j.getAtCell(this.toPhysicalRow(a[n][0]),a[n][1]),a[n][2]]);s||"object"!==F(e)||(s=t),Y.runHooks("afterSetDataAtRowProp",i,s),ed(i,s,function(){eh(i,s)})},this.listen=function(){Y&&!Y.isListening()&&(U=Y.guid,Y.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(U=null,Y.runHooks("afterUnlisten"))},this.isListening=function(){return U===Y.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];Y._refreshBorders(e,t)},this.populateFromArray=function(e,t,o,r,n,l,a,i,s){if(!("object"===F(o)&&"object"===F(o[0])))throw Error("populateFromArray parameter `input` must be an array of arrays");var c="number"==typeof r?Y._createCellCoords(r,n):null;return K.populateFromArray(Y._createCellCoords(e,t),o,c,l,a,i,s)},this.spliceCol=function(e,t,r){for(var n,l=arguments.length,a=Array(l>3?l-3:0),i=3;i<l;i++)a[i-3]=arguments[i];return(n=o).spliceCol.apply(n,[e,t,r].concat(a))},this.spliceRow=function(e,t,r){for(var n,l=arguments.length,a=Array(l>3?l-3:0),i=3;i<l;i++)a[i-3]=arguments[i];return(n=o).spliceRow.apply(n,[e,t,r].concat(a))},this.getSelected=function(){if(ei.isSelected())return(0,g.Sc)(ei.getSelectedRange(),function(e){var t=e.from,o=e.to;return[t.row,t.col,o.row,o.col]})},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(ei.isSelected())return Array.from(ei.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){var t=this;if(ei.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var o=[];(0,g.Bk)(ei.getSelectedRange(),function(e){var r=e.getTopStartCorner(),n=e.getBottomEndCorner();(0,y.q4)(r.row,n.row,function(e){(0,y.q4)(r.col,n.col,function(r){t.getCellMeta(e,r).readOnly||o.push([e,r,null])})})}),o.length>0&&this.setDataAtCell(o,e)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(Z.lockEditor(),this._refreshBorders(null),Z.unlockEditor()))},this.batchRender=function(e){this.suspendRender();var t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var o=e();return this.resumeExecution(t),o},this.batch=function(e){this.suspendRender(),this.suspendExecution();var t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(Y.view){var e=Y.view.getLastSize(),t=e.width,o=e.height,r=Y.rootElement.getBoundingClientRect(),n=r.width,l=r.height,a=n!==t||l!==o;!1!==Y.runHooks("beforeRefreshDimensions",{width:t,height:o},{width:n,height:l},a)&&((a||Y.view._wt.wtOverlays.scrollableElement===Y.rootWindow)&&(Y.view.setLastSize(n,l),Y.render()),Y.runHooks("afterRefreshDimensions",{width:t,height:o},{width:n,height:l},a))}},this.updateData=function(e,t){var r=this;(0,N.o)(e,function(e){o=e},function(e){o=e,Y.columnIndexMapper.fitToLength(r.getInitialColumnCount()),Y.rowIndexMapper.fitToLength(r.countSourceRows()),K.adjustRowsAndCols()},{hotInstance:Y,dataMap:o,dataSource:j,internalSource:"updateData",source:t,firstRun:J})},this.loadData=function(e,t){(0,N.o)(e,function(e){o=e},function(){et.clearCellsCache(),Y.initIndexMappers(),K.adjustRowsAndCols(),J&&(J=[null,"loadData"])},{hotInstance:Y,dataMap:o,dataSource:j,internalSource:"loadData",source:t,firstRun:J})},this.getInitialColumnCount=function(){var e=eo.columns,t=0;if(Array.isArray(e))t=e.length;else if((0,a.mf)(e)){if("array"===Y.dataType)for(var r=this.countSourceCols(),n=0;n<r;n+=1)e(n)&&(t+=1);else("object"===Y.dataType||"function"===Y.dataType)&&(t=o.colToPropCache.length)}else if((0,i.$K)(eo.dataSchema)){var l=o.getSchema();t=Array.isArray(l)?l.length:(0,f.Q8)(l)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,n){return(0,i.o8)(e)?o.getAll():o.getRange(Y._createCellCoords(e,t),Y._createCellCoords(r,n),o.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,n){return o.getCopyableText(Y._createCellCoords(e,t),Y._createCellCoords(r,n))},this.getCopyableData=function(e,t){return o.getCopyable(e,o.colToProp(t))},this.getSchema=function(){return o.getSchema()},this.updateSettings=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=(J?Y.loadData:Y.updateData).bind(this),s=!1;if((0,i.$K)(e.rows))throw Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,i.$K)(e.cols))throw Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,i.$K)(e.ganttChart))throw Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(t in e)"data"===t||("language"===t?function(e){var t=(0,A.TH)(e);(0,_.RY)(t)?(Y.runHooks("beforeLanguageChange",t),er.language=t,Y.runHooks("afterLanguageChange",t)):(0,A.Vn)(e)}(e.language):"className"===t?ec("className",e.className):"tableClassName"===t&&Y.table?(ec("tableClassName",e.tableClassName),Y.view._wt.wtOverlays.syncOverlayTableClassNames()):k.Z.getSingleton().isRegistered(t)||k.Z.getSingleton().isDeprecated(t)?((0,a.mf)(e[t])||Array.isArray(e[t]))&&(e[t].initialHook=!0,Y.addHook(t,e[t])):!n&&(0,f.nr)(e,t)&&(er[t]=e[t]));void 0===e.data&&void 0===eo.data?l(null,"updateSettings"):void 0!==e.data?l(e.data,"updateSettings"):void 0!==e.columns&&(o.createMap(),Y.initIndexMappers());var c=Y.countCols(),u=eo.columns;if(u&&(0,a.mf)(u)&&(s=!0),(void 0!==e.cell||void 0!==e.cells||void 0!==e.columns)&&et.clearCache(),c>0)for(t=0,r=0;t<c;t++){if(u){var d=s?u(t):u[r];d&&et.updateColumnMeta(r,d)}r+=1}(0,i.$K)(e.cell)&&(0,f._l)(e.cell,function(e){Y.setCellMetaObject(e.row,e.col,e)}),Y.runHooks("afterCellMetaReset");var h=Y.rootElement.style.height;""!==h&&(h=parseInt(Y.rootElement.style.height,10));var g=e.height;if((0,a.mf)(g)&&(g=g()),n&&Y.rootElement.getAttribute("style")&&Y.rootElement.setAttribute("data-initialstyle",Y.rootElement.getAttribute("style")),null===g){var m=Y.rootElement.getAttribute("data-initialstyle");m&&(m.indexOf("height")>-1||m.indexOf("overflow")>-1)?Y.rootElement.setAttribute("style",m):(Y.rootElement.style.height="",Y.rootElement.style.overflow="")}else void 0!==g&&(Y.rootElement.style.height=isNaN(g)?"".concat(g):"".concat(g,"px"),Y.rootElement.style.overflow="hidden");if(void 0!==e.width){var p=e.width;(0,a.mf)(p)&&(p=p()),Y.rootElement.style.width=isNaN(p)?"".concat(p):"".concat(p,"px")}n||(Y.view&&(Y.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),Y.view._wt.exportSettingsAsClassNames()),Y.runHooks("afterUpdateSettings",e)),K.adjustRowsAndCols(),Y.view&&!J&&(Y.forceFullRender=!0,Z.lockEditor(),Y._refreshBorders(null),Y.view._wt.wtOverlays.adjustElementsSize(),Z.unlockEditor()),!n&&Y.view&&(""===h||""===g||void 0===g)&&h!==g&&Y.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=Y.getSelectedLast();if(eo.getValue){if((0,a.mf)(eo.getValue))return eo.getValue.call(Y);if(e)return Y.getData()[e[0][0]][eo.getValue]}else if(e)return Y.getDataAtCell(e[0],e[1])},this.getSettings=function(){return eo},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,o,r,n){K.alter(e,t,o,r,n)},this.getCell=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,n=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;n=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===n||null===r?null:Y.view.getCellAtCoords(Y._createCellCoords(n,r),o)},this.getCoords=function(e){var t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;var o=t.row,r=t.col,n=o,l=r;return o>=0&&(n=this.rowIndexMapper.getVisualFromRenderableIndex(o)),r>=0&&(l=this.columnIndexMapper.getVisualFromRenderableIndex(r)),Y._createCellCoords(n,l)},this.colToProp=function(e){return o.colToProp(e)},this.propToCol=function(e){return o.propToCol(e)},this.toVisualRow=function(e){return z.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return z.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return z.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return z.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return o.get(e,o.colToProp(t))},this.getDataAtRowProp=function(e,t){return o.get(e,t)},this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,B(o.getRange(Y._createCellCoords(0,e),Y._createCellCoords(eo.data.length-1,e),o.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,r=o.getRange(Y._createCellCoords(0,o.propToCol(e)),Y._createCellCoords(eo.data.length-1,o.propToCol(e)),o.DESTINATION_RENDERER);return(t=[]).concat.apply(t,B(r))},this.getSourceData=function(e,t,o,r){return void 0===e?j.getData():j.getByRange(Y._createCellCoords(e,t),Y._createCellCoords(o,r))},this.getSourceDataArray=function(e,t,o,r){return void 0===e?j.getData(!0):j.getByRange(Y._createCellCoords(e,t),Y._createCellCoords(o,r),!0)},this.getSourceDataAtCol=function(e){return j.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,o,r){var n=ef(e,t,o),l=this.hasHook("afterSetSourceDataAtCell"),a=[];l&&(0,g.Bk)(n,function(e){var t=O(e,3),o=t[0],r=t[1],n=t[2];a.push([o,r,j.getAtCell(o,r),n])}),(0,g.Bk)(n,function(e){var t=O(e,3),o=t[0],r=t[1],n=t[2];j.setAtCell(o,r,n)}),l&&this.runHooks("afterSetSourceDataAtCell",a,r),this.render();var s=Y.getActiveEditor();s&&(0,i.$K)(s.refreshValue)&&s.refreshValue()},this.getSourceDataAtRow=function(e){return j.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return j.getAtCell(e,t)},this.getDataAtRow=function(e){return o.getRange(Y._createCellCoords(e,0),Y._createCellCoords(e,this.countCols()-1),o.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,o,r){var n=this,l=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,o,r],a=l[0],i=l[1],s=l[2],c=l[3],u=null,d=null;void 0===s&&(s=a),void 0===c&&(c=i);var h="mixed";return(0,y.q4)(Math.max(Math.min(a,s),0),Math.max(a,s),function(e){var t=!0;return(0,y.q4)(Math.max(Math.min(i,c),0),Math.max(i,c),function(o){return d=n.getCellMeta(e,o).type,u?t=u===d:u=d,t}),h=t?d:"mixed",t}),h},this.removeCellMeta=function(e,t,o){var r=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],n=r[0],l=r[1],a=et.getCellMetaKeyValue(n,l,o);!1!==Y.runHooks("beforeRemoveCellMeta",e,t,o,a)&&(et.removeCellMeta(n,l,o),Y.runHooks("afterRemoveCellMeta",e,t,o,a)),a=null},this.spliceCellsMeta=function(e){for(var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,n=Array(r>2?r-2:0),l=2;l<r;l++)n[l-2]=arguments[l];if(n.length>0&&!Array.isArray(n[0]))throw Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");o>0&&et.removeRow(this.toPhysicalRow(e),o),n.length>0&&(0,g.Bk)(n.reverse(),function(o){et.createRow(t.toPhysicalRow(e)),(0,g.Bk)(o,function(o,r){return t.setCellMetaObject(e,r,o)})}),Y.render()},this.setCellMetaObject=function(e,t,o){var r=this;"object"===F(o)&&(0,f._l)(o,function(o,n){r.setCellMeta(e,t,n,o)})},this.setCellMeta=function(e,t,o,r){if(!1!==Y.runHooks("beforeSetCellMeta",e,t,o,r)){var n=e,l=t;e<this.countRows()&&(n=this.toPhysicalRow(e)),t<this.countCols()&&(l=this.toPhysicalColumn(t)),et.setCellMeta(n,l,o,r),Y.runHooks("afterSetCellMeta",e,t,o,r)}},this.getCellsMeta=function(){return et.getCellsMeta()},this.getCellMeta=function(e,t){var o=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===o&&(o=e),null===r&&(r=t),et.getCellMeta(o,r,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return et.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===Y.dataType||eo.columns)};var eg=(0,S.$2)("renderer");this.getCellRenderer=function(e,t){return(0,w.Bp)(eg.call(this,e,t))},this.getCellEditor=(0,S.$2)("editor");var em=(0,S.$2)("validator");this.getCellValidator=function(e,t){var o=em.call(this,e,t);return"string"==typeof o&&(o=(0,v.Te)(o)),o},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,o){var r=new eu;e&&(r.onQueueEmpty=e);for(var n=Y.countRows()-1;n>=0;){if(void 0!==t&&-1===t.indexOf(n)){n-=1;continue}for(var l=Y.countCols()-1;l>=0;){if(void 0!==o&&-1===o.indexOf(l)){l-=1;continue}r.addValidatorToQueue(),Y.validateCell(Y.getDataAtCell(n,l),Y.getCellMeta(n,l),function(e){if("boolean"!=typeof e)throw Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),l-=1}n-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=eo.rowHeaders,o=e;return void 0!==o&&(o=Y.runHooks("modifyRowHeader",o)),void 0===o?(t=[],(0,y.q4)(Y.countRows()-1,function(e){t.push(Y.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[o]?t=t[o]:(0,a.mf)(t)?t=t(o):t&&"string"!=typeof t&&"number"!=typeof t&&(t=o+1),t},this.hasRowHeaders=function(){return!!eo.rowHeaders},this.hasColHeaders=function(){if(void 0!==eo.colHeaders&&null!==eo.colHeaders)return!!eo.colHeaders;for(var e=0,t=Y.countCols();e<t;e++)if(Y.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=Y.runHooks("modifyColHeader",e),o=eo.colHeaders;if(void 0===t){for(var r=[],n=Y.countCols(),l=0;l<n;l++)r.push(Y.getColHeader(l));o=r}else{var i=Y.toPhysicalColumn(t),s=function(e){for(var t=[],o=Y.countCols(),r=0;r<o;r++)(0,a.mf)(eo.columns)&&eo.columns(r)&&t.push(r);return t[e]}(i);!1===eo.colHeaders?o=null:eo.columns&&(0,a.mf)(eo.columns)&&eo.columns(s)&&eo.columns(s).title?o=eo.columns(s).title:eo.columns&&eo.columns[i]&&eo.columns[i].title?o=eo.columns[i].title:Array.isArray(eo.colHeaders)&&void 0!==eo.colHeaders[i]?o=eo.colHeaders[i]:(0,a.mf)(eo.colHeaders)?o=eo.colHeaders(i):eo.colHeaders&&"string"!=typeof eo.colHeaders&&"number"!=typeof eo.colHeaders&&(o=(0,S.Yl)(t))}return o},this._getColWidthFromSettings=function(e){var t;if(e>=0&&(t=Y.getCellMeta(0,e).width),(void 0===t||t===eo.width)&&(t=eo.colWidths),null!=t){switch(F(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){var t=Y._getColWidthFromSettings(e);return void 0===(t=Y.runHooks("modifyColWidth",t,e))&&(t=M.Z.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=eo.rowHeights;if(null!=t){switch(F(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=Y._getRowHeightFromSettings(e);return Y.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return j.countRows()},this.countSourceCols=function(){return j.countFirstRowKeys()},this.countRows=function(){return o.getLength()},this.countCols=function(){return Math.min(eo.maxCols,this.columnIndexMapper.getNotTrimmedIndexesLength())},this.countRenderedRows=function(){return Y.view._wt.drawn?Y.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return Y.view._wt.drawn?Y.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return Y.view._wt.drawn?Y.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return Y.view._wt.drawn?Y.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,y.yh)(Y.countRows()-1,function(o){if(Y.isEmptyRow(o))t+=1;else if(!0===e)return!1}),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,y.yh)(Y.countCols()-1,function(o){if(Y.isEmptyCol(o))t+=1;else if(!0===e)return!1}),t},this.isEmptyRow=function(e){return eo.isEmptyRow.call(Y,e)},this.isEmptyCol=function(e){return eo.isEmptyCol.call(Y,e)},this.selectCell=function(e,t,o,r){var n=!(arguments.length>4)||void 0===arguments[4]||arguments[4],l=!(arguments.length>5)||void 0===arguments[5]||arguments[5];return!((0,i.o8)(e)||(0,i.o8)(t))&&this.selectCells([[e,t,o,r]],n,l)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2];!1===t&&(q=!0);var r=ei.selectCells(e);return r&&o&&Y.listen(),q=!1,r},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return ei.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return ei.selectRows(e,t)},this.deselectCell=function(){ei.deselect()},this.selectAll=function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=e&&this.hasRowHeaders(),o=e&&this.hasColHeaders();q=!0,ei.selectAll(t,o),q=!1};var ep=function(e,t){return e.getNearestNotHiddenIndex(t,1,!0)};this.scrollViewportTo=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=!(arguments.length>4)||void 0===arguments[4]||arguments[4],l=!o,a=!r,i=e,s=t;if(n){var c=Number.isInteger(e),u=Number.isInteger(t),d=c?ep(this.rowIndexMapper,e):void 0,h=u?ep(this.columnIndexMapper,t):void 0;if(null===d||null===h)return!1;i=c?Y.rowIndexMapper.getRenderableFromVisualIndex(d):void 0,s=u?Y.columnIndexMapper.getRenderableFromVisualIndex(h):void 0}var f=Number.isInteger(i),g=Number.isInteger(s);return f&&g?Y.view.scrollViewport(Y._createCellCoords(i,s),l,r,o,a):f&&!1===g?Y.view.scrollViewportVertically(i,l,o):!!g&&!1===f&&Y.view.scrollViewportHorizontally(s,r,a)},this.destroy=function(){if(Y._clearTimeouts(),Y._clearImmediates(),Y.view&&Y.view.destroy(),j&&j.destroy(),j=null,this.getShortcutManager().destroy(),et.clearCache(),(0,x._v)(Y)){var e=this.rootDocument.querySelector("#hot-display-license-info");e&&e.parentNode.removeChild(e)}(0,l.cS)(Y.rootElement),G.destroy(),Z&&Z.destroy(),Y.batchExecution(function(){Y.rowIndexMapper.unregisterAll(),Y.columnIndexMapper.unregisterAll(),en.getItems().forEach(function(e){O(e,2)[1].destroy()}),en.clear(),Y.runHooks("afterDestroy")},!0),k.Z.getSingleton().destroy(Y),(0,f._l)(Y,function(e,t,o){(0,a.mf)(e)?o[t]=function(){throw Error('The "'.concat(t,'" method cannot be called because this Handsontable instance has been destroyed'))}:"guid"!==t&&(o[t]=null)}),Y.isDestroyed=!0,o&&o.destroy(),Y.rowIndexMapper=null,Y.columnIndexMapper=null,o=null,K=null,ei=null,Z=null,Y=null},this.getActiveEditor=function(){return Z.getActiveEditor()},this.getPlugin=function(e){var t=(0,C.ct)(e);return"UndoRedo"===t?this.undoRedo:en.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:en.getId(e)},this.getInstance=function(){return Y},this.addHook=function(e,t){k.Z.getSingleton().add(e,t,Y)},this.hasHook=function(e){return k.Z.getSingleton().has(e,Y)||k.Z.getSingleton().has(e)},this.addHookOnce=function(e,t){k.Z.getSingleton().once(e,t,Y)},this.removeHook=function(e,t){k.Z.getSingleton().remove(e,t,Y)},this.runHooks=function(e,t,o,r,n,l,a){return k.Z.getSingleton().run(Y,e,t,o,r,n,l,a)},this.getTranslatedPhrase=function(e,t){return(0,_.vk)(eo.language,e,t)},this.toHTML=function(){return(0,m.vo)(z)},this.toTableElement=function(){var e=z.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",(0,m.vo)(z)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=e;"function"==typeof o&&(o=setTimeout(o,t)),this.timeouts.push(o)},this._clearTimeouts=function(){(0,g.Bk)(this.timeouts,function(e){clearTimeout(e)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){(0,g.Bk)(this.immediates,function(e){clearImmediate(e)})},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];Z.destroyEditor(e),Y.view.render(),t&&ei.isSelected()&&Z.prepareEditor()},this.isRtl=function(){return"rtl"===Y.rootWindow.getComputedStyle(Y.rootElement).direction},this.isLtr=function(){return!Y.isRtl()},this.getDirectionFactor=function(){return Y.isLtr()?1:-1};var ew=(0,L.U)({handleEvent:function(e){var t=Y.isListening(),o=(null==e?void 0:e.key)!==void 0;return t&&o},beforeKeyDown:function(e){return z.runHooks("beforeKeyDown",e)},afterKeyDown:function(e){z.isDestroyed||Y.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.getShortcutManager=function(){return ew};var ev=ew.addContext("grid");ew.setActiveContextName("grid"),ev.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){Y.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var e=Y.getSelectedRange(),t=e[e.length-1].highlight,o=t.row,r=t.col,n=Y.getDataAtCell(o,r),l=new Map,a=0;a<e.length;a++)e[a].forAll(function(e,t){e>=0&&t>=0&&(e!==o||t!==r)&&!Y.getCellMeta(e,t).readOnly&&l.set("".concat(e,"x").concat(t),[e,t,n])});Y.setDataAtCell(Array.from(l.values()))},runOnlyIf:function(){return Y.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){ei.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){ei.setRangeStart(Y._createCellCoords(Y.rowIndexMapper.getNearestNotHiddenIndex(0,1),Y.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){ei.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=Y.getSelectedRangeLast(),t=e.from,o=e.to,r=Y.rowIndexMapper.getNearestNotHiddenIndex(0,1);ei.setRangeStart(t.clone()),ei.setRangeEnd(Y._createCellCoords(r,o.col))},runOnlyIf:function(){return!(Y.selection.isSelectedByCorner()||Y.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){ei.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){ei.setRangeStart(Y._createCellCoords(Y.rowIndexMapper.getNearestNotHiddenIndex(Y.countRows()-1,-1),Y.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){ei.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=Y.getSelectedRangeLast(),t=e.from,o=e.to,r=Y.rowIndexMapper.getNearestNotHiddenIndex(Y.countRows()-1,-1);ei.setRangeStart(t.clone()),ei.setRangeEnd(Y._createCellCoords(r,o.col))},runOnlyIf:function(){return!(Y.selection.isSelectedByCorner()||Y.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){ei.transformStart(0,-1*Y.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=Y.getSelectedRangeLast().highlight.row,o=(e=Y.columnIndexMapper).getNearestNotHiddenIndex.apply(e,B(Y.isRtl()?[Y.countCols()-1,-1]:[0,1]));ei.setRangeStart(Y._createCellCoords(t,o))}},{keys:[["ArrowLeft","Shift"]],callback:function(){ei.transformEnd(0,-1*Y.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=Y.getSelectedRangeLast(),o=t.from,r=t.to,n=(e=Y.columnIndexMapper).getNearestNotHiddenIndex.apply(e,B(Y.isRtl()?[Y.countCols()-1,-1]:[0,1]));ei.setRangeStart(o.clone()),ei.setRangeEnd(Y._createCellCoords(r.row,n))},runOnlyIf:function(){return!(Y.selection.isSelectedByCorner()||Y.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){ei.transformStart(0,Y.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=Y.getSelectedRangeLast().highlight.row,o=(e=Y.columnIndexMapper).getNearestNotHiddenIndex.apply(e,B(Y.isRtl()?[0,1]:[Y.countCols()-1,-1]));ei.setRangeStart(Y._createCellCoords(t,o))}},{keys:[["ArrowRight","Shift"]],callback:function(){ei.transformEnd(0,Y.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=Y.getSelectedRangeLast(),o=t.from,r=t.to,n=(e=Y.columnIndexMapper).getNearestNotHiddenIndex.apply(e,B(Y.isRtl()?[0,1]:[Y.countCols()-1,-1]));ei.setRangeStart(o.clone()),ei.setRangeEnd(Y._createCellCoords(r.row,n))},runOnlyIf:function(){return!(Y.selection.isSelectedByCorner()||Y.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var e=parseInt(Y.getSettings().fixedColumnsStart,10),t=Y.getSelectedRangeLast().highlight.row,o=Y.columnIndexMapper.getNearestNotHiddenIndex(e,1);ei.setRangeStart(Y._createCellCoords(t,o))},runOnlyIf:function(){return Y.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){ei.setRangeEnd(Y._createCellCoords(ei.selectedRange.current().from.row,Y.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(Y.getSettings().fixedRowsTop,10),t=parseInt(Y.getSettings().fixedColumnsStart,10),o=Y.rowIndexMapper.getNearestNotHiddenIndex(e,1),r=Y.columnIndexMapper.getNearestNotHiddenIndex(t,1);ei.setRangeStart(Y._createCellCoords(o,r))},runOnlyIf:function(){return Y.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){ei.setRangeStart(Y._createCellCoords(Y.getSelectedRangeLast().highlight.row,Y.columnIndexMapper.getNearestNotHiddenIndex(Y.countCols()-1,-1)))},runOnlyIf:function(){return Y.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){ei.setRangeEnd(Y._createCellCoords(ei.selectedRange.current().from.row,Y.columnIndexMapper.getNearestNotHiddenIndex(Y.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(Y.getSettings().fixedRowsBottom,10),t=Y.rowIndexMapper.getNearestNotHiddenIndex(Y.countRows()-e-1,-1),o=Y.columnIndexMapper.getNearestNotHiddenIndex(Y.countCols()-1,-1);ei.setRangeStart(Y._createCellCoords(t,o))},runOnlyIf:function(){return Y.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){ei.transformStart(-Y.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var e=Y.getSelectedRangeLast().to,t=Math.max(e.row-Y.countVisibleRows(),0),o=Y.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(null!==o){var r=Y._createCellCoords(o,e.col),n=e.row-Y.view.getFirstFullyVisibleRow(),l=Math.max(r.row-n,0);ei.setRangeEnd(r),Y.scrollViewportTo(l)}}},{keys:[["PageDown"]],callback:function(){ei.transformStart(Y.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var e=Y.getSelectedRangeLast().to,t=Math.min(e.row+Y.countVisibleRows(),Y.countRows()-1),o=Y.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(null!==o){var r=Y._createCellCoords(o,e.col),n=e.row-Y.view.getFirstFullyVisibleRow(),l=Math.min(r.row-n,Y.countRows()-1);ei.setRangeEnd(r),Y.scrollViewportTo(l)}}},{keys:[["Tab"]],callback:function(e){var t="function"==typeof eo.tabMoves?eo.tabMoves(e):eo.tabMoves;ei.transformStart(t.row,t.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var t="function"==typeof eo.tabMoves?eo.tabMoves(e):eo.tabMoves;ei.transformStart(-t.row,-t.col)}}],{runOnlyIf:function(){return(0,i.$K)(Y.getSelected())&&Y.countRenderedRows()>0&&Y.countRenderedCols()>0},group:"gridDefault"}),(0,p.a9)().forEach(function(e){var t=(0,p.s3)(e);en.addItem(e,new t(z))}),k.Z.getSingleton().run(Y,"construct")}}}]);