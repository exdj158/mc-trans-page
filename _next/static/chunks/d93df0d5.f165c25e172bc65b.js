"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{8194:function(e,t,o){o.d(t,{Z:function(){return z}}),o(2526),o(1817),o(2165),o(8309),o(3371),o(6992),o(1539),o(189),o(8783),o(3948),o(6699),o(2707),o(561),o(3161),o(9653),o(7042),o(2222),o(3290),o(1249),o(4916),o(5306),o(1038),o(2772),o(5069),o(4747),o(2564),o(4633),o(1532);var r,n,a=o(766),l=o(7161),i=o(1799),s=o(9931),u=o(3895),c=o(8336),d=o(4020),f=o(6487),h=o(7772),g=o(613),m=o(9906),p=o(8298),w=o(9847),v=o(6187),C=o(8894),y=o(9272),R=o(2226),b=o(6284),S=o(7002),I=o(3817),x=o(350),M=o(6728),k=o(2792),_=o(3909),A=o(183),E=o(8719),H=o(3431),T=o(2264),D=o(2654),N=o(7226),V=o(6068),L=o(8722),F=o(8524);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var r,n,a,l,i=[],s=!0,u=!1;try{if(a=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;s=!1}else for(;!(s=(r=a.call(o)).done)&&(i.push(r.value),i.length!==t);s=!0);}catch(c){u=!0,n=c}finally{try{if(!s&&null!=o.return&&(l=o.return(),Object(l)!==l))return}finally{if(u)throw n}}return i}}(e,t)||K(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e){return function(e){if(Array.isArray(e))return U(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||K(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){if(e){if("string"==typeof e)return U(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if("Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return U(e,t)}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=Array(t);o<t;o++)r[o]=e[o];return r}var Q=null,Z=new Set;function z(e,t){var o,K,U,z,$,W=this,q=arguments.length>2&&void 0!==arguments[2]&&arguments[2],Y=!1,G=this,J=new f.Z(G),X=!0;(0,M.dU)(q)&&(0,M.IU)(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var ee=null!==($=null==t?void 0:t.layoutDirection)&&void 0!==$?$:"inherit",et=["rtl","ltr"].includes(ee)?ee:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",et),this.isRtl=function(){return"rtl"===et},this.isLtr=function(){return!G.isRtl()},this.getDirectionFactor=function(){return G.isLtr()?1:-1},t.language=(0,A.gr)(t.language);var eo=new T.Z(G,t,[D.$,N._]),er=eo.getTableMeta(),en=eo.getGlobalMeta(),ea=(0,L.I)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),(0,M._v)(this)&&(0,i.ge)(t.licenseKey,e),this.guid="ht_".concat((0,y.O1)()),this.columnIndexMapper=new x.d,this.rowIndexMapper=new x.d,K=new S.Z(G),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var el=function(e){var t=e.row,o=e.col;return G._createCellCoords(t>=0?G.rowIndexMapper.getRenderableFromVisualIndex(t):t,o>=0?G.columnIndexMapper.getRenderableFromVisualIndex(o):o)},ei=function(e){var t=e.row,o=e.col;return G._createCellCoords(t>=0?G.rowIndexMapper.getVisualFromRenderableIndex(t):t,o>=0?G.columnIndexMapper.getVisualFromRenderableIndex(o):o)},es=new H.Z(er,{rowIndexMapper:function(){return G.rowIndexMapper},columnIndexMapper:function(){return G.columnIndexMapper},countCols:function(){return G.countCols()},countRows:function(){return G.countRows()},propToCol:function(e){return o.propToCol(e)},isEditorOpened:function(){return!!G.getActiveEditor()&&G.getActiveEditor().isOpened()},countColsTranslated:function(){return W.view.countRenderableColumns()},countRowsTranslated:function(){return W.view.countRenderableRows()},getShortcutManager:function(){return G.getShortcutManager()},createCellCoords:function(e,t){return G._createCellCoords(e,t)},createCellRange:function(e,t,o){return G._createCellRange(e,t,o)},visualToRenderableCoords:el,renderableToVisualCoords:ei,isDisabledCellSelection:function(e,t){return G.getCellMeta(e,t).disableVisualSelection}});this.selection=es;var eu=function(e){e.hiddenIndexesChanged&&W.selection.refresh()};function ec(e,t){var o="className"===e?G.rootElement:G.table;if(X)(0,a.cn)(o,t);else{var r=[],n=[];en[e]&&(r=Array.isArray(en[e])?en[e]:(0,g.W7)(en[e])),t&&(n=Array.isArray(t)?t:(0,g.W7)(t));var l=(0,g.o0)(r,n),i=(0,g.o0)(n,r);l.length&&(0,a.IV)(o,l),i.length&&(0,a.cn)(o,i)}en[e]=t}function ed(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function ef(e,t,r){if(e.length){var n=G.getActiveEditor(),l=G.runHooks("beforeChange",e,t||"edit"),i=!0;if(!1===l){n&&n.cancelChanges();return}var s=new ed;s.onQueueEmpty=function(e){n&&i&&n.cancelChanges(),r(e)};for(var u=e.length-1;u>=0;u--)if(null===e[u])e.splice(u,1);else{var c=B(e[u],4),d=c[0],f=c[1],h=c[3],g=o.propToCol(f),m=G.getCellMeta(d,g);"numeric"===m.type&&"string"==typeof h&&(0,R.TR)(h)&&(e[u][3]=function(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}(h)),G.getCellValidator(m)&&(s.addValidatorToQueue(),G.validateCell(e[u][3],m,function(t,o){return function(r){if("boolean"!=typeof r)throw Error("Validation error: result is not boolean");if(!1===r&&!1===o.allowInvalid){i=!1,e.splice(t,1),o.valid=!0;var n=G.getCell(o.visualRow,o.visualCol);null!==n&&(0,a.IV)(n,er.invalidCellClassName)}s.removeValidatorFormQueue()}}(u,m),t))}s.checkIfQueueIsEmpty()}}function eh(e,t){var r=e.length-1;if(!(r<0)){for(;r>=0;r--){var n=!1;if(null===e[r]){e.splice(r,1);continue}if(null!==e[r][2]&&void 0!==e[r][2]||null!==e[r][3]&&void 0!==e[r][3]){if(er.allowInsertRow){for(;e[r][0]>G.countRows()-1;)if(0===o.createRow(void 0,void 0,{source:t}).delta){n=!0;break}}if("array"===G.dataType&&(!er.columns||0===er.columns.length)&&er.allowInsertColumn){for(;o.propToCol(e[r][1])>G.countCols()-1;)if(0===o.createCol(void 0,void 0,{source:t}).delta){n=!0;break}}n||o.set(e[r][0],e[r][1],e[r][3])}}G.forceFullRender=!0,U.adjustRowsAndCols(),G.runHooks("beforeChangeRender",e,t),z.lockEditor(),G._refreshBorders(null),z.unlockEditor(),G.view.adjustElementsSize(),G.runHooks("afterChange",e,t||"edit");var a=G.getActiveEditor();a&&(0,i.$K)(a.refreshValue)&&a.refreshValue()}}function eg(e,t,o){return Array.isArray(e)?e:[[e,t,o]]}this.columnIndexMapper.addLocalHook("cacheUpdated",eu),this.rowIndexMapper.addLocalHook("cacheUpdated",eu),this.selection.addLocalHook("beforeSetRangeStart",function(e){W.runHooks("beforeSetRangeStart",e)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(e){W.runHooks("beforeSetRangeStartOnly",e)}),this.selection.addLocalHook("beforeSetRangeEnd",function(e){W.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=W.view._wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=W.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(e){var t=(0,h.sm)(!1),o=W.selection.getSelectedRange(),r=o.current(),n=r.from,l=r.to,i=o.size()-1;W.runHooks("afterSelection",n.row,n.col,l.row,l.col,t,i),W.runHooks("afterSelectionByProp",n.row,G.colToProp(n.col),l.row,G.colToProp(l.col),t,i);var s=W.selection.isSelectedByAnyHeader(),u=W.selection.selectedRange.current(),c=!0;Y&&(c=!1),t.isTouched()&&(c=!t.value);var d=W.selection.isSelectedByRowHeader(),f=W.selection.isSelectedByColumnHeader();!1!==c&&(s?d?W.view.scrollViewportVertically(G.rowIndexMapper.getRenderableFromVisualIndex(e.row)):f&&W.view.scrollViewportHorizontally(G.columnIndexMapper.getRenderableFromVisualIndex(e.col)):u&&!W.selection.isMultiple()?W.view.scrollViewport(el(u.from)):W.view.scrollViewport(el(e))),d&&f?(0,a.cn)(W.rootElement,["ht__selection--rows","ht__selection--columns"]):d?((0,a.IV)(W.rootElement,"ht__selection--columns"),(0,a.cn)(W.rootElement,"ht__selection--rows")):f?((0,a.IV)(W.rootElement,"ht__selection--rows"),(0,a.cn)(W.rootElement,"ht__selection--columns")):(0,a.IV)(W.rootElement,["ht__selection--rows","ht__selection--columns"]),W._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(e){var t=e.length-1,o=e[t],r=o.from,n=o.to;W.runHooks("afterSelectionEnd",r.row,r.col,n.row,n.col,t),W.runHooks("afterSelectionEndByProp",r.row,G.colToProp(r.col),n.row,G.colToProp(n.col),t)}),this.selection.addLocalHook("afterIsMultipleSelection",function(e){var t=W.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)}),this.selection.addLocalHook("beforeModifyTransformStart",function(e){W.runHooks("modifyTransformStart",e)}),this.selection.addLocalHook("afterModifyTransformStart",function(e,t,o){W.runHooks("afterModifyTransformStart",e,t,o)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(e){W.runHooks("modifyTransformEnd",e)}),this.selection.addLocalHook("afterModifyTransformEnd",function(e,t,o){W.runHooks("afterModifyTransformEnd",e,t,o)}),this.selection.addLocalHook("afterDeselect",function(){z.destroyEditor(),W._refreshBorders(),(0,a.IV)(W.rootElement,["ht__selection--rows","ht__selection--columns"]),W.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(e){W.alter("insert_row_above",e,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(e){W.alter("insert_col_start",e,1,"auto")}),U={alter:function(e,t){var a,l,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3?arguments[3]:void 0,f=arguments.length>4?arguments[4]:void 0,h=function(e){if(0===e.length)return[];var t=j(e);return t.sort(function(e,t){var o=B(e,1)[0],r=B(t,1)[0];return o===r?0:o>r?1:-1}),(0,g.k$)(t,function(e,t){var o=B(t,2),r=o[0],n=o[1],a=e[e.length-1],l=B(a,2),i=l[0]+l[1];return r<=i?a[1]+=Math.max(n-(i-r),0):e.push([r,n]),e},[t[0]])};switch(e){case"insert_row":Z.has(e)||(Z.add(e),(0,u.ZK)((0,c.e)(r||(r=P(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),e)));case"insert_row_below":case"insert_row_above":var m=G.countSourceRows();if(er.maxRows===m)return;var p="insert_row_below"===e?"below":"above";t=null!==(a=t)&&void 0!==a?a:"insert_row"===e||"below"===p?m:0;var w=o.createRow(t,s,{source:d,mode:p}),v=w.delta,C=w.startPhysicalIndex;if(v){var y=es.selectedRange.current(),R=null==y?void 0:y.from,b=null==R?void 0:R.row,S=G.toVisualRow(C);if(es.isSelectedByCorner())G.selectAll();else if((0,i.$K)(b)&&b>=S){var I=y.to,x=I.row,M=I.col,k=R.col;es.isSelectedByRowHeader()&&(k=-1),es.getSelectedRange().pop(),es.setRangeStartOnly(G._createCellCoords(b+v,k),!0),es.setRangeEnd(G._createCellCoords(x+v,M))}else G._refreshBorders()}break;case"insert_col":Z.has(e)||(Z.add(e),(0,u.ZK)((0,c.e)(n||(n=P(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),e)));case"insert_col_start":case"insert_col_end":var _="insert_col_end"===e?"end":"start";t=null!==(l=t)&&void 0!==l?l:"insert_col"===e||"end"===_?G.countSourceCols():0;var A=o.createCol(t,s,{source:d,mode:_}),E=A.delta,H=A.startPhysicalIndex;if(E){if(Array.isArray(er.colHeaders)){var T=[G.toVisualColumn(H),0];T.length+=E,Array.prototype.splice.apply(er.colHeaders,T)}var D=es.selectedRange.current(),N=null==D?void 0:D.from,V=null==N?void 0:N.col,L=G.toVisualColumn(H);if(es.isSelectedByCorner())G.selectAll();else if((0,i.$K)(V)&&V>=L){var F=D.to,O=F.row,K=F.col,Q=N.row;es.isSelectedByColumnHeader()&&(Q=-1),es.getSelectedRange().pop(),es.setRangeStartOnly(G._createCellCoords(Q,V+E),!0),es.setRangeEnd(G._createCellCoords(O,K+E))}else G._refreshBorders()}break;case"remove_row":var z=function(e){var t=0;(0,g.Bk)(e,function(e){var r=B(e,2),n=r[0],a=r[1],l=(0,i.xb)(n)?G.countRows()-1:Math.max(n-t,0);if(Number.isInteger(n)&&(n=Math.max(n-t,0)),o.removeRow(n,a,d)){var s=G.countRows(),u=er.fixedRowsTop;u>=l+1&&(er.fixedRowsTop-=Math.min(a,u-l));var c=er.fixedRowsBottom;c&&l>=s-c&&(er.fixedRowsBottom-=Math.min(a,c)),t+=a}})};Array.isArray(t)?z(h(t)):z([[t,s]]),U.adjustRowsAndCols(),G._refreshBorders();break;case"remove_col":var $=function(e){var t=0;(0,g.Bk)(e,function(e){var r=B(e,2),n=r[0],a=r[1],l=(0,i.xb)(n)?G.countCols()-1:Math.max(n-t,0),s=G.toPhysicalColumn(l);if(Number.isInteger(n)&&(n=Math.max(n-t,0)),o.removeCol(n,a,d)){var u=er.fixedColumnsStart;u>=l+1&&(er.fixedColumnsStart-=Math.min(a,u-l)),Array.isArray(er.colHeaders)&&(void 0===s&&(s=-1),er.colHeaders.splice(s,a)),t+=a}})};Array.isArray(t)?$(h(t)):$([[t,s]]),U.adjustRowsAndCols(),G._refreshBorders();break;default:throw Error('There is no such action "'.concat(e,'"'))}f||U.adjustRowsAndCols()},adjustRowsAndCols:function(){var e=er.minRows,t=er.minSpareRows,r=er.minCols,n=er.minSpareCols;if(0===G.countRows()&&0===G.countCols()&&es.deselect(),e){var a=G.countRows();a<e&&o.createRow(a,e-a,{source:"auto"})}if(t){var l=G.countEmptyRows(!0);if(l<t){var i=Math.min(t-l,er.maxRows-G.countSourceRows());o.createRow(G.countRows(),i,{source:"auto"})}}(r||n)&&(s=G.countEmptyCols(!0));var s,u=G.countCols();if(r&&!er.columns&&u<r){var c=r-u;s+=c,o.createCol(u,c,{source:"auto"})}if(n&&!er.columns&&"array"===G.dataType&&s<n){u=G.countCols();var d=Math.min(n-s,er.maxCols-u);o.createCol(u,d,{source:"auto"})}if(es.isSelected()){var f=G.countRows(),h=G.countCols();(0,g.Bk)(es.selectedRange,function(e){var t=!1,o=e.from.row,r=e.from.col,n=e.to.row,a=e.to.col;o>f-1?(t=!0,n>(o=f-1)&&(n=o)):n>f-1&&(t=!0,o>(n=f-1)&&(o=n)),r>h-1?(t=!0,a>(r=h-1)&&(a=r)):a>h-1&&(t=!0,r>(a=h-1)&&(r=a)),t&&G.selectCell(o,r,n,a)})}G.view&&G.view.adjustElementsSize()},populateFromArray:function(e,t,o,r,n,a,l){var s=[],u={},c=[],d=e.row,f=e.col;if(0===(M=t.length))return!1;var m=0,p=0;switch((0,h.Kn)(o)&&(m=o.col-f+1,p=o.row-d+1),n){case"shift_down":var w=(0,g.jz)(t),v=w.length,C=Math.max(v,m),y=G.getData().slice(d),R=(0,g.jz)(y).slice(f,f+C);for(k=0;k<C;k+=1)if(k<v){for(x=0,M=w[k].length;x<p-M;x+=1)w[k].push(w[k][x%M]);k<R.length?c.push(w[k].concat(R[k])):c.push(w[k].concat(Array(y.length).fill(null)))}else c.push(w[k%v].concat(R[k]));G.populateFromArray(d,f,(0,g.jz)(c));break;case"shift_right":var b=t.length,S=Math.max(b,p),I=G.getData().slice(d).map(function(e){return e.slice(f)});for(x=0;x<S;x+=1)if(x<b){for(k=0,_=t[x].length;k<m-_;k+=1)t[x].push(t[x][k%_]);if(x<I.length)for(var x,M,k,_,A,E=0;E<I[x].length;E+=1)t[x].push(I[x][E]);else(A=t[x]).push.apply(A,j(Array(I[0].length).fill(null)))}else t.push(t[x%M].slice(0,S).concat(I[x]));G.populateFromArray(d,f,t);break;default:u.row=e.row,u.col=e.col;var H,T={row:o&&e?o.row-e.row+1:1,col:o&&e?o.col-e.col+1:1},D=0,N=0,V=!0,L=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==o?r[o%r.length]:r},F=t.length,P=o?o.row-e.row+1:0;for(x=0,M=o?P:Math.max(F,P);x<M&&!(o&&u.row>o.row&&P>F||!er.allowInsertRow&&u.row>G.countRows()-1)&&!(u.row>=er.maxRows);x++){var B=x-D,K=L(B).length,U=o?o.col-e.col+1:0;if(_=o?U:Math.max(K,U),u.col=e.col,H=G.getCellMeta(u.row,u.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&H.skipRowOnPaste){D+=1,u.row+=1,M+=1;continue}for(k=0,N=0;k<_&&!(o&&u.col>o.col&&U>K||!er.allowInsertColumn&&u.col>G.countCols()-1)&&!(u.col>=er.maxCols);k++){if(H=G.getCellMeta(u.row,u.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&H.skipColumnOnPaste){N+=1,u.col+=1,_+=1;continue}if(H.readOnly&&"UndoRedo.undo"!==r){u.col+=1;continue}var Q=k-N,Z=L(B,Q),z=G.getDataAtCell(u.row,u.col),$={row:B,col:Q};if("Autofill.fill"===r){var W=G.runHooks("beforeAutofillInsidePopulate",$,a,t,l,{},T);W&&(Z=(0,i.o8)(W.value)?Z:W.value)}if(null!==Z&&"object"===O(Z)){if(Array.isArray(Z)&&null===z&&(z=[]),null===z||"object"!==O(z))V=!1;else{var q=(0,h.ie)(Array.isArray(z)?z:z[0]||z),Y=(0,h.ie)(Array.isArray(Z)?Z:Z[0]||Z);(0,h.Z1)(q,Y)||Array.isArray(q)&&Array.isArray(Y)?Z=(0,h.I8)(Z):V=!1}}else null!==z&&"object"===O(z)&&(V=!1);V&&s.push([u.row,u.col,Z]),V=!0,u.col+=1}u.row+=1}G.setDataAtCell(s,null,null,r||"populateFromArray")}}},this.init=function(){K.setData(er.data),G.runHooks("beforeInit"),((0,s.K1)()||(0,s.L)())&&(0,a.cn)(G.rootElement,"mobile"),this.updateSettings(er,!0),this.view=new b.Z(this),z=d.ZP.getInstance(G,er,es),G.runHooks("init"),this.forceFullRender=!0,this.view.render(),X&&null===G.rootElement.offsetParent&&(0,a.TT)(G.rootElement,function(){G.view._wt.wtOverlays.updateLastSpreaderSize(),G.render(),G.view.adjustElementsSize()}),"object"===O(X)&&(G.runHooks("afterChange",X[0],X[1]),X=!1),G.runHooks("afterInit")},this._createCellCoords=function(e,t){return G.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,o){return G.view._wt.createCellRange(e,t,o)},this.validateCell=function(e,t,o,r){var n,a=G.getCellValidator(t);function s(e){var r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!r||!0===t.hidden){o(e);return}var n=t.visualCol,a=t.visualRow,l=G.getCell(a,n,!0);if(l&&"TH"!==l.nodeName){var i=G.rowIndexMapper.getRenderableFromVisualIndex(a),s=G.columnIndexMapper.getRenderableFromVisualIndex(n);G.view._wt.getSetting("cellRenderer",i,s,l)}o(e)}(0,i.Kj)(a)&&(n=a,a=function(e,t){t(n.test(e))}),(0,l.mf)(a)?(e=G.runHooks("beforeValidate",e,t.visualRow,t.prop,r),G._registerImmediate(function(){a.call(t,e,function(o){G&&(o=G.runHooks("afterValidate",o,e,t.visualRow,t.prop,r),t.valid=o,s(o),G.runHooks("postAfterValidate",o,e,t.visualRow,t.prop,r))})})):G._registerImmediate(function(){t.valid=!0,s(t.valid,!1)})},this.setDataAtCell=function(e,t,r,n){var a,l,i,s=eg(e,t,r),u=[],c=n;for(a=0,l=s.length;a<l;a++){if("object"!==O(s[a]))throw Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof s[a][1])throw Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");i=s[a][1]>=this.countCols()?s[a][1]:o.colToProp(s[a][1]),u.push([s[a][0],i,K.getAtCell(this.toPhysicalRow(s[a][0]),s[a][1]),s[a][2]])}c||"object"!==O(e)||(c=t),G.runHooks("afterSetDataAtCell",u,c),ef(u,c,function(){eh(u,c)})},this.setDataAtRowProp=function(e,t,o,r){var n,a,l=eg(e,t,o),i=[],s=r;for(n=0,a=l.length;n<a;n++)i.push([l[n][0],l[n][1],K.getAtCell(this.toPhysicalRow(l[n][0]),l[n][1]),l[n][2]]);s||"object"!==O(e)||(s=t),G.runHooks("afterSetDataAtRowProp",i,s),ef(i,s,function(){eh(i,s)})},this.listen=function(){G&&!G.isListening()&&(Q=G.guid,G.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Q=null,G.runHooks("afterUnlisten"))},this.isListening=function(){return Q===G.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];G._refreshBorders(e,t)},this.populateFromArray=function(e,t,o,r,n,a,l,i,s){if(!("object"===O(o)&&"object"===O(o[0])))throw Error("populateFromArray parameter `input` must be an array of arrays");var u="number"==typeof r?G._createCellCoords(r,n):null;return U.populateFromArray(G._createCellCoords(e,t),o,u,a,l,i,s)},this.spliceCol=function(e,t,r){for(var n,a=arguments.length,l=Array(a>3?a-3:0),i=3;i<a;i++)l[i-3]=arguments[i];return(n=o).spliceCol.apply(n,[e,t,r].concat(l))},this.spliceRow=function(e,t,r){for(var n,a=arguments.length,l=Array(a>3?a-3:0),i=3;i<a;i++)l[i-3]=arguments[i];return(n=o).spliceRow.apply(n,[e,t,r].concat(l))},this.getSelected=function(){if(es.isSelected())return(0,g.Sc)(es.getSelectedRange(),function(e){var t=e.from,o=e.to;return[t.row,t.col,o.row,o.col]})},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(es.isSelected())return Array.from(es.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){var t=this;if(es.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var o=[];(0,g.Bk)(es.getSelectedRange(),function(e){var r=e.getTopStartCorner(),n=e.getBottomEndCorner();(0,R.q4)(r.row,n.row,function(e){(0,R.q4)(r.col,n.col,function(r){t.getCellMeta(e,r).readOnly||o.push([e,r,null])})})}),o.length>0&&this.setDataAtCell(o,e)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(z.lockEditor(),this._refreshBorders(null),z.unlockEditor()))},this.batchRender=function(e){this.suspendRender();var t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var o=e();return this.resumeExecution(t),o},this.batch=function(e){this.suspendRender(),this.suspendExecution();var t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(G.view){var e=G.view.getLastSize(),t=e.width,o=e.height,r=G.rootElement.getBoundingClientRect(),n=r.width,a=r.height,l=n!==t||a!==o;!1!==G.runHooks("beforeRefreshDimensions",{width:t,height:o},{width:n,height:a},l)&&((l||G.view._wt.wtOverlays.scrollableElement===G.rootWindow)&&(G.view.setLastSize(n,a),G.render()),G.runHooks("afterRefreshDimensions",{width:t,height:o},{width:n,height:a},l))}},this.updateData=function(e,t){var r=this;(0,V.o)(e,function(e){o=e},function(e){o=e,G.columnIndexMapper.fitToLength(r.getInitialColumnCount()),G.rowIndexMapper.fitToLength(r.countSourceRows()),U.adjustRowsAndCols()},{hotInstance:G,dataMap:o,dataSource:K,internalSource:"updateData",source:t,metaManager:eo,firstRun:X})},this.loadData=function(e,t){(0,V.o)(e,function(e){o=e},function(){eo.clearCellsCache(),G.initIndexMappers(),U.adjustRowsAndCols(),X&&(X=[null,"loadData"])},{hotInstance:G,dataMap:o,dataSource:K,internalSource:"loadData",source:t,metaManager:eo,firstRun:X})},this.getInitialColumnCount=function(){var e=er.columns,t=0;if(Array.isArray(e))t=e.length;else if((0,l.mf)(e)){if("array"===G.dataType)for(var r=this.countSourceCols(),n=0;n<r;n+=1)e(n)&&(t+=1);else("object"===G.dataType||"function"===G.dataType)&&(t=o.colToPropCache.length)}else if((0,i.$K)(er.dataSchema)){var a=o.getSchema();t=Array.isArray(a)?a.length:(0,h.Q8)(a)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,n){return(0,i.o8)(e)?o.getAll():o.getRange(G._createCellCoords(e,t),G._createCellCoords(r,n),o.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,n){return o.getCopyableText(G._createCellCoords(e,t),G._createCellCoords(r,n))},this.getCopyableData=function(e,t){return o.getCopyable(e,o.colToProp(t))},this.getSchema=function(){return o.getSchema()},this.updateSettings=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=(X?G.loadData:G.updateData).bind(this),s=!1;if((0,i.$K)(e.rows))throw Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,i.$K)(e.cols))throw Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,i.$K)(e.ganttChart))throw Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(t in e)"data"===t||("language"===t?function(e){var t=(0,E.TH)(e);(0,A.RY)(t)?(G.runHooks("beforeLanguageChange",t),en.language=t,G.runHooks("afterLanguageChange",t)):(0,E.Vn)(e)}(e.language):"className"===t?ec("className",e.className):"tableClassName"===t&&G.table?(ec("tableClassName",e.tableClassName),G.view._wt.wtOverlays.syncOverlayTableClassNames()):_.Z.getSingleton().isRegistered(t)||_.Z.getSingleton().isDeprecated(t)?((0,l.mf)(e[t])||Array.isArray(e[t]))&&(e[t].initialHook=!0,G.addHook(t,e[t])):!n&&(0,h.nr)(e,t)&&(en[t]=e[t]));void 0===e.data&&void 0===er.data?a(null,"updateSettings"):void 0!==e.data?a(e.data,"updateSettings"):void 0!==e.columns&&(o.createMap(),G.initIndexMappers());var u=G.countCols(),c=er.columns;if(c&&(0,l.mf)(c)&&(s=!0),(void 0!==e.cell||void 0!==e.cells||void 0!==e.columns)&&eo.clearCache(),u>0)for(t=0,r=0;t<u;t++){if(c){var d=s?c(t):c[r];d&&eo.updateColumnMeta(r,d)}r+=1}(0,i.$K)(e.cell)&&(0,h._l)(e.cell,function(e){G.setCellMetaObject(e.row,e.col,e)}),G.runHooks("afterCellMetaReset");var f=G.rootElement.style.height;""!==f&&(f=parseInt(G.rootElement.style.height,10));var g=e.height;if((0,l.mf)(g)&&(g=g()),n&&G.rootElement.getAttribute("style")&&G.rootElement.setAttribute("data-initialstyle",G.rootElement.getAttribute("style")),null===g){var m=G.rootElement.getAttribute("data-initialstyle");m&&(m.indexOf("height")>-1||m.indexOf("overflow")>-1)?G.rootElement.setAttribute("style",m):(G.rootElement.style.height="",G.rootElement.style.overflow="")}else void 0!==g&&(G.rootElement.style.height=isNaN(g)?"".concat(g):"".concat(g,"px"),G.rootElement.style.overflow="hidden");if(void 0!==e.width){var p=e.width;(0,l.mf)(p)&&(p=p()),G.rootElement.style.width=isNaN(p)?"".concat(p):"".concat(p,"px")}n||(G.view&&(G.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),G.view._wt.exportSettingsAsClassNames()),G.runHooks("afterUpdateSettings",e)),U.adjustRowsAndCols(),G.view&&!X&&(G.forceFullRender=!0,z.lockEditor(),G._refreshBorders(null),G.view._wt.wtOverlays.adjustElementsSize(),z.unlockEditor()),!n&&G.view&&(""===f||""===g||void 0===g)&&f!==g&&G.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=G.getSelectedLast();if(er.getValue){if((0,l.mf)(er.getValue))return er.getValue.call(G);if(e)return G.getData()[e[0][0]][er.getValue]}else if(e)return G.getDataAtCell(e[0],e[1])},this.getSettings=function(){return er},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,o,r,n){U.alter(e,t,o,r,n)},this.getCell=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,n=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;n=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===n||null===r?null:G.view.getCellAtCoords(G._createCellCoords(n,r),o)},this.getCoords=function(e){var t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;var o=t.row,r=t.col,n=o,a=r;return o>=0&&(n=this.rowIndexMapper.getVisualFromRenderableIndex(o)),r>=0&&(a=this.columnIndexMapper.getVisualFromRenderableIndex(r)),G._createCellCoords(n,a)},this.colToProp=function(e){return o.colToProp(e)},this.propToCol=function(e){return o.propToCol(e)},this.toVisualRow=function(e){return W.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return W.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return W.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return W.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return o.get(e,o.colToProp(t))},this.getDataAtRowProp=function(e,t){return o.get(e,t)},this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,j(o.getRange(G._createCellCoords(0,e),G._createCellCoords(er.data.length-1,e),o.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,r=o.getRange(G._createCellCoords(0,o.propToCol(e)),G._createCellCoords(er.data.length-1,o.propToCol(e)),o.DESTINATION_RENDERER);return(t=[]).concat.apply(t,j(r))},this.getSourceData=function(e,t,o,r){return void 0===e?K.getData():K.getByRange(G._createCellCoords(e,t),G._createCellCoords(o,r))},this.getSourceDataArray=function(e,t,o,r){return void 0===e?K.getData(!0):K.getByRange(G._createCellCoords(e,t),G._createCellCoords(o,r),!0)},this.getSourceDataAtCol=function(e){return K.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,o,r){var n=eg(e,t,o),a=this.hasHook("afterSetSourceDataAtCell"),l=[];a&&(0,g.Bk)(n,function(e){var t=B(e,3),o=t[0],r=t[1],n=t[2];l.push([o,r,K.getAtCell(o,r),n])}),(0,g.Bk)(n,function(e){var t=B(e,3),o=t[0],r=t[1],n=t[2];K.setAtCell(o,r,n)}),a&&this.runHooks("afterSetSourceDataAtCell",l,r),this.render();var s=G.getActiveEditor();s&&(0,i.$K)(s.refreshValue)&&s.refreshValue()},this.getSourceDataAtRow=function(e){return K.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return K.getAtCell(e,t)},this.getDataAtRow=function(e){return o.getRange(G._createCellCoords(e,0),G._createCellCoords(e,this.countCols()-1),o.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,o,r){var n=this,a=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,o,r],l=a[0],i=a[1],s=a[2],u=a[3],c=null,d=null;void 0===s&&(s=l),void 0===u&&(u=i);var f="mixed";return(0,R.q4)(Math.max(Math.min(l,s),0),Math.max(l,s),function(e){var t=!0;return(0,R.q4)(Math.max(Math.min(i,u),0),Math.max(i,u),function(o){return d=n.getCellMeta(e,o).type,c?t=c===d:c=d,t}),f=t?d:"mixed",t}),f},this.removeCellMeta=function(e,t,o){var r=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],n=r[0],a=r[1],l=eo.getCellMetaKeyValue(n,a,o);!1!==G.runHooks("beforeRemoveCellMeta",e,t,o,l)&&(eo.removeCellMeta(n,a,o),G.runHooks("afterRemoveCellMeta",e,t,o,l)),l=null},this.spliceCellsMeta=function(e){for(var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,n=Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(n.length>0&&!Array.isArray(n[0]))throw Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");o>0&&eo.removeRow(this.toPhysicalRow(e),o),n.length>0&&(0,g.Bk)(n.reverse(),function(o){eo.createRow(t.toPhysicalRow(e)),(0,g.Bk)(o,function(o,r){return t.setCellMetaObject(e,r,o)})}),G.render()},this.setCellMetaObject=function(e,t,o){var r=this;"object"===O(o)&&(0,h._l)(o,function(o,n){r.setCellMeta(e,t,n,o)})},this.setCellMeta=function(e,t,o,r){if(!1!==G.runHooks("beforeSetCellMeta",e,t,o,r)){var n=e,a=t;e<this.countRows()&&(n=this.toPhysicalRow(e)),t<this.countCols()&&(a=this.toPhysicalColumn(t)),eo.setCellMeta(n,a,o,r),G.runHooks("afterSetCellMeta",e,t,o,r)}},this.getCellsMeta=function(){return eo.getCellsMeta()},this.getCellMeta=function(e,t){var o=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===o&&(o=e),null===r&&(r=t),eo.getCellMeta(o,r,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return eo.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===G.dataType||er.columns)},this.getCellRenderer=function(e,t){var o="number"==typeof e?G.getCellMeta(e,t).renderer:e.renderer;return"string"==typeof o?(0,w.Bp)(o):(0,i.o8)(o)?(0,w.Bp)("text"):o},this.getCellEditor=function(e,t){var o="number"==typeof e?G.getCellMeta(e,t).editor:e.editor;return"string"==typeof o?(0,v.y$)(o):(0,i.o8)(o)?(0,v.y$)("text"):o},this.getCellValidator=function(e,t){var o="number"==typeof e?G.getCellMeta(e,t).validator:e.validator;return"string"==typeof o?(0,C.Te)(o):o},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,o){var r=new ed;e&&(r.onQueueEmpty=e);for(var n=G.countRows()-1;n>=0;){if(void 0!==t&&-1===t.indexOf(n)){n-=1;continue}for(var a=G.countCols()-1;a>=0;){if(void 0!==o&&-1===o.indexOf(a)){a-=1;continue}r.addValidatorToQueue(),G.validateCell(G.getDataAtCell(n,a),G.getCellMeta(n,a),function(e){if("boolean"!=typeof e)throw Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),a-=1}n-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=er.rowHeaders,o=e;return void 0!==o&&(o=G.runHooks("modifyRowHeader",o)),void 0===o?(t=[],(0,R.q4)(G.countRows()-1,function(e){t.push(G.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[o]?t=t[o]:(0,l.mf)(t)?t=t(o):t&&"string"!=typeof t&&"number"!=typeof t&&(t=o+1),t},this.hasRowHeaders=function(){return!!er.rowHeaders},this.hasColHeaders=function(){if(void 0!==er.colHeaders&&null!==er.colHeaders)return!!er.colHeaders;for(var e=0,t=G.countCols();e<t;e++)if(G.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=G.runHooks("modifyColHeader",e);if(void 0===o){for(var r=[],n=G.countCols(),a=0;a<n;a++)r.push(G.getColHeader(a));return r}var i=er.colHeaders,s=function(e){for(var t=[],o=G.countCols(),r=0;r<o;r++)(0,l.mf)(er.columns)&&er.columns(r)&&t.push(r);return t[e]},u=G.toPhysicalColumn(o),c=s(u);return!1===er.colHeaders?i=null:er.columns&&(0,l.mf)(er.columns)&&er.columns(c)&&er.columns(c).title?i=er.columns(c).title:er.columns&&er.columns[u]&&er.columns[u].title?i=er.columns[u].title:Array.isArray(er.colHeaders)&&void 0!==er.colHeaders[u]?i=er.colHeaders[u]:(0,l.mf)(er.colHeaders)?i=er.colHeaders(u):er.colHeaders&&"string"!=typeof er.colHeaders&&"number"!=typeof er.colHeaders&&(i=(0,I.Yl)(o)),i=G.runHooks("modifyColumnHeaderValue",i,e,t)},this._getColWidthFromSettings=function(e){var t;if(e>=0&&(t=G.getCellMeta(0,e).width),(void 0===t||t===er.width)&&(t=er.colWidths),null!=t){switch(O(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){var t=G._getColWidthFromSettings(e);return void 0===(t=G.runHooks("modifyColWidth",t,e))&&(t=k.Z.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=er.rowHeights;if(null!=t){switch(O(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=G._getRowHeightFromSettings(e);return G.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return K.countRows()},this.countSourceCols=function(){return K.countFirstRowKeys()},this.countRows=function(){return o.getLength()},this.countCols=function(){return Math.min(er.maxCols,this.columnIndexMapper.getNotTrimmedIndexesLength())},this.countRenderedRows=function(){return G.view._wt.drawn?G.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return G.view._wt.drawn?G.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return G.view._wt.drawn?G.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return G.view._wt.drawn?G.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,R.yh)(G.countRows()-1,function(o){if(G.isEmptyRow(o))t+=1;else if(!0===e)return!1}),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,R.yh)(G.countCols()-1,function(o){if(G.isEmptyCol(o))t+=1;else if(!0===e)return!1}),t},this.isEmptyRow=function(e){return er.isEmptyRow.call(G,e)},this.isEmptyCol=function(e){return er.isEmptyCol.call(G,e)},this.selectCell=function(e,t,o,r){var n=!(arguments.length>4)||void 0===arguments[4]||arguments[4],a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];return!((0,i.o8)(e)||(0,i.o8)(t))&&this.selectCells([[e,t,o,r]],n,a)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2];!1===t&&(Y=!0);var r=es.selectCells(e);return r&&o&&G.listen(),Y=!1,r},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return es.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return es.selectRows(e,t)},this.deselectCell=function(){es.deselect()},this.selectAll=function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=e&&this.hasRowHeaders(),o=e&&this.hasColHeaders();Y=!0,es.selectAll(t,o),Y=!1};var em=function(e,t){return e.getNearestNotHiddenIndex(t,1,!0)};this.scrollViewportTo=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=!(arguments.length>4)||void 0===arguments[4]||arguments[4],a=!o,l=!r,i=e,s=t;if(n){var u=Number.isInteger(e),c=Number.isInteger(t),d=u?em(this.rowIndexMapper,e):void 0,f=c?em(this.columnIndexMapper,t):void 0;if(null===d||null===f)return!1;i=u?G.rowIndexMapper.getRenderableFromVisualIndex(d):void 0,s=c?G.columnIndexMapper.getRenderableFromVisualIndex(f):void 0}var h=Number.isInteger(i),g=Number.isInteger(s);return h&&g?G.view.scrollViewport(G._createCellCoords(i,s),a,r,o,l):h&&!1===g?G.view.scrollViewportVertically(i,a,o):!!g&&!1===h&&G.view.scrollViewportHorizontally(s,r,l)},this.destroy=function(){if(G._clearTimeouts(),G._clearImmediates(),G.view&&G.view.destroy(),K&&K.destroy(),K=null,this.getShortcutManager().destroy(),eo.clearCache(),(0,M._v)(G)){var e=this.rootDocument.querySelector("#hot-display-license-info");e&&e.parentNode.removeChild(e)}(0,a.cS)(G.rootElement),J.destroy(),z&&z.destroy(),G.batchExecution(function(){G.rowIndexMapper.unregisterAll(),G.columnIndexMapper.unregisterAll(),ea.getItems().forEach(function(e){B(e,2)[1].destroy()}),ea.clear(),G.runHooks("afterDestroy")},!0),_.Z.getSingleton().destroy(G),(0,h._l)(G,function(e,t,o){(0,l.mf)(e)?o[t]=function(){throw Error('The "'.concat(t,'" method cannot be called because this Handsontable instance has been destroyed'))}:"guid"!==t&&(o[t]=null)}),G.isDestroyed=!0,o&&o.destroy(),G.rowIndexMapper=null,G.columnIndexMapper=null,o=null,U=null,es=null,z=null,G=null},this.getActiveEditor=function(){return z.getActiveEditor()},this.getPlugin=function(e){var t=(0,y.ct)(e);return"UndoRedo"===t?this.undoRedo:ea.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:ea.getId(e)},this.getInstance=function(){return G},this.addHook=function(e,t){_.Z.getSingleton().add(e,t,G)},this.hasHook=function(e){return _.Z.getSingleton().has(e,G)||_.Z.getSingleton().has(e)},this.addHookOnce=function(e,t){_.Z.getSingleton().once(e,t,G)},this.removeHook=function(e,t){_.Z.getSingleton().remove(e,t,G)},this.runHooks=function(e,t,o,r,n,a,l){return _.Z.getSingleton().run(G,e,t,o,r,n,a,l)},this.getTranslatedPhrase=function(e,t){return(0,A.vk)(er.language,e,t)},this.toHTML=function(){return(0,m.vo)(W)},this.toTableElement=function(){var e=W.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",(0,m.vo)(W)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=e;"function"==typeof o&&(o=setTimeout(o,t)),this.timeouts.push(o)},this._clearTimeouts=function(){(0,g.Bk)(this.timeouts,function(e){clearTimeout(e)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){(0,g.Bk)(this.immediates,function(e){clearImmediate(e)})},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];z.destroyEditor(e),G.view.render(),t&&es.isSelected()&&z.prepareEditor()},this.isRtl=function(){return"rtl"===G.rootWindow.getComputedStyle(G.rootElement).direction},this.isLtr=function(){return!G.isRtl()},this.getDirectionFactor=function(){return G.isLtr()?1:-1};var ep=(0,F.U)({handleEvent:function(e){var t=G.isListening(),o=(null==e?void 0:e.key)!==void 0;return t&&o},beforeKeyDown:function(e){return W.runHooks("beforeKeyDown",e)},afterKeyDown:function(e){W.isDestroyed||G.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.getShortcutManager=function(){return ep};var ew=ep.addContext("grid");ep.setActiveContextName("grid"),ew.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){G.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var e=G.getSelectedRange(),t=e[e.length-1].highlight,o=t.row,r=t.col,n=G.getDataAtCell(o,r),a=new Map,l=0;l<e.length;l++)e[l].forAll(function(e,t){e>=0&&t>=0&&(e!==o||t!==r)&&!G.getCellMeta(e,t).readOnly&&a.set("".concat(e,"x").concat(t),[e,t,n])});G.setDataAtCell(Array.from(a.values()))},runOnlyIf:function(){return G.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){es.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){es.setRangeStart(G._createCellCoords(G.rowIndexMapper.getNearestNotHiddenIndex(0,1),G.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){es.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=G.getSelectedRangeLast(),t=e.from,o=e.to,r=G.rowIndexMapper.getNearestNotHiddenIndex(0,1);es.setRangeStart(t.clone()),es.setRangeEnd(G._createCellCoords(r,o.col))},runOnlyIf:function(){return!(G.selection.isSelectedByCorner()||G.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){es.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){es.setRangeStart(G._createCellCoords(G.rowIndexMapper.getNearestNotHiddenIndex(G.countRows()-1,-1),G.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){es.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=G.getSelectedRangeLast(),t=e.from,o=e.to,r=G.rowIndexMapper.getNearestNotHiddenIndex(G.countRows()-1,-1);es.setRangeStart(t.clone()),es.setRangeEnd(G._createCellCoords(r,o.col))},runOnlyIf:function(){return!(G.selection.isSelectedByCorner()||G.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){es.transformStart(0,-1*G.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=G.getSelectedRangeLast().highlight.row,o=(e=G.columnIndexMapper).getNearestNotHiddenIndex.apply(e,j(G.isRtl()?[G.countCols()-1,-1]:[0,1]));es.setRangeStart(G._createCellCoords(t,o))}},{keys:[["ArrowLeft","Shift"]],callback:function(){es.transformEnd(0,-1*G.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=G.getSelectedRangeLast(),o=t.from,r=t.to,n=(e=G.columnIndexMapper).getNearestNotHiddenIndex.apply(e,j(G.isRtl()?[G.countCols()-1,-1]:[0,1]));es.setRangeStart(o.clone()),es.setRangeEnd(G._createCellCoords(r.row,n))},runOnlyIf:function(){return!(G.selection.isSelectedByCorner()||G.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){es.transformStart(0,G.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=G.getSelectedRangeLast().highlight.row,o=(e=G.columnIndexMapper).getNearestNotHiddenIndex.apply(e,j(G.isRtl()?[0,1]:[G.countCols()-1,-1]));es.setRangeStart(G._createCellCoords(t,o))}},{keys:[["ArrowRight","Shift"]],callback:function(){es.transformEnd(0,G.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=G.getSelectedRangeLast(),o=t.from,r=t.to,n=(e=G.columnIndexMapper).getNearestNotHiddenIndex.apply(e,j(G.isRtl()?[0,1]:[G.countCols()-1,-1]));es.setRangeStart(o.clone()),es.setRangeEnd(G._createCellCoords(r.row,n))},runOnlyIf:function(){return!(G.selection.isSelectedByCorner()||G.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var e=parseInt(G.getSettings().fixedColumnsStart,10),t=G.getSelectedRangeLast().highlight.row,o=G.columnIndexMapper.getNearestNotHiddenIndex(e,1);es.setRangeStart(G._createCellCoords(t,o))},runOnlyIf:function(){return G.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){es.setRangeEnd(G._createCellCoords(es.selectedRange.current().from.row,G.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(G.getSettings().fixedRowsTop,10),t=parseInt(G.getSettings().fixedColumnsStart,10),o=G.rowIndexMapper.getNearestNotHiddenIndex(e,1),r=G.columnIndexMapper.getNearestNotHiddenIndex(t,1);es.setRangeStart(G._createCellCoords(o,r))},runOnlyIf:function(){return G.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){es.setRangeStart(G._createCellCoords(G.getSelectedRangeLast().highlight.row,G.columnIndexMapper.getNearestNotHiddenIndex(G.countCols()-1,-1)))},runOnlyIf:function(){return G.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){es.setRangeEnd(G._createCellCoords(es.selectedRange.current().from.row,G.columnIndexMapper.getNearestNotHiddenIndex(G.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(G.getSettings().fixedRowsBottom,10),t=G.rowIndexMapper.getNearestNotHiddenIndex(G.countRows()-e-1,-1),o=G.columnIndexMapper.getNearestNotHiddenIndex(G.countCols()-1,-1);es.setRangeStart(G._createCellCoords(t,o))},runOnlyIf:function(){return G.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){es.transformStart(-G.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var e=G.getSelectedRangeLast().to,t=Math.max(e.row-G.countVisibleRows(),0),o=G.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(null!==o){var r=G._createCellCoords(o,e.col),n=e.row-G.view.getFirstFullyVisibleRow(),a=Math.max(r.row-n,0);es.setRangeEnd(r),G.scrollViewportTo(a)}}},{keys:[["PageDown"]],callback:function(){es.transformStart(G.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var e=G.getSelectedRangeLast().to,t=Math.min(e.row+G.countVisibleRows(),G.countRows()-1),o=G.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(null!==o){var r=G._createCellCoords(o,e.col),n=e.row-G.view.getFirstFullyVisibleRow(),a=Math.min(r.row-n,G.countRows()-1);es.setRangeEnd(r),G.scrollViewportTo(a)}}},{keys:[["Tab"]],callback:function(e){var t="function"==typeof er.tabMoves?er.tabMoves(e):er.tabMoves;es.transformStart(t.row,t.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var t="function"==typeof er.tabMoves?er.tabMoves(e):er.tabMoves;es.transformStart(-t.row,-t.col)}}],{runOnlyIf:function(){return(0,i.$K)(G.getSelected())&&G.countRenderedRows()>0&&G.countRenderedCols()>0},group:"gridDefault"}),(0,p.a9)().forEach(function(e){var t=(0,p.s3)(e);ea.addItem(e,new t(W))}),_.Z.getSingleton().run(G,"construct")}}}]);